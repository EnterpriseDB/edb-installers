diff -rcN hq/bin/agent.rc ../hq/bin/agent.rc
*** hq/bin/agent.rc	2008-03-26 01:43:11.000000000 +0530
--- ../hq/bin/agent.rc	2010-02-03 11:18:24.265403317 +0530
***************
*** 1,12 ****
  #!/bin/sh
  #
! # description: Starts and stops the Hyperic Agent.  The agent
  # must be started once by hand to complete the setup process.
  #
  # 
  #
  
! PROGRAM="Hyperic Agent"
  
  #
  # Set the USER variable to the user to start the agent as
--- 1,12 ----
  #!/bin/sh
  #
! # description: Starts and stops the Postgres Plus Agent.  The agent
  # must be started once by hand to complete the setup process.
  #
  # 
  #
  
! PROGRAM="Postgres Plus Agent"
  
  #
  # Set the USER variable to the user to start the agent as
***************
*** 39,51 ****
  
  start() {
      echo -n "Starting $PROGRAM services: "
!     su - $USER -c "$AGENT_DIR/hq-agent.sh start > /dev/null 2>&1"
      return $?
  }	
  
  stop() {
      echo -n "Shutting down $PROGRAM services: "
!     su - $USER -c "$AGENT_DIR/hq-agent.sh stop > /dev/null 2>&1"
      return $?
  }
  
--- 39,51 ----
  
  start() {
      echo -n "Starting $PROGRAM services: "
!     su - $USER -c "$AGENT_DIR/pphq-agent.sh start > /dev/null 2>&1"
      return $?
  }	
  
  stop() {
      echo -n "Shutting down $PROGRAM services: "
!     su - $USER -c "$AGENT_DIR/pphq-agent.sh stop > /dev/null 2>&1"
      return $?
  }
  
***************
*** 56,62 ****
  
  ping() {
      echo -n "Pinging $PROGRAM"
!     su - $USER -c "$AGENT_DIR/hq-agent.sh ping > /dev/null 2>&1"
      return $?
  }
  
--- 56,62 ----
  
  ping() {
      echo -n "Pinging $PROGRAM"
!     su - $USER -c "$AGENT_DIR/pphq-agent.sh ping > /dev/null 2>&1"
      return $?
  }
  
diff -rcN hq/bin/hq-agent.bat ../hq/bin/hq-agent.bat
*** hq/bin/hq-agent.bat	2008-07-03 11:36:37.000000000 +0530
--- ../hq/bin/hq-agent.bat	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,96 ****
- @echo off
- if "%OS%" == "Windows_NT" setlocal
- 
- set PDK_LIB=pdk\lib
- set AGENT_LIB=lib
- 
- rem # ------------- 
- rem # Shouldn't need to change anything below this
- rem # -------------
- 
- SET RUNDIR=%~dp0
- cd %RUNDIR%
- if not "%HQ_JAVA_HOME%"=="" (
-     set JAVA_HOME=%HQ_JAVA_HOME%
-     goto gotjava
- )
- if EXIST %RUNDIR%\jre\nul (
-     set JAVA_HOME=%RUNDIR%\jre
-     goto gotjava
- )
- if "%JAVA_HOME%"=="" goto nojava
- 
- if not exist "%JAVA_HOME%\bin\java.exe" goto nojavaExe
- 
- :gotjava
- set JAVA=%JAVA_HOME%\bin\java
- 
- set CLIENT_CLASSPATH=%AGENT_LIB%\AgentClient.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\AgentServer.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\lather.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-logging.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\log4j-1.2.14.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jdom-1.1.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hyperic-util.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\sigar.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\bcel-5.1.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hq-product.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jakarta-oro-2.0.7.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jxla.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-httpclient-3.1.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-codec-1.3.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\groovy-all-1.5.jar
- 
- set CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
- 
- set CLIENT_CMD="%JAVA%" -classpath "%CLIENT_CLASSPATH%" %CLIENT_CLASS%
- 
- set START_CMD=%CLIENT_CMD% start
- set PING_CMD=%CLIENT_CMD% ping
- set SETUP_CMD=%CLIENT_CMD% setup
- set DIE_CMD=%CLIENT_CMD% die
- 
- if /i "%1"=="start" (
-     echo Starting agent
-     %START_CMD%
-     goto done
- )
- if /i "%1"=="run" (
-     echo Running agent
-     echo %START_CMD%
-     %START_CMD%
-     goto done
- )
- if /i "%1"=="stop" (
-     %DIE_CMD% 10
-     goto done
- )
- if /i "%1"=="ping" (
-     echo Pinging ...
-     %PING_CMD%
-     if %errorlevel% EQU 0 (
-         echo Success!
-     ) else (
-         echo Failure!
-     )
-     goto done
- )
- if /i "%1"=="setup" (
-     %SETUP_CMD%
-     goto done
- )
- echo Syntax %0 ^<start ^| stop ^| ping ^| setup^>
- goto done
- 
- :nojava
-   echo JAVA_HOME or HQ_JAVA_HOME must be set when invoking the agent
-   goto done
- 
- :nojavaExe
-   echo HQ_JAVA_HOME\bin\java.exe does not exist
-   goto done
- 
- :done
- if "%OS%"=="Windows_NT" @endlocal
--- 0 ----
diff -rcN hq/bin/hq-agent-master.bat ../hq/bin/hq-agent-master.bat
*** hq/bin/hq-agent-master.bat	2009-01-01 14:08:26.000000000 +0530
--- ../hq/bin/hq-agent-master.bat	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,30 ****
- @echo off
- setlocal
- 
- if "%OS%"=="Windows_NT" goto nt
- echo This script only works with NT-based versions of Windows.
- goto :eof
- 
- :nt
- rem
- rem Find the application home.
- rem
- rem %~dp0 is location of current script under NT
- set _AGENTHOME=%~dp0..\
- 
- cd %_AGENTHOME%
- 
- set ROLLBACK_PROPS=conf\rollback.properties
- set AGENT_BUNDLE_PROP=set.HQ_AGENT_BUNDLE
- 
- rem look for the agent bundle property in the rollback properties file
- rem and invoke the bundle hq-agent.bat script
- for /F "delims== tokens=1*" %%i in (%ROLLBACK_PROPS%) do (
-   if "%%i"=="%AGENT_BUNDLE_PROP%" (
-     if not EXIST bundles\%%j\bin\hq-agent.bat (
-       echo Failed to find bundle script "%_AGENTHOME%bundles\%%j\bin\hq-agent.bat".
-     ) else (
-       call bundles\%%j\bin\hq-agent.bat %*
-     )
-   )
- )
--- 0 ----
diff -rcN hq/bin/hq-agent-master.sh ../hq/bin/hq-agent-master.sh
*** hq/bin/hq-agent-master.sh	2009-04-17 13:07:23.000000000 +0530
--- ../hq/bin/hq-agent-master.sh	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,30 ****
- #!/bin/sh
- 
- # find the current path to master executable
- FINDNAME=$0 
- while [ -h $FINDNAME ] ; do FINDNAME=`ls -ld $FINDNAME | awk '{print $NF}'` ; done 
- RUNDIR=`echo $FINDNAME | sed -e 's@/[^/]*$@@'` 
- unset FINDNAME
- 
- # cd to top level agent home
- if test -d $RUNDIR; then
-   cd $RUNDIR/..
- else
-   cd ..
- fi
- 
- ROLLBACK_PROPERTIES=conf/rollback.properties
- PROP_NAME=set.HQ_AGENT_BUNDLE
- 
- # resolve the HQ Agent Bundle property
- AGENT_BUNDLE=`grep $PROP_NAME $ROLLBACK_PROPERTIES | awk -F= '{print $2}'`
- 
- if test -d "./bundles/$AGENT_BUNDLE"; then
-   # be safe and set permissions for the invoked script
-   chmod -R +x ./bundles/$AGENT_BUNDLE/bin/* > /dev/null 2>&1
-   # pass on the command to the bundle
-   #echo "Invoking agent bundle $AGENT_BUNDLE"
-   ./bundles/$AGENT_BUNDLE/bin/hq-agent.sh "$@"
- else
-   echo "Bundle $AGENT_BUNDLE does not exist!"
- fi
--- 0 ----
diff -rcN hq/bin/hq-agent.sh ../hq/bin/hq-agent.sh
*** hq/bin/hq-agent.sh	2009-04-17 13:07:23.000000000 +0530
--- ../hq/bin/hq-agent.sh	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,123 ****
- #!/bin/sh
- 
- AGENTPROPFILE_PROP=agent.propFile
- AGENT_PROPS=../../conf/agent.properties
- AGENTLOGDIR_PROP=agent.logDir
- AGENTLOGDIR=../../log
- AGENTDATADIR_PROP=agent.dataDir
- AGENTDATADIR=../../data
- AGENT_LIB=./lib
- PDK_LIB=./pdk/lib
- WRAPPER_LIB=../../wrapper/lib
- # for /proc/net/tcp mirror
- SIGAR_PROC_NET=./tmp
- 
- # ------------- 
- # Shouldn't need to change anything below this
- # -------------
- 
- FINDNAME=$0 
- while [ -h $FINDNAME ] ; do FINDNAME=`ls -ld $FINDNAME | awk '{print $NF}'` ; done 
- RUNDIR=`echo $FINDNAME | sed -e 's@/[^/]*$@@'` 
- unset FINDNAME
- if test -d $RUNDIR; then
-   cd $RUNDIR/..
- else
-   cd ..
- fi
- 
- if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
-     HQ_JAVA_HOME=${HQ_JAVA_HOME}
- elif [ -d jre ]; then
-     HQ_JAVA_HOME=jre
-     # Just in case
-     chmod -R +x jre/bin/* > /dev/null 2>&1
- elif [ "x$JAVA_HOME" != "x" ] ; then
-     HQ_JAVA_HOME=${JAVA_HOME}
- else
-     case "`uname`" in
-     Darwin)
-         HQ_JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
-         ;;
-     *)
-         echo "HQ_JAVA_HOME or JAVA_HOME must be set when invoking the agent"
-         exit 1
-         ;;
-     esac
- fi
- 
- chmod +x ./pdk/scripts/* > /dev/null 2>&1
- 
- HQ_JAVA="${HQ_JAVA_HOME}/bin/java"
- 
- CLIENT_CLASSPATH=
- for i in `ls ${AGENT_LIB}/*.jar`
- do
-   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
- done
- 
- for i in `ls ${PDK_LIB}/*.jar`
- do
-   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
- done
- 
- for i in `ls ${WRAPPER_LIB}/*.jar`
- do
-   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
- done
- 
- CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
- 
- HQ_JAVA_OPTS="${HQ_JAVA_OPTS} \
-     -Xmx128m
-     -Dsun.net.inetaddr.ttl=60
-     -Djava.net.preferIPv4Stack=true \
-     -Djava.security.auth.login.config=jaas.config
-     -Dagent.install.home=../.. \
-     -Dagent.bundle.home=. \
-     -Djava.library.path=${WRAPPER_LIB}
-     -D${AGENTPROPFILE_PROP}=${AGENT_PROPS} \
-     -D${AGENTLOGDIR_PROP}=${AGENTLOGDIR} \
-     -D${AGENTDATADIR_PROP}=${AGENTDATADIR}"
- 
- CLIENT_CMD="${HQ_JAVA} \
-     ${HQ_JAVA_OPTS}
-     -cp ${CLIENT_CLASSPATH} ${CLIENT_CLASS}"
- 
- START_CMD="${CLIENT_CMD} start"
- STATUS_CMD="${CLIENT_CMD} status"
- PING_CMD="${CLIENT_CMD} ping"
- SETUP_CMD="${CLIENT_CMD} setup"
- DIE_CMD="${CLIENT_CMD} die"
- 
- if [ "$1" = "start" ] ; then
-     echo "Starting agent"
-     if ${START_CMD} ; then
-         exit 0        
-     else
-         exit 1
-     fi
- elif [ "$1" = "run" ] ; then
-     echo "Running agent"
-     echo ${START_CMD} 
-     ${START_CMD} 
- elif [ "$1" = "stop" ] ; then
-     ${DIE_CMD} 10 || exit 1
- elif [ "$1" = "status" ] ; then
-     ${STATUS_CMD} || exit 1
- elif [ "$1" = "ping" ] ; then
-     echo Pinging ...
-     VAL=`$PING_CMD 2>&1`
-     if [ "$?" = "0" ] ; then
-         echo 'Success!'
-     else
-         echo 'Failure!'
-         echo $VAL
-         exit 1
-     fi
- elif [ "$1" = "setup" ] ; then
-     ${SETUP_CMD}
- else
-     echo "Syntax: $0 "'<start | stop | ping | setup>'
-     exit 1
- fi
--- 0 ----
diff -rcN hq/bin/hq-agent-wrapper.bat ../hq/bin/hq-agent-wrapper.bat
*** hq/bin/hq-agent-wrapper.bat	2009-06-12 01:02:37.000000000 +0530
--- ../hq/bin/hq-agent-wrapper.bat	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,161 ****
- @echo off
- setlocal
- 
- rem Copyright (c) 1999, 2006 Tanuki Software Inc.
- rem
- rem Java Service Wrapper command based script
- rem
- 
- if "%OS%"=="Windows_NT" goto nt
- echo This script only works with NT-based versions of Windows.
- goto :eof
- 
- :nt
- rem
- rem Find the application home.
- rem
- rem %~dp0 is location of current script under NT
- set _REALPATH=%~dp0..\..\..\wrapper\sbin
- 
- set AGENT_INSTALL_HOME=%~dp0..\..\..
- set AGENT_BUNDLE_HOME=%~dp0..
- 
- rem
- rem Detect HQ_JAVA_HOME
- rem
- cd %_REALPATH%
- 
- if not "%HQ_JAVA_HOME%"=="" goto gothqjava
- 
- if EXIST "%AGENT_INSTALL_HOME%\jre" (
-     set HQ_JAVA_HOME=%AGENT_INSTALL_HOME%\jre
-     goto gotjava
- )
- 
- :nojava
-   echo HQ_JAVA_HOME must be set when invoking the agent
- goto :eof
- 
- :gothqjava
- if not EXIST "%HQ_JAVA_HOME%" (
-   echo HQ_JAVA_HOME must be set to a valid directory
-   goto :eof
- ) else (
-   set HQ_JAVA_HOME=%HQ_JAVA_HOME%
- )
- 
- :gotjava
- rem Decide on the wrapper binary.
- set _WRAPPER_BASE=wrapper
- set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%-windows-x86-32.exe
- if exist "%_WRAPPER_EXE%" goto validate
- set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%-windows-x86-64.exe
- if exist "%_WRAPPER_EXE%" goto validate
- set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%.exe
- if exist "%_WRAPPER_EXE%" goto validate
- echo Unable to locate a Wrapper executable using any of the following names:
- echo %_REALPATH%\%_WRAPPER_BASE%-windows-x86-32.exe
- echo %_REALPATH%\%_WRAPPER_BASE%-windows-x86-64.exe
- echo %_REALPATH%\%_WRAPPER_BASE%.exe
- pause
- goto :eof
- 
- :validate
- rem Find the requested command.
- for /F %%v in ('echo %1^|findstr "^start$ ^stop$ ^restart$ ^install$ ^remove$ ^query$ ^ping$ ^setup"') do call :exec set COMMAND=%%v
- 
- if "%COMMAND%" == "" (
-     echo Usage: %0 { start : stop : restart : install : remove : query : ping : setup }
-     pause
-     goto :eof
- ) else (
-     shift
- )
- 
- rem
- rem Find the wrapper.conf
- rem
- :conf
- set _WRAPPER_CONF="%AGENT_INSTALL_HOME%\conf\wrapper.conf"
- 
- rem
- rem Set some HQ properties
- rem
- set AGENT_BUNDLE_HOME_PROP=agent.bundle.home
- set AGENT_INSTALL_HOME_PROP=agent.install.home
- set AGENT_LIB=%AGENT_BUNDLE_HOME%\lib
- set PDK_LIB=%AGENT_BUNDLE_HOME%\pdk\lib
- 
- set CLIENT_CLASSPATH=%AGENT_LIB%\AgentClient.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-logging.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\log4j-1.2.14.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hyperic-util.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\sigar.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hq-product.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-httpclient-3.1.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-codec-1.3.jar
- set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\lather.jar
- 
- set CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
- 
- set CLIENT_CMD="%HQ_JAVA_HOME%\bin\java" -Djava.net.preferIPv4Stack=true -D%AGENT_INSTALL_HOME_PROP%="%AGENT_INSTALL_HOME%" -D%AGENT_BUNDLE_HOME_PROP%="%AGENT_BUNDLE_HOME%" -cp "%CLIENT_CLASSPATH%" %CLIENT_CLASS%
- 
- set PING_CMD=%CLIENT_CMD% ping
- set SETUP_CMD=%CLIENT_CMD% setup
- set SETUP_IF_NO_PROVIDER_CMD=%CLIENT_CMD% setup-if-no-provider
- 
- rem
- rem Run the application.
- rem At runtime, the current directory will be that of wrapper.exe
- rem
- call :%COMMAND%
- if errorlevel 1 pause
- goto :eof
- 
- :start
- "%_WRAPPER_EXE%" -t %_WRAPPER_CONF%
- call :setup-if-no-provider
- goto :eof
- 
- :stop
- "%_WRAPPER_EXE%" -p %_WRAPPER_CONF%
- goto :eof
- 
- :install
- "%_WRAPPER_EXE%" -i %_WRAPPER_CONF%
- goto :eof
- 
- :remove
- "%_WRAPPER_EXE%" -r %_WRAPPER_CONF%
- goto :eof
- 
- :query
- "%_WRAPPER_EXE%" -q %_WRAPPER_CONF%
- goto :eof
- 
- :restart
- call :stop
- call :start
- goto :eof
- 
- :exec
- %*
- goto :eof
- 
- rem
- rem HQ Agent specific commands
- rem
- 
- :ping
- %PING_CMD%
- IF %ERRORLEVEL% NEQ 0 (echo Ping failed!) else echo Ping success!
- goto :eof
- 
- :setup
- %SETUP_CMD%
- goto :eof
- 
- :setup-if-no-provider
- %SETUP_IF_NO_PROVIDER_CMD%
- goto :eof
--- 0 ----
diff -rcN hq/bin/hq-agent-wrapper.sh ../hq/bin/hq-agent-wrapper.sh
*** hq/bin/hq-agent-wrapper.sh	2009-06-04 13:08:09.000000000 +0530
--- ../hq/bin/hq-agent-wrapper.sh	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,816 ****
- #! /bin/sh
- 
- #
- # Copyright (c) 1999, 2006 Tanuki Software Inc.
- #
- # Java Service Wrapper sh script.  Suitable for starting and stopping
- #  wrapped Java applications on UNIX platforms.
- #
- 
- #-----------------------------------------------------------------------------
- # These settings can be modified to fit the needs of your application
- 
- # Application
- APP_NAME="hq-agent"
- APP_LONG_NAME="HQ Agent"
- 
- # Wrapper
- WRAPPER_CMD="../../wrapper/sbin/wrapper"
- WRAPPER_CMD_PS="sbin/wrapper"
- WRAPPER_CONF="../../conf/wrapper.conf"
- 
- # Priority at which to run the wrapper.  See "man nice" for valid priorities.
- #  nice is only used if a priority is specified.
- PRIORITY=
- 
- # Location of the pid file.
- PIDDIR="../../wrapper"
- 
- # If uncommented, causes the Wrapper to be shutdown using an anchor file.
- #  When launched with the 'start' command, it will also ignore all INT and
- #  TERM signals.
- #IGNORE_SIGNALS=true
- 
- # Wrapper will start the JVM asynchronously. Your application may have some
- #  initialization tasks and it may be desirable to wait a few seconds
- #  before returning.  For example, to delay the invocation of following
- #  startup scripts.  Setting WAIT_AFTER_STARTUP to a positive number will
- #  cause the start command to delay for the indicated period of time 
- #  (in seconds).
- # 
- WAIT_AFTER_STARTUP=0
- 
- # If set, the status, start_msg and stop_msg commands will print out detailed
- #   state information on the Wrapper and Java processes.
- #DETAIL_STATUS=true
- 
- # If specified, the Wrapper will be run as the specified user.
- # IMPORTANT - Make sure that the user has the required privileges to write
- #  the PID file and wrapper.log files.  Failure to be able to write the log
- #  file will cause the Wrapper to exit without any way to write out an error
- #  message.
- # NOTE - This will set the user which is used to run the Wrapper as well as
- #  the JVM and is not useful in situations where a privileged resource or
- #  port needs to be allocated prior to the user being changed.
- #RUN_AS_USER=
- 
- # The following two lines are used by the chkconfig command. Change as is
- #  appropriate for your application.  They should remain commented.
- # chkconfig: 2345 20 80
- # description: @app.long.name@
-  
- # Initialization block for the install_initd and remove_initd scripts used by
- #  SUSE linux distributions.
- ### BEGIN INIT INFO
- # Provides: @app.name@
- # Required-Start: $local_fs $network $syslog
- # Should-Start: 
- # Required-Stop:
- # Default-Start: 2 3 4 5
- # Default-Stop: 0 1 6
- # Short-Description: @app.long.name@
- # Description: @app.description@
- ### END INIT INFO
- 
- # Do not modify anything beyond this point
- #-----------------------------------------------------------------------------
- 
- # Get the fully qualified path to the script
- case $0 in
-     /*)
-         SCRIPT="$0"
-         ;;
-     *)
-         PWD=`pwd`
-         SCRIPT="$PWD/$0"
-         ;;
- esac
- 
- # Resolve the true real path without any sym links.
- CHANGED=true
- while [ "X$CHANGED" != "X" ]
- do
-     # Change spaces to ":" so the tokens can be parsed.
-     SAFESCRIPT=`echo $SCRIPT | sed -e 's; ;:;g'`
-     # Get the real path to this script, resolving any symbolic links
-     TOKENS=`echo $SAFESCRIPT | sed -e 's;/; ;g'`
-     REALPATH=
-     for C in $TOKENS; do
-         # Change any ":" in the token back to a space.
-         C=`echo $C | sed -e 's;:; ;g'`
-         REALPATH="$REALPATH/$C"
-         # If REALPATH is a sym link, resolve it.  Loop for nested links.
-         while [ -h "$REALPATH" ] ; do
-             LS="`ls -ld "$REALPATH"`"
-             LINK="`expr "$LS" : '.*-> \(.*\)$'`"
-             if expr "$LINK" : '/.*' > /dev/null; then
-                 # LINK is absolute.
-                 REALPATH="$LINK"
-             else
-                 # LINK is relative.
-                 REALPATH="`dirname "$REALPATH"`""/$LINK"
-             fi
-         done
-     done
- 
-     if [ "$REALPATH" = "$SCRIPT" ]
-     then
-         CHANGED=""
-     else
-         SCRIPT="$REALPATH"
-     fi
- done
- 
- # resolve the current HQ Agent bundle home
- cd "`dirname "$REALPATH"`/.."
- 
- AGENT_BUNDLE_HOME=`pwd`
- cd ../..
- AGENT_INSTALL_HOME=`pwd`
- # invoke the Java Service Wrapper from the wrapper sbin
- # directory for compatibility with Windows
- cd wrapper/sbin
- REALDIR=`pwd`
- 
- # ------------- 
- # Begin HQ Agent specific logic
- # ------------- 
- AGENT_BUNDLE_HOME_PROP=agent.bundle.home
- AGENT_INSTALL_HOME_PROP=agent.install.home
- AGENT_LIB=$AGENT_BUNDLE_HOME/lib
- PDK_LIB=$AGENT_BUNDLE_HOME/pdk/lib
- # for /proc/net/tcp mirror
- SIGAR_PROC_NET=$AGENT_BUNDLE_HOME/tmp
- 
- if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
-     HQ_JAVA_HOME=${HQ_JAVA_HOME}
- elif [ -d "${AGENT_INSTALL_HOME}/jre" ]; then
-     HQ_JAVA_HOME="${AGENT_INSTALL_HOME}"/jre
-     # Just in case
-     chmod -R +x "${AGENT_INSTALL_HOME}"/jre/bin/* > /dev/null 2>&1
- elif [ "x$JAVA_HOME" != "x" ] ; then
-     HQ_JAVA_HOME=${JAVA_HOME}
- else
-     case "`uname`" in
-     Darwin)
-         HQ_JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
-         ;;
-     *)
-         echo "HQ_JAVA_HOME or JAVA_HOME must be set when invoking the agent"
-         exit 1
-         ;;
-     esac
- fi
- 
- # export environment variables to be picked up by the Java Service Wrapper process
- export HQ_JAVA_HOME
- export SIGAR_PROC_NET
- 
- chmod +x "${AGENT_BUNDLE_HOME}"/pdk/scripts/* > /dev/null 2>&1
- 
- HQ_JAVA="${HQ_JAVA_HOME}/bin/java"
- # verify that the java command actually exists
- if [ ! -f "$HQ_JAVA" ]
- then
-         echo Invalid Java Home detected at ${HQ_JAVA_HOME}
-         exit 1
- fi
- 
- CLIENT_CLASSPATH="${AGENT_LIB}/AgentClient.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/ant.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-logging.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/log4j-1.2.14.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/hyperic-util.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/sigar.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/hq-product.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-httpclient-3.1.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-codec-1.3.jar"
- CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${AGENT_LIB}/lather.jar"
- 
- CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
- 
- CLIENT_CMD="${HQ_JAVA} \
-     -Djava.net.preferIPv4Stack=true \
-     -D${AGENT_INSTALL_HOME_PROP}=${AGENT_INSTALL_HOME} \
-     -D${AGENT_BUNDLE_HOME_PROP}=${AGENT_BUNDLE_HOME} \
-     -cp ${CLIENT_CLASSPATH} ${CLIENT_CLASS}"
- 
- PING_CMD="${CLIENT_CMD} ping"
- SETUP_CMD="${CLIENT_CMD} setup"
- STATUS_CMD="${CLIENT_CMD} status"
- SETUP_IF_NO_PROVIDER_CMD="${CLIENT_CMD} setup-if-no-provider"
- # ------------- 
- # End HQ specific logic
- # ------------- 
- 
- # If the PIDDIR is relative, set its value relative to the full REALPATH to avoid problems if
- #  the working directory is later changed.
- FIRST_CHAR=`echo $PIDDIR | cut -c1,1`
- if [ "$FIRST_CHAR" != "/" ]
- then
-     PIDDIR=$REALDIR/$PIDDIR
- fi
- # Same test for WRAPPER_CMD
- FIRST_CHAR=`echo $WRAPPER_CMD | cut -c1,1`
- if [ "$FIRST_CHAR" != "/" ]
- then
-     WRAPPER_CMD=$REALDIR/$WRAPPER_CMD
- fi
- # Same test for WRAPPER_CONF
- FIRST_CHAR=`echo $WRAPPER_CONF | cut -c1,1`
- if [ "$FIRST_CHAR" != "/" ]
- then
-     WRAPPER_CONF=$REALDIR/$WRAPPER_CONF
- fi
- 
- # Process ID
- ANCHORFILE="$PIDDIR/$APP_NAME.anchor"
- STATUSFILE="$PIDDIR/$APP_NAME.status"
- JAVASTATUSFILE="$PIDDIR/$APP_NAME.java.status"
- PIDFILE="$PIDDIR/$APP_NAME.pid"
- LOCKDIR="/var/lock/subsys"
- LOCKFILE="$LOCKDIR/$APP_NAME"
- pid=""
- 
- # Resolve the location of the 'ps' command
- PSEXE="/usr/bin/ps"
- if [ ! -x "$PSEXE" ]
- then
-     PSEXE="/bin/ps"
-     if [ ! -x "$PSEXE" ]
-     then
-         echo "Unable to locate 'ps'."
-         echo "Please report this message along with the location of the command on your system."
-         exit 1
-     fi
- fi
- 
- # Resolve the os
- DIST_OS=`uname -s | tr [:upper:] [:lower:] | tr -d [:blank:]`
- DIST_BITS="32"
- case "$DIST_OS" in
-     'sunos')
-         DIST_OS="solaris"
-         ;;
-     'hp-ux')
-         # HP-UX needs the XPG4 version of ps (for -o args)
-         DIST_OS="hpux"
-         UNIX95=""
-         export UNIX95
-         ;;
-     'hp-ux64')
-         # HP-UX needs the XPG4 version of ps (for -o args)
-         DIST_OS="hpux"
-         UNIX95=""
-         export UNIX95
-         DIST_BITS="64"
-         ;;
-     'darwin')
-         DIST_OS="macosx"
-         ;;
-     'unix_sv')
-         DIST_OS="unixware"
-         ;;
- esac
- 
- # Resolve the architecture
- if [ "$DIST_OS" = "macosx" ]
- then
-     DIST_ARCH="universal"
- else
-     DIST_ARCH=
-     DIST_ARCH=`uname -p 2>/dev/null | tr [:upper:] [:lower:] | tr -d [:blank:]`
-     if [ "X$DIST_ARCH" = "X" ]
-     then
-         DIST_ARCH="unknown"
-     fi
-     if [ "$DIST_ARCH" = "unknown" ]
-     then
-         DIST_ARCH=`uname -m 2>/dev/null | tr [:upper:] [:lower:] | tr -d [:blank:]`
-     fi
- 
-     case "$DIST_ARCH" in
-         'athlon' | 'i386' | 'i486' | 'i586' | 'i686')
-             DIST_ARCH="x86"
-             ;;
-         'amd64' | 'x86_64')
-             DIST_ARCH="x86"
-             DIST_BITS="64"
-             ;;            
-         'ia32')
-             DIST_ARCH="ia"
-             ;;
-         'ia64' | 'ia64n' | 'ia64w')
-             DIST_ARCH="ia"
-             DIST_BITS="64"
-             ;;            
-         'ip27')
-             DIST_ARCH="mips"
-             ;;
-         'power' | 'powerpc' | 'power_pc' | 'ppc64')
-             DIST_ARCH="ppc"
-             ;;
-         'pa_risc' | 'pa-risc')
-             DIST_ARCH="parisc"
-             ;;
-         'sun4u' | 'sparcv9')
-             DIST_ARCH="sparc"
-             ;;
-         '9000/800')
-             DIST_ARCH="parisc"
-             ;;
-     esac
- fi
- 
- outputFile() {
-     if [ -f "$1" ]
-     then
-         echo "  $1 (Found but not executable.)";
-     else
-         echo "  $1"
-     fi
- }
- 
- # Decide on the wrapper binary to use.
- # First, try out the detected bit version
- # If not available, try 32 bits followed by 64 bits.
- if [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-$DIST_BITS" ]
- then
-   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-$DIST_BITS"
- elif [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32" ]
- then
-   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32"
- elif [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64" ]
- then
-   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64"
- else
-   if [ ! -x "$WRAPPER_CMD" ]
-     then
-       echo "Unable to locate any of the following binaries:"
-       outputFile "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32"
-       outputFile "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64"
-       outputFile "$WRAPPER_CMD"
-       exit 1
-   fi
- fi
- 
- # Build the nice clause
- if [ "X$PRIORITY" = "X" ]
- then
-     CMDNICE=""
- else
-     CMDNICE="nice -$PRIORITY"
- fi
- 
- # Build the anchor file clause.
- if [ "X$IGNORE_SIGNALS" = "X" ]
- then
-    ANCHORPROP=
-    IGNOREPROP=
- else
-    ANCHORPROP=wrapper.anchorfile=\"$ANCHORFILE\"
-    IGNOREPROP=wrapper.ignore_signals=TRUE
- fi
- 
- # Build the status file clause.
- if [ "X$DETAIL_STATUS" = "X" ]
- then
-    STATUSPROP=
- else
-    STATUSPROP="wrapper.statusfile=\"$STATUSFILE\" wrapper.java.statusfile=\"$JAVASTATUSFILE\""
- fi
- 
- # Build the lock file clause.  Only create a lock file if the lock directory exists on this platform.
- LOCKPROP=
- if [ -d $LOCKDIR ]
- then
-     if [ -w $LOCKDIR ]
-     then
-         LOCKPROP=wrapper.lockfile=\"$LOCKFILE\"
-     fi
- fi
- 
- checkUser() {
-     # $1 touchLock flag
-     # $2 command
- 
-     # Check the configured user.  If necessary rerun this script as the desired user.
-     if [ "X$RUN_AS_USER" != "X" ]
-     then
-         # Resolve the location of the 'id' command
-         IDEXE="/usr/xpg4/bin/id"
-         if [ ! -x "$IDEXE" ]
-         then
-             IDEXE="/usr/bin/id"
-             if [ ! -x "$IDEXE" ]
-             then
-                 echo "Unable to locate 'id'."
-                 echo "Please report this message along with the location of the command on your system."
-                 exit 1
-             fi
-         fi
-     
-         if [ "`$IDEXE -u -n`" = "$RUN_AS_USER" ]
-         then
-             # Already running as the configured user.  Avoid password prompts by not calling su.
-             RUN_AS_USER=""
-         fi
-     fi
-     if [ "X$RUN_AS_USER" != "X" ]
-     then
-         # If LOCKPROP and $RUN_AS_USER are defined then the new user will most likely not be
-         # able to create the lock file.  The Wrapper will be able to update this file once it
-         # is created but will not be able to delete it on shutdown.  If $2 is defined then
-         # the lock file should be created for the current command
-         if [ "X$LOCKPROP" != "X" ]
-         then
-             if [ "X$1" != "X" ]
-             then
-                 # Resolve the primary group 
-                 RUN_AS_GROUP=`groups $RUN_AS_USER | awk '{print $3}' | tail -1`
-                 if [ "X$RUN_AS_GROUP" = "X" ]
-                 then
-                     RUN_AS_GROUP=$RUN_AS_USER
-                 fi
-                 touch $LOCKFILE
-                 chown $RUN_AS_USER:$RUN_AS_GROUP $LOCKFILE
-             fi
-         fi
- 
-         # Still want to change users, recurse.  This means that the user will only be
-         #  prompted for a password once. Variables shifted by 1
-         # 
-         # Use "runuser" if this exists.  runuser should be used on RedHat in preference to su.
-         #
-         if test -f "/sbin/runuser"
-         then
-             /sbin/runuser - $RUN_AS_USER -c "\"$REALPATH\" $2"
-         else
-             su - $RUN_AS_USER -c "\"$REALPATH\" $2"
-         fi
- 
-         # Now that we are the original user again, we may need to clean up the lock file.
-         if [ "X$LOCKPROP" != "X" ]
-         then
-             getpid
-             if [ "X$pid" = "X" ]
-             then
-                 # Wrapper is not running so make sure the lock file is deleted.
-                 if [ -f "$LOCKFILE" ]
-                 then
-                     rm "$LOCKFILE"
-                 fi
-             fi
-         fi
- 
-         exit 0
-     fi
- }
- 
- getpid() {
-     pid=""
-     if [ -f "$PIDFILE" ]
-     then
-         if [ -r "$PIDFILE" ]
-         then
-             pid=`cat "$PIDFILE"`
-             if [ "X$pid" != "X" ]
-             then
-                 # It is possible that 'a' process with the pid exists but that it is not the
-                 #  correct process.  This can happen in a number of cases, but the most
-                 #  common is during system startup after an unclean shutdown.
-                 # The ps statement below looks for the specific wrapper command running as
-                 #  the pid.  If it is not found then the pid file is considered to be stale.
-                 case "$DIST_OS" in
-                     'macosx')
-                         pidtest=`$PSEXE -ww -p $pid -o command | grep "$WRAPPER_CMD_PS" | tail -1`
-                         ;;
-                     'solaris')
-                         PSEXE="/usr/ucb/ps" 
-                         pidtest=`$PSEXE ww $pid | grep "$WRAPPER_CMD" | tail -1` 
-                         ;;
-                     'hpux')
-                         pidtest=`$PSEXE -p $pid -x -o args | grep "$WRAPPER_CMD_PS" | tail -1`
-                         ;;
-                     *)
-                         pidtest=`$PSEXE -p $pid -o args | grep "$WRAPPER_CMD_PS" | tail -1`
-                         ;;
-                 esac
- 
-                 if [ "X$pidtest" = "X" ]
-                 then
-                     # This is a stale pid file.
-                     rm -f "$PIDFILE"
-                     echo "Removed stale pid file: $PIDFILE"
-                     pid=""
-                 fi
-             fi
-         else
-             echo "Cannot read $PIDFILE."
-             exit 1
-         fi
-     fi
- }
- 
- getstatus() {
-     STATUS=
-     if [ -f "$STATUSFILE" ]
-     then
-         if [ -r "$STATUSFILE" ]
-         then
-             STATUS=`cat "$STATUSFILE"`
-         fi
-     fi
-     if [ "X$STATUS" = "X" ]
-     then
-         STATUS="Unknown"
-     fi
-     
-     JAVASTATUS=
-     if [ -f "$JAVASTATUSFILE" ]
-     then
-         if [ -r "$JAVASTATUSFILE" ]
-         then
-             JAVASTATUS=`cat "$JAVASTATUSFILE"`
-         fi
-     fi
-     if [ "X$JAVASTATUS" = "X" ]
-     then
-         JAVASTATUS="Unknown"
-     fi
- }
- 
- testpid() {
-     # It is possible that 'a' process with the pid exists but that it is not the
-     # correct process. This can happen in a number of cases, but the most
-     # common is during system startup after an unclean shutdown.
-     # The ps statement below looks for the specific wrapper command running as
-     # the pid. If it is not found then the pid file is considered to be stale.
-     case "$DIST_OS" in
-         'macosx')
-             pid=`$PSEXE -ww $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
-             ;;
-         'solaris')
-             PSEXE="/usr/ucb/ps"
-             pid=`$PSEXE ww $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
-             ;;
-         *)
-             pid=`$PSEXE -p $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
-             ;;
-     esac
-     if [ "X$pid" = "X" ]
-     then
-         # Process is gone so remove the pid file.
-         rm -f "$PIDFILE"
-         pid=""
-     fi
- } 
-  
- start() {
-     echo -n "Starting $APP_LONG_NAME..."
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         # The string passed to eval must handles spaces in paths correctly.
-         COMMAND_LINE="$CMDNICE \"$WRAPPER_CMD\" \"$WRAPPER_CONF\" wrapper.syslog.ident=\"$APP_NAME\" wrapper.pidfile=\"$PIDFILE\" wrapper.name=\"$APP_NAME\" wrapper.displayname=\"$APP_LONG_NAME\" wrapper.daemonize=TRUE $ANCHORPROP $IGNOREPROP $STATUSPROP $LOCKPROP"
-         eval $COMMAND_LINE
-     else
-         echo "$APP_LONG_NAME is already running."
-         exit 1
-     fi
- 
-     # Sleep for a few seconds to allow for intialization if required 
-     #  then test to make sure we're still running.
-     #
-     i=0
-     while [ $i -lt $WAIT_AFTER_STARTUP ]
-     do
-         sleep 1
-         echo -n "."
-         i=`expr $i + 1`
-     done
-     if [ $WAIT_AFTER_STARTUP -gt 0 ]
-     then
-         getpid
-         if [ "X$pid" = "X" ]
-         then
-             echo " WARNING: $APP_LONG_NAME may have failed to start."
-             exit 1
-         else
-             echo " running ($pid)."
-         fi
-     else 
-         echo ""
-     fi
-     
-     ${SETUP_IF_NO_PROVIDER_CMD}
- }
-  
- stopit() {
-     echo "Stopping $APP_LONG_NAME..."
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         echo "$APP_LONG_NAME was not running."
-     else
-         if [ "X$IGNORE_SIGNALS" = "X" ]
-         then
-             # Running so try to stop it.
-             kill $pid
-             if [ $? -ne 0 ]
-             then
-                 # An explanation for the failure should have been given
-                 echo "Unable to stop $APP_LONG_NAME."
-                 exit 1
-             fi
-         else
-             rm -f "$ANCHORFILE"
-             if [ -f "$ANCHORFILE" ]
-             then
-                 # An explanation for the failure should have been given
-                 echo "Unable to stop $APP_LONG_NAME."
-                 exit 1
-             fi
-         fi
- 
-         # We can not predict how long it will take for the wrapper to
-         #  actually stop as it depends on settings in wrapper.conf.
-         #  Loop until it does.
-         savepid=$pid
-         CNT=0
-         TOTCNT=0
-         while [ "X$pid" != "X" ]
-         do
-             # Show a waiting message every 5 seconds.
-             if [ "$CNT" -lt "5" ]
-             then
-                 CNT=`expr $CNT + 1`
-             else
-                 echo "Waiting for $APP_LONG_NAME to exit..."
-                 CNT=0
-             fi
-             TOTCNT=`expr $TOTCNT + 1`
- 
-             sleep 1
- 
-             testpid
-         done
- 
-         pid=$savepid
-         testpid
-         if [ "X$pid" != "X" ]
-         then
-             echo "Failed to stop $APP_LONG_NAME."
-             exit 1
-         else
-             echo "Stopped $APP_LONG_NAME."
-         fi
-     fi
- }
- 
- status() {
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         echo "$APP_LONG_NAME is not running."
-         exit 1
-     else
-         if [ "X$DETAIL_STATUS" = "X" ]
-         then
-             echo "$APP_LONG_NAME is running (PID:$pid)."
-             ${STATUS_CMD}
-         else
-             getstatus
-             echo "$APP_LONG_NAME is running (PID:$pid, Wrapper:$STATUS, Java:$JAVASTATUS)"
-             ${STATUS_CMD}
-         fi
-         exit 0
-     fi
- }
- 
- dump() {
-     echo "Dumping $APP_LONG_NAME..."
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         echo "$APP_LONG_NAME was not running."
-     else
-         kill -3 $pid
- 
-         if [ $? -ne 0 ]
-         then
-             echo "Failed to dump $APP_LONG_NAME."
-             exit 1
-         else
-             echo "Dumped $APP_LONG_NAME."
-         fi
-     fi
- }
- 
- # Used by HP-UX init scripts.
- startmsg() {
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         echo "Starting $APP_LONG_NAME... (Wrapper:Stopped)"
-     else
-         if [ "X$DETAIL_STATUS" = "X" ]
-         then
-             echo "Starting $APP_LONG_NAME... (Wrapper:Running)"
-         else
-             getstatus
-             echo "Starting $APP_LONG_NAME... (Wrapper:$STATUS, Java:$JAVASTATUS)"
-         fi
-     fi
- }
- 
- # Used by HP-UX init scripts.
- stopmsg() {
-     getpid
-     if [ "X$pid" = "X" ]
-     then
-         echo "Stopping $APP_LONG_NAME... (Wrapper:Stopped)"
-     else
-         if [ "X$DETAIL_STATUS" = "X" ]
-         then
-             echo "Stopping $APP_LONG_NAME... (Wrapper:Running)"
-         else
-             getstatus
-             echo "Stopping $APP_LONG_NAME... (Wrapper:$STATUS, Java:$JAVASTATUS)"
-         fi
-     fi
- }
- 
- 
- ping() {
-     echo Pinging ...
-     VAL=`$PING_CMD 2>&1`
-     if [ "$?" = "0" ] ; then
-         echo 'Success!'
-     else
-         echo 'Failure!'
-         echo $VAL
-         exit 1
-     fi
- }
- 
- # Used by HP-UX init scripts.
- setup() {
-     ${SETUP_CMD}
- }
- 
- case "$1" in
- 
-     'start')
-         checkUser touchlock $1
-         start
-         ;;
- 
-     'stop')
-         checkUser "" $1
-         stopit
-         ;;
- 
-     'restart')
-         checkUser touchlock $1
-         stopit
-         start
-         ;;
- 
-     'status')
-         checkUser "" $1
-         status
-         ;;
- 
-     'dump')
-         checkUser "" $1
-         dump
-         ;;
- 
-     'start_msg')
-         checkUser "" $1
-         startmsg
-         ;;
- 
-     'stop_msg')
-         checkUser "" $1
-         stopmsg
-         ;;
-         
-     'ping')
-         checkUser "" $1
-         ping
-         ;;
-         
-     'setup')
-         checkUser "" $1
-         setup
-         ;;        
- 
-     *)
-         echo "Usage: $0 { start | stop | restart | status | dump | ping | setup }"
-         exit 1
-         ;;
- esac
- 
- exit 0
--- 0 ----
diff -rcN hq/bin/pphq-agent.bat ../hq/bin/pphq-agent.bat
*** hq/bin/pphq-agent.bat	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent.bat	2008-07-03 11:36:37.000000000 +0530
***************
*** 0 ****
--- 1,96 ----
+ @echo off
+ if "%OS%" == "Windows_NT" setlocal
+ 
+ set PDK_LIB=pdk\lib
+ set AGENT_LIB=lib
+ 
+ rem # ------------- 
+ rem # Shouldn't need to change anything below this
+ rem # -------------
+ 
+ SET RUNDIR=%~dp0
+ cd %RUNDIR%
+ if not "%HQ_JAVA_HOME%"=="" (
+     set JAVA_HOME=%HQ_JAVA_HOME%
+     goto gotjava
+ )
+ if EXIST %RUNDIR%\jre\nul (
+     set JAVA_HOME=%RUNDIR%\jre
+     goto gotjava
+ )
+ if "%JAVA_HOME%"=="" goto nojava
+ 
+ if not exist "%JAVA_HOME%\bin\java.exe" goto nojavaExe
+ 
+ :gotjava
+ set JAVA=%JAVA_HOME%\bin\java
+ 
+ set CLIENT_CLASSPATH=%AGENT_LIB%\AgentClient.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\AgentServer.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\lather.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-logging.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\log4j-1.2.14.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jdom-1.1.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hyperic-util.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\sigar.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\bcel-5.1.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hq-product.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jakarta-oro-2.0.7.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\jxla.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-httpclient-3.1.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-codec-1.3.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\groovy-all-1.5.jar
+ 
+ set CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
+ 
+ set CLIENT_CMD="%JAVA%" -classpath "%CLIENT_CLASSPATH%" %CLIENT_CLASS%
+ 
+ set START_CMD=%CLIENT_CMD% start
+ set PING_CMD=%CLIENT_CMD% ping
+ set SETUP_CMD=%CLIENT_CMD% setup
+ set DIE_CMD=%CLIENT_CMD% die
+ 
+ if /i "%1"=="start" (
+     echo Starting agent
+     %START_CMD%
+     goto done
+ )
+ if /i "%1"=="run" (
+     echo Running agent
+     echo %START_CMD%
+     %START_CMD%
+     goto done
+ )
+ if /i "%1"=="stop" (
+     %DIE_CMD% 10
+     goto done
+ )
+ if /i "%1"=="ping" (
+     echo Pinging ...
+     %PING_CMD%
+     if %errorlevel% EQU 0 (
+         echo Success!
+     ) else (
+         echo Failure!
+     )
+     goto done
+ )
+ if /i "%1"=="setup" (
+     %SETUP_CMD%
+     goto done
+ )
+ echo Syntax %0 ^<start ^| stop ^| ping ^| setup^>
+ goto done
+ 
+ :nojava
+   echo JAVA_HOME or HQ_JAVA_HOME must be set when invoking the agent
+   goto done
+ 
+ :nojavaExe
+   echo HQ_JAVA_HOME\bin\java.exe does not exist
+   goto done
+ 
+ :done
+ if "%OS%"=="Windows_NT" @endlocal
diff -rcN hq/bin/pphq-agent-master.bat ../hq/bin/pphq-agent-master.bat
*** hq/bin/pphq-agent-master.bat	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent-master.bat	2010-02-03 11:20:43.172736849 +0530
***************
*** 0 ****
--- 1,30 ----
+ @echo off
+ setlocal
+ 
+ if "%OS%"=="Windows_NT" goto nt
+ echo This script only works with NT-based versions of Windows.
+ goto :eof
+ 
+ :nt
+ rem
+ rem Find the application home.
+ rem
+ rem %~dp0 is location of current script under NT
+ set _AGENTHOME=%~dp0..\
+ 
+ cd %_AGENTHOME%
+ 
+ set ROLLBACK_PROPS=conf\rollback.properties
+ set AGENT_BUNDLE_PROP=set.HQ_AGENT_BUNDLE
+ 
+ rem look for the agent bundle property in the rollback properties file
+ rem and invoke the bundle pphq-agent.bat script
+ for /F "delims== tokens=1*" %%i in (%ROLLBACK_PROPS%) do (
+   if "%%i"=="%AGENT_BUNDLE_PROP%" (
+     if not EXIST bundles\%%j\bin\pphq-agent.bat (
+       echo Failed to find bundle script "%_AGENTHOME%bundles\%%j\bin\pphq-agent.bat".
+     ) else (
+       call bundles\%%j\bin\pphq-agent.bat %*
+     )
+   )
+ )
diff -rcN hq/bin/pphq-agent-master.sh ../hq/bin/pphq-agent-master.sh
*** hq/bin/pphq-agent-master.sh	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent-master.sh	2010-02-03 11:18:56.000857545 +0530
***************
*** 0 ****
--- 1,30 ----
+ #!/bin/sh
+ 
+ # find the current path to master executable
+ FINDNAME=$0 
+ while [ -h $FINDNAME ] ; do FINDNAME=`ls -ld $FINDNAME | awk '{print $NF}'` ; done 
+ RUNDIR=`echo $FINDNAME | sed -e 's@/[^/]*$@@'` 
+ unset FINDNAME
+ 
+ # cd to top level agent home
+ if test -d $RUNDIR; then
+   cd $RUNDIR/..
+ else
+   cd ..
+ fi
+ 
+ ROLLBACK_PROPERTIES=conf/rollback.properties
+ PROP_NAME=set.HQ_AGENT_BUNDLE
+ 
+ # resolve the HQ Agent Bundle property
+ AGENT_BUNDLE=`grep $PROP_NAME $ROLLBACK_PROPERTIES | awk -F= '{print $2}'`
+ 
+ if test -d "./bundles/$AGENT_BUNDLE"; then
+   # be safe and set permissions for the invoked script
+   chmod -R +x ./bundles/$AGENT_BUNDLE/bin/* > /dev/null 2>&1
+   # pass on the command to the bundle
+   #echo "Invoking agent bundle $AGENT_BUNDLE"
+   ./bundles/$AGENT_BUNDLE/bin/pphq-agent.sh "$@"
+ else
+   echo "Bundle $AGENT_BUNDLE does not exist!"
+ fi
diff -rcN hq/bin/pphq-agent.sh ../hq/bin/pphq-agent.sh
*** hq/bin/pphq-agent.sh	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent.sh	2009-04-17 13:07:23.000000000 +0530
***************
*** 0 ****
--- 1,123 ----
+ #!/bin/sh
+ 
+ AGENTPROPFILE_PROP=agent.propFile
+ AGENT_PROPS=../../conf/agent.properties
+ AGENTLOGDIR_PROP=agent.logDir
+ AGENTLOGDIR=../../log
+ AGENTDATADIR_PROP=agent.dataDir
+ AGENTDATADIR=../../data
+ AGENT_LIB=./lib
+ PDK_LIB=./pdk/lib
+ WRAPPER_LIB=../../wrapper/lib
+ # for /proc/net/tcp mirror
+ SIGAR_PROC_NET=./tmp
+ 
+ # ------------- 
+ # Shouldn't need to change anything below this
+ # -------------
+ 
+ FINDNAME=$0 
+ while [ -h $FINDNAME ] ; do FINDNAME=`ls -ld $FINDNAME | awk '{print $NF}'` ; done 
+ RUNDIR=`echo $FINDNAME | sed -e 's@/[^/]*$@@'` 
+ unset FINDNAME
+ if test -d $RUNDIR; then
+   cd $RUNDIR/..
+ else
+   cd ..
+ fi
+ 
+ if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
+     HQ_JAVA_HOME=${HQ_JAVA_HOME}
+ elif [ -d jre ]; then
+     HQ_JAVA_HOME=jre
+     # Just in case
+     chmod -R +x jre/bin/* > /dev/null 2>&1
+ elif [ "x$JAVA_HOME" != "x" ] ; then
+     HQ_JAVA_HOME=${JAVA_HOME}
+ else
+     case "`uname`" in
+     Darwin)
+         HQ_JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
+         ;;
+     *)
+         echo "HQ_JAVA_HOME or JAVA_HOME must be set when invoking the agent"
+         exit 1
+         ;;
+     esac
+ fi
+ 
+ chmod +x ./pdk/scripts/* > /dev/null 2>&1
+ 
+ HQ_JAVA="${HQ_JAVA_HOME}/bin/java"
+ 
+ CLIENT_CLASSPATH=
+ for i in `ls ${AGENT_LIB}/*.jar`
+ do
+   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
+ done
+ 
+ for i in `ls ${PDK_LIB}/*.jar`
+ do
+   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
+ done
+ 
+ for i in `ls ${WRAPPER_LIB}/*.jar`
+ do
+   CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${i}"
+ done
+ 
+ CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
+ 
+ HQ_JAVA_OPTS="${HQ_JAVA_OPTS} \
+     -Xmx128m
+     -Dsun.net.inetaddr.ttl=60
+     -Djava.net.preferIPv4Stack=true \
+     -Djava.security.auth.login.config=jaas.config
+     -Dagent.install.home=../.. \
+     -Dagent.bundle.home=. \
+     -Djava.library.path=${WRAPPER_LIB}
+     -D${AGENTPROPFILE_PROP}=${AGENT_PROPS} \
+     -D${AGENTLOGDIR_PROP}=${AGENTLOGDIR} \
+     -D${AGENTDATADIR_PROP}=${AGENTDATADIR}"
+ 
+ CLIENT_CMD="${HQ_JAVA} \
+     ${HQ_JAVA_OPTS}
+     -cp ${CLIENT_CLASSPATH} ${CLIENT_CLASS}"
+ 
+ START_CMD="${CLIENT_CMD} start"
+ STATUS_CMD="${CLIENT_CMD} status"
+ PING_CMD="${CLIENT_CMD} ping"
+ SETUP_CMD="${CLIENT_CMD} setup"
+ DIE_CMD="${CLIENT_CMD} die"
+ 
+ if [ "$1" = "start" ] ; then
+     echo "Starting agent"
+     if ${START_CMD} ; then
+         exit 0        
+     else
+         exit 1
+     fi
+ elif [ "$1" = "run" ] ; then
+     echo "Running agent"
+     echo ${START_CMD} 
+     ${START_CMD} 
+ elif [ "$1" = "stop" ] ; then
+     ${DIE_CMD} 10 || exit 1
+ elif [ "$1" = "status" ] ; then
+     ${STATUS_CMD} || exit 1
+ elif [ "$1" = "ping" ] ; then
+     echo Pinging ...
+     VAL=`$PING_CMD 2>&1`
+     if [ "$?" = "0" ] ; then
+         echo 'Success!'
+     else
+         echo 'Failure!'
+         echo $VAL
+         exit 1
+     fi
+ elif [ "$1" = "setup" ] ; then
+     ${SETUP_CMD}
+ else
+     echo "Syntax: $0 "'<start | stop | ping | setup>'
+     exit 1
+ fi
diff -rcN hq/bin/pphq-agent-wrapper.bat ../hq/bin/pphq-agent-wrapper.bat
*** hq/bin/pphq-agent-wrapper.bat	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent-wrapper.bat	2009-06-12 01:02:37.000000000 +0530
***************
*** 0 ****
--- 1,161 ----
+ @echo off
+ setlocal
+ 
+ rem Copyright (c) 1999, 2006 Tanuki Software Inc.
+ rem
+ rem Java Service Wrapper command based script
+ rem
+ 
+ if "%OS%"=="Windows_NT" goto nt
+ echo This script only works with NT-based versions of Windows.
+ goto :eof
+ 
+ :nt
+ rem
+ rem Find the application home.
+ rem
+ rem %~dp0 is location of current script under NT
+ set _REALPATH=%~dp0..\..\..\wrapper\sbin
+ 
+ set AGENT_INSTALL_HOME=%~dp0..\..\..
+ set AGENT_BUNDLE_HOME=%~dp0..
+ 
+ rem
+ rem Detect HQ_JAVA_HOME
+ rem
+ cd %_REALPATH%
+ 
+ if not "%HQ_JAVA_HOME%"=="" goto gothqjava
+ 
+ if EXIST "%AGENT_INSTALL_HOME%\jre" (
+     set HQ_JAVA_HOME=%AGENT_INSTALL_HOME%\jre
+     goto gotjava
+ )
+ 
+ :nojava
+   echo HQ_JAVA_HOME must be set when invoking the agent
+ goto :eof
+ 
+ :gothqjava
+ if not EXIST "%HQ_JAVA_HOME%" (
+   echo HQ_JAVA_HOME must be set to a valid directory
+   goto :eof
+ ) else (
+   set HQ_JAVA_HOME=%HQ_JAVA_HOME%
+ )
+ 
+ :gotjava
+ rem Decide on the wrapper binary.
+ set _WRAPPER_BASE=wrapper
+ set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%-windows-x86-32.exe
+ if exist "%_WRAPPER_EXE%" goto validate
+ set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%-windows-x86-64.exe
+ if exist "%_WRAPPER_EXE%" goto validate
+ set _WRAPPER_EXE=%_REALPATH%\%_WRAPPER_BASE%.exe
+ if exist "%_WRAPPER_EXE%" goto validate
+ echo Unable to locate a Wrapper executable using any of the following names:
+ echo %_REALPATH%\%_WRAPPER_BASE%-windows-x86-32.exe
+ echo %_REALPATH%\%_WRAPPER_BASE%-windows-x86-64.exe
+ echo %_REALPATH%\%_WRAPPER_BASE%.exe
+ pause
+ goto :eof
+ 
+ :validate
+ rem Find the requested command.
+ for /F %%v in ('echo %1^|findstr "^start$ ^stop$ ^restart$ ^install$ ^remove$ ^query$ ^ping$ ^setup"') do call :exec set COMMAND=%%v
+ 
+ if "%COMMAND%" == "" (
+     echo Usage: %0 { start : stop : restart : install : remove : query : ping : setup }
+     pause
+     goto :eof
+ ) else (
+     shift
+ )
+ 
+ rem
+ rem Find the wrapper.conf
+ rem
+ :conf
+ set _WRAPPER_CONF="%AGENT_INSTALL_HOME%\conf\wrapper.conf"
+ 
+ rem
+ rem Set some HQ properties
+ rem
+ set AGENT_BUNDLE_HOME_PROP=agent.bundle.home
+ set AGENT_INSTALL_HOME_PROP=agent.install.home
+ set AGENT_LIB=%AGENT_BUNDLE_HOME%\lib
+ set PDK_LIB=%AGENT_BUNDLE_HOME%\pdk\lib
+ 
+ set CLIENT_CLASSPATH=%AGENT_LIB%\AgentClient.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\ant.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-logging.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\log4j-1.2.14.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hyperic-util.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\sigar.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\hq-product.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-httpclient-3.1.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%PDK_LIB%\commons-codec-1.3.jar
+ set CLIENT_CLASSPATH=%CLIENT_CLASSPATH%;%AGENT_LIB%\lather.jar
+ 
+ set CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
+ 
+ set CLIENT_CMD="%HQ_JAVA_HOME%\bin\java" -Djava.net.preferIPv4Stack=true -D%AGENT_INSTALL_HOME_PROP%="%AGENT_INSTALL_HOME%" -D%AGENT_BUNDLE_HOME_PROP%="%AGENT_BUNDLE_HOME%" -cp "%CLIENT_CLASSPATH%" %CLIENT_CLASS%
+ 
+ set PING_CMD=%CLIENT_CMD% ping
+ set SETUP_CMD=%CLIENT_CMD% setup
+ set SETUP_IF_NO_PROVIDER_CMD=%CLIENT_CMD% setup-if-no-provider
+ 
+ rem
+ rem Run the application.
+ rem At runtime, the current directory will be that of wrapper.exe
+ rem
+ call :%COMMAND%
+ if errorlevel 1 pause
+ goto :eof
+ 
+ :start
+ "%_WRAPPER_EXE%" -t %_WRAPPER_CONF%
+ call :setup-if-no-provider
+ goto :eof
+ 
+ :stop
+ "%_WRAPPER_EXE%" -p %_WRAPPER_CONF%
+ goto :eof
+ 
+ :install
+ "%_WRAPPER_EXE%" -i %_WRAPPER_CONF%
+ goto :eof
+ 
+ :remove
+ "%_WRAPPER_EXE%" -r %_WRAPPER_CONF%
+ goto :eof
+ 
+ :query
+ "%_WRAPPER_EXE%" -q %_WRAPPER_CONF%
+ goto :eof
+ 
+ :restart
+ call :stop
+ call :start
+ goto :eof
+ 
+ :exec
+ %*
+ goto :eof
+ 
+ rem
+ rem HQ Agent specific commands
+ rem
+ 
+ :ping
+ %PING_CMD%
+ IF %ERRORLEVEL% NEQ 0 (echo Ping failed!) else echo Ping success!
+ goto :eof
+ 
+ :setup
+ %SETUP_CMD%
+ goto :eof
+ 
+ :setup-if-no-provider
+ %SETUP_IF_NO_PROVIDER_CMD%
+ goto :eof
diff -rcN hq/bin/pphq-agent-wrapper.sh ../hq/bin/pphq-agent-wrapper.sh
*** hq/bin/pphq-agent-wrapper.sh	1970-01-01 05:30:00.000000000 +0530
--- ../hq/bin/pphq-agent-wrapper.sh	2009-06-04 13:08:09.000000000 +0530
***************
*** 0 ****
--- 1,816 ----
+ #! /bin/sh
+ 
+ #
+ # Copyright (c) 1999, 2006 Tanuki Software Inc.
+ #
+ # Java Service Wrapper sh script.  Suitable for starting and stopping
+ #  wrapped Java applications on UNIX platforms.
+ #
+ 
+ #-----------------------------------------------------------------------------
+ # These settings can be modified to fit the needs of your application
+ 
+ # Application
+ APP_NAME="hq-agent"
+ APP_LONG_NAME="HQ Agent"
+ 
+ # Wrapper
+ WRAPPER_CMD="../../wrapper/sbin/wrapper"
+ WRAPPER_CMD_PS="sbin/wrapper"
+ WRAPPER_CONF="../../conf/wrapper.conf"
+ 
+ # Priority at which to run the wrapper.  See "man nice" for valid priorities.
+ #  nice is only used if a priority is specified.
+ PRIORITY=
+ 
+ # Location of the pid file.
+ PIDDIR="../../wrapper"
+ 
+ # If uncommented, causes the Wrapper to be shutdown using an anchor file.
+ #  When launched with the 'start' command, it will also ignore all INT and
+ #  TERM signals.
+ #IGNORE_SIGNALS=true
+ 
+ # Wrapper will start the JVM asynchronously. Your application may have some
+ #  initialization tasks and it may be desirable to wait a few seconds
+ #  before returning.  For example, to delay the invocation of following
+ #  startup scripts.  Setting WAIT_AFTER_STARTUP to a positive number will
+ #  cause the start command to delay for the indicated period of time 
+ #  (in seconds).
+ # 
+ WAIT_AFTER_STARTUP=0
+ 
+ # If set, the status, start_msg and stop_msg commands will print out detailed
+ #   state information on the Wrapper and Java processes.
+ #DETAIL_STATUS=true
+ 
+ # If specified, the Wrapper will be run as the specified user.
+ # IMPORTANT - Make sure that the user has the required privileges to write
+ #  the PID file and wrapper.log files.  Failure to be able to write the log
+ #  file will cause the Wrapper to exit without any way to write out an error
+ #  message.
+ # NOTE - This will set the user which is used to run the Wrapper as well as
+ #  the JVM and is not useful in situations where a privileged resource or
+ #  port needs to be allocated prior to the user being changed.
+ #RUN_AS_USER=
+ 
+ # The following two lines are used by the chkconfig command. Change as is
+ #  appropriate for your application.  They should remain commented.
+ # chkconfig: 2345 20 80
+ # description: @app.long.name@
+  
+ # Initialization block for the install_initd and remove_initd scripts used by
+ #  SUSE linux distributions.
+ ### BEGIN INIT INFO
+ # Provides: @app.name@
+ # Required-Start: $local_fs $network $syslog
+ # Should-Start: 
+ # Required-Stop:
+ # Default-Start: 2 3 4 5
+ # Default-Stop: 0 1 6
+ # Short-Description: @app.long.name@
+ # Description: @app.description@
+ ### END INIT INFO
+ 
+ # Do not modify anything beyond this point
+ #-----------------------------------------------------------------------------
+ 
+ # Get the fully qualified path to the script
+ case $0 in
+     /*)
+         SCRIPT="$0"
+         ;;
+     *)
+         PWD=`pwd`
+         SCRIPT="$PWD/$0"
+         ;;
+ esac
+ 
+ # Resolve the true real path without any sym links.
+ CHANGED=true
+ while [ "X$CHANGED" != "X" ]
+ do
+     # Change spaces to ":" so the tokens can be parsed.
+     SAFESCRIPT=`echo $SCRIPT | sed -e 's; ;:;g'`
+     # Get the real path to this script, resolving any symbolic links
+     TOKENS=`echo $SAFESCRIPT | sed -e 's;/; ;g'`
+     REALPATH=
+     for C in $TOKENS; do
+         # Change any ":" in the token back to a space.
+         C=`echo $C | sed -e 's;:; ;g'`
+         REALPATH="$REALPATH/$C"
+         # If REALPATH is a sym link, resolve it.  Loop for nested links.
+         while [ -h "$REALPATH" ] ; do
+             LS="`ls -ld "$REALPATH"`"
+             LINK="`expr "$LS" : '.*-> \(.*\)$'`"
+             if expr "$LINK" : '/.*' > /dev/null; then
+                 # LINK is absolute.
+                 REALPATH="$LINK"
+             else
+                 # LINK is relative.
+                 REALPATH="`dirname "$REALPATH"`""/$LINK"
+             fi
+         done
+     done
+ 
+     if [ "$REALPATH" = "$SCRIPT" ]
+     then
+         CHANGED=""
+     else
+         SCRIPT="$REALPATH"
+     fi
+ done
+ 
+ # resolve the current HQ Agent bundle home
+ cd "`dirname "$REALPATH"`/.."
+ 
+ AGENT_BUNDLE_HOME=`pwd`
+ cd ../..
+ AGENT_INSTALL_HOME=`pwd`
+ # invoke the Java Service Wrapper from the wrapper sbin
+ # directory for compatibility with Windows
+ cd wrapper/sbin
+ REALDIR=`pwd`
+ 
+ # ------------- 
+ # Begin HQ Agent specific logic
+ # ------------- 
+ AGENT_BUNDLE_HOME_PROP=agent.bundle.home
+ AGENT_INSTALL_HOME_PROP=agent.install.home
+ AGENT_LIB=$AGENT_BUNDLE_HOME/lib
+ PDK_LIB=$AGENT_BUNDLE_HOME/pdk/lib
+ # for /proc/net/tcp mirror
+ SIGAR_PROC_NET=$AGENT_BUNDLE_HOME/tmp
+ 
+ if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
+     HQ_JAVA_HOME=${HQ_JAVA_HOME}
+ elif [ -d "${AGENT_INSTALL_HOME}/jre" ]; then
+     HQ_JAVA_HOME="${AGENT_INSTALL_HOME}"/jre
+     # Just in case
+     chmod -R +x "${AGENT_INSTALL_HOME}"/jre/bin/* > /dev/null 2>&1
+ elif [ "x$JAVA_HOME" != "x" ] ; then
+     HQ_JAVA_HOME=${JAVA_HOME}
+ else
+     case "`uname`" in
+     Darwin)
+         HQ_JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
+         ;;
+     *)
+         echo "HQ_JAVA_HOME or JAVA_HOME must be set when invoking the agent"
+         exit 1
+         ;;
+     esac
+ fi
+ 
+ # export environment variables to be picked up by the Java Service Wrapper process
+ export HQ_JAVA_HOME
+ export SIGAR_PROC_NET
+ 
+ chmod +x "${AGENT_BUNDLE_HOME}"/pdk/scripts/* > /dev/null 2>&1
+ 
+ HQ_JAVA="${HQ_JAVA_HOME}/bin/java"
+ # verify that the java command actually exists
+ if [ ! -f "$HQ_JAVA" ]
+ then
+         echo Invalid Java Home detected at ${HQ_JAVA_HOME}
+         exit 1
+ fi
+ 
+ CLIENT_CLASSPATH="${AGENT_LIB}/AgentClient.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/ant.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-logging.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/log4j-1.2.14.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/hyperic-util.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/sigar.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/hq-product.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-httpclient-3.1.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${PDK_LIB}/commons-codec-1.3.jar"
+ CLIENT_CLASSPATH="${CLIENT_CLASSPATH}:${AGENT_LIB}/lather.jar"
+ 
+ CLIENT_CLASS=org.hyperic.hq.bizapp.agent.client.AgentClient
+ 
+ CLIENT_CMD="${HQ_JAVA} \
+     -Djava.net.preferIPv4Stack=true \
+     -D${AGENT_INSTALL_HOME_PROP}=${AGENT_INSTALL_HOME} \
+     -D${AGENT_BUNDLE_HOME_PROP}=${AGENT_BUNDLE_HOME} \
+     -cp ${CLIENT_CLASSPATH} ${CLIENT_CLASS}"
+ 
+ PING_CMD="${CLIENT_CMD} ping"
+ SETUP_CMD="${CLIENT_CMD} setup"
+ STATUS_CMD="${CLIENT_CMD} status"
+ SETUP_IF_NO_PROVIDER_CMD="${CLIENT_CMD} setup-if-no-provider"
+ # ------------- 
+ # End HQ specific logic
+ # ------------- 
+ 
+ # If the PIDDIR is relative, set its value relative to the full REALPATH to avoid problems if
+ #  the working directory is later changed.
+ FIRST_CHAR=`echo $PIDDIR | cut -c1,1`
+ if [ "$FIRST_CHAR" != "/" ]
+ then
+     PIDDIR=$REALDIR/$PIDDIR
+ fi
+ # Same test for WRAPPER_CMD
+ FIRST_CHAR=`echo $WRAPPER_CMD | cut -c1,1`
+ if [ "$FIRST_CHAR" != "/" ]
+ then
+     WRAPPER_CMD=$REALDIR/$WRAPPER_CMD
+ fi
+ # Same test for WRAPPER_CONF
+ FIRST_CHAR=`echo $WRAPPER_CONF | cut -c1,1`
+ if [ "$FIRST_CHAR" != "/" ]
+ then
+     WRAPPER_CONF=$REALDIR/$WRAPPER_CONF
+ fi
+ 
+ # Process ID
+ ANCHORFILE="$PIDDIR/$APP_NAME.anchor"
+ STATUSFILE="$PIDDIR/$APP_NAME.status"
+ JAVASTATUSFILE="$PIDDIR/$APP_NAME.java.status"
+ PIDFILE="$PIDDIR/$APP_NAME.pid"
+ LOCKDIR="/var/lock/subsys"
+ LOCKFILE="$LOCKDIR/$APP_NAME"
+ pid=""
+ 
+ # Resolve the location of the 'ps' command
+ PSEXE="/usr/bin/ps"
+ if [ ! -x "$PSEXE" ]
+ then
+     PSEXE="/bin/ps"
+     if [ ! -x "$PSEXE" ]
+     then
+         echo "Unable to locate 'ps'."
+         echo "Please report this message along with the location of the command on your system."
+         exit 1
+     fi
+ fi
+ 
+ # Resolve the os
+ DIST_OS=`uname -s | tr [:upper:] [:lower:] | tr -d [:blank:]`
+ DIST_BITS="32"
+ case "$DIST_OS" in
+     'sunos')
+         DIST_OS="solaris"
+         ;;
+     'hp-ux')
+         # HP-UX needs the XPG4 version of ps (for -o args)
+         DIST_OS="hpux"
+         UNIX95=""
+         export UNIX95
+         ;;
+     'hp-ux64')
+         # HP-UX needs the XPG4 version of ps (for -o args)
+         DIST_OS="hpux"
+         UNIX95=""
+         export UNIX95
+         DIST_BITS="64"
+         ;;
+     'darwin')
+         DIST_OS="macosx"
+         ;;
+     'unix_sv')
+         DIST_OS="unixware"
+         ;;
+ esac
+ 
+ # Resolve the architecture
+ if [ "$DIST_OS" = "macosx" ]
+ then
+     DIST_ARCH="universal"
+ else
+     DIST_ARCH=
+     DIST_ARCH=`uname -p 2>/dev/null | tr [:upper:] [:lower:] | tr -d [:blank:]`
+     if [ "X$DIST_ARCH" = "X" ]
+     then
+         DIST_ARCH="unknown"
+     fi
+     if [ "$DIST_ARCH" = "unknown" ]
+     then
+         DIST_ARCH=`uname -m 2>/dev/null | tr [:upper:] [:lower:] | tr -d [:blank:]`
+     fi
+ 
+     case "$DIST_ARCH" in
+         'athlon' | 'i386' | 'i486' | 'i586' | 'i686')
+             DIST_ARCH="x86"
+             ;;
+         'amd64' | 'x86_64')
+             DIST_ARCH="x86"
+             DIST_BITS="64"
+             ;;            
+         'ia32')
+             DIST_ARCH="ia"
+             ;;
+         'ia64' | 'ia64n' | 'ia64w')
+             DIST_ARCH="ia"
+             DIST_BITS="64"
+             ;;            
+         'ip27')
+             DIST_ARCH="mips"
+             ;;
+         'power' | 'powerpc' | 'power_pc' | 'ppc64')
+             DIST_ARCH="ppc"
+             ;;
+         'pa_risc' | 'pa-risc')
+             DIST_ARCH="parisc"
+             ;;
+         'sun4u' | 'sparcv9')
+             DIST_ARCH="sparc"
+             ;;
+         '9000/800')
+             DIST_ARCH="parisc"
+             ;;
+     esac
+ fi
+ 
+ outputFile() {
+     if [ -f "$1" ]
+     then
+         echo "  $1 (Found but not executable.)";
+     else
+         echo "  $1"
+     fi
+ }
+ 
+ # Decide on the wrapper binary to use.
+ # First, try out the detected bit version
+ # If not available, try 32 bits followed by 64 bits.
+ if [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-$DIST_BITS" ]
+ then
+   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-$DIST_BITS"
+ elif [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32" ]
+ then
+   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32"
+ elif [ -x "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64" ]
+ then
+   WRAPPER_CMD="$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64"
+ else
+   if [ ! -x "$WRAPPER_CMD" ]
+     then
+       echo "Unable to locate any of the following binaries:"
+       outputFile "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-32"
+       outputFile "$WRAPPER_CMD-$DIST_OS-$DIST_ARCH-64"
+       outputFile "$WRAPPER_CMD"
+       exit 1
+   fi
+ fi
+ 
+ # Build the nice clause
+ if [ "X$PRIORITY" = "X" ]
+ then
+     CMDNICE=""
+ else
+     CMDNICE="nice -$PRIORITY"
+ fi
+ 
+ # Build the anchor file clause.
+ if [ "X$IGNORE_SIGNALS" = "X" ]
+ then
+    ANCHORPROP=
+    IGNOREPROP=
+ else
+    ANCHORPROP=wrapper.anchorfile=\"$ANCHORFILE\"
+    IGNOREPROP=wrapper.ignore_signals=TRUE
+ fi
+ 
+ # Build the status file clause.
+ if [ "X$DETAIL_STATUS" = "X" ]
+ then
+    STATUSPROP=
+ else
+    STATUSPROP="wrapper.statusfile=\"$STATUSFILE\" wrapper.java.statusfile=\"$JAVASTATUSFILE\""
+ fi
+ 
+ # Build the lock file clause.  Only create a lock file if the lock directory exists on this platform.
+ LOCKPROP=
+ if [ -d $LOCKDIR ]
+ then
+     if [ -w $LOCKDIR ]
+     then
+         LOCKPROP=wrapper.lockfile=\"$LOCKFILE\"
+     fi
+ fi
+ 
+ checkUser() {
+     # $1 touchLock flag
+     # $2 command
+ 
+     # Check the configured user.  If necessary rerun this script as the desired user.
+     if [ "X$RUN_AS_USER" != "X" ]
+     then
+         # Resolve the location of the 'id' command
+         IDEXE="/usr/xpg4/bin/id"
+         if [ ! -x "$IDEXE" ]
+         then
+             IDEXE="/usr/bin/id"
+             if [ ! -x "$IDEXE" ]
+             then
+                 echo "Unable to locate 'id'."
+                 echo "Please report this message along with the location of the command on your system."
+                 exit 1
+             fi
+         fi
+     
+         if [ "`$IDEXE -u -n`" = "$RUN_AS_USER" ]
+         then
+             # Already running as the configured user.  Avoid password prompts by not calling su.
+             RUN_AS_USER=""
+         fi
+     fi
+     if [ "X$RUN_AS_USER" != "X" ]
+     then
+         # If LOCKPROP and $RUN_AS_USER are defined then the new user will most likely not be
+         # able to create the lock file.  The Wrapper will be able to update this file once it
+         # is created but will not be able to delete it on shutdown.  If $2 is defined then
+         # the lock file should be created for the current command
+         if [ "X$LOCKPROP" != "X" ]
+         then
+             if [ "X$1" != "X" ]
+             then
+                 # Resolve the primary group 
+                 RUN_AS_GROUP=`groups $RUN_AS_USER | awk '{print $3}' | tail -1`
+                 if [ "X$RUN_AS_GROUP" = "X" ]
+                 then
+                     RUN_AS_GROUP=$RUN_AS_USER
+                 fi
+                 touch $LOCKFILE
+                 chown $RUN_AS_USER:$RUN_AS_GROUP $LOCKFILE
+             fi
+         fi
+ 
+         # Still want to change users, recurse.  This means that the user will only be
+         #  prompted for a password once. Variables shifted by 1
+         # 
+         # Use "runuser" if this exists.  runuser should be used on RedHat in preference to su.
+         #
+         if test -f "/sbin/runuser"
+         then
+             /sbin/runuser - $RUN_AS_USER -c "\"$REALPATH\" $2"
+         else
+             su - $RUN_AS_USER -c "\"$REALPATH\" $2"
+         fi
+ 
+         # Now that we are the original user again, we may need to clean up the lock file.
+         if [ "X$LOCKPROP" != "X" ]
+         then
+             getpid
+             if [ "X$pid" = "X" ]
+             then
+                 # Wrapper is not running so make sure the lock file is deleted.
+                 if [ -f "$LOCKFILE" ]
+                 then
+                     rm "$LOCKFILE"
+                 fi
+             fi
+         fi
+ 
+         exit 0
+     fi
+ }
+ 
+ getpid() {
+     pid=""
+     if [ -f "$PIDFILE" ]
+     then
+         if [ -r "$PIDFILE" ]
+         then
+             pid=`cat "$PIDFILE"`
+             if [ "X$pid" != "X" ]
+             then
+                 # It is possible that 'a' process with the pid exists but that it is not the
+                 #  correct process.  This can happen in a number of cases, but the most
+                 #  common is during system startup after an unclean shutdown.
+                 # The ps statement below looks for the specific wrapper command running as
+                 #  the pid.  If it is not found then the pid file is considered to be stale.
+                 case "$DIST_OS" in
+                     'macosx')
+                         pidtest=`$PSEXE -ww -p $pid -o command | grep "$WRAPPER_CMD_PS" | tail -1`
+                         ;;
+                     'solaris')
+                         PSEXE="/usr/ucb/ps" 
+                         pidtest=`$PSEXE ww $pid | grep "$WRAPPER_CMD" | tail -1` 
+                         ;;
+                     'hpux')
+                         pidtest=`$PSEXE -p $pid -x -o args | grep "$WRAPPER_CMD_PS" | tail -1`
+                         ;;
+                     *)
+                         pidtest=`$PSEXE -p $pid -o args | grep "$WRAPPER_CMD_PS" | tail -1`
+                         ;;
+                 esac
+ 
+                 if [ "X$pidtest" = "X" ]
+                 then
+                     # This is a stale pid file.
+                     rm -f "$PIDFILE"
+                     echo "Removed stale pid file: $PIDFILE"
+                     pid=""
+                 fi
+             fi
+         else
+             echo "Cannot read $PIDFILE."
+             exit 1
+         fi
+     fi
+ }
+ 
+ getstatus() {
+     STATUS=
+     if [ -f "$STATUSFILE" ]
+     then
+         if [ -r "$STATUSFILE" ]
+         then
+             STATUS=`cat "$STATUSFILE"`
+         fi
+     fi
+     if [ "X$STATUS" = "X" ]
+     then
+         STATUS="Unknown"
+     fi
+     
+     JAVASTATUS=
+     if [ -f "$JAVASTATUSFILE" ]
+     then
+         if [ -r "$JAVASTATUSFILE" ]
+         then
+             JAVASTATUS=`cat "$JAVASTATUSFILE"`
+         fi
+     fi
+     if [ "X$JAVASTATUS" = "X" ]
+     then
+         JAVASTATUS="Unknown"
+     fi
+ }
+ 
+ testpid() {
+     # It is possible that 'a' process with the pid exists but that it is not the
+     # correct process. This can happen in a number of cases, but the most
+     # common is during system startup after an unclean shutdown.
+     # The ps statement below looks for the specific wrapper command running as
+     # the pid. If it is not found then the pid file is considered to be stale.
+     case "$DIST_OS" in
+         'macosx')
+             pid=`$PSEXE -ww $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
+             ;;
+         'solaris')
+             PSEXE="/usr/ucb/ps"
+             pid=`$PSEXE ww $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
+             ;;
+         *)
+             pid=`$PSEXE -p $pid | grep $pid | grep -v grep | awk '{print $1}' | tail -1`
+             ;;
+     esac
+     if [ "X$pid" = "X" ]
+     then
+         # Process is gone so remove the pid file.
+         rm -f "$PIDFILE"
+         pid=""
+     fi
+ } 
+  
+ start() {
+     echo -n "Starting $APP_LONG_NAME..."
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         # The string passed to eval must handles spaces in paths correctly.
+         COMMAND_LINE="$CMDNICE \"$WRAPPER_CMD\" \"$WRAPPER_CONF\" wrapper.syslog.ident=\"$APP_NAME\" wrapper.pidfile=\"$PIDFILE\" wrapper.name=\"$APP_NAME\" wrapper.displayname=\"$APP_LONG_NAME\" wrapper.daemonize=TRUE $ANCHORPROP $IGNOREPROP $STATUSPROP $LOCKPROP"
+         eval $COMMAND_LINE
+     else
+         echo "$APP_LONG_NAME is already running."
+         exit 1
+     fi
+ 
+     # Sleep for a few seconds to allow for intialization if required 
+     #  then test to make sure we're still running.
+     #
+     i=0
+     while [ $i -lt $WAIT_AFTER_STARTUP ]
+     do
+         sleep 1
+         echo -n "."
+         i=`expr $i + 1`
+     done
+     if [ $WAIT_AFTER_STARTUP -gt 0 ]
+     then
+         getpid
+         if [ "X$pid" = "X" ]
+         then
+             echo " WARNING: $APP_LONG_NAME may have failed to start."
+             exit 1
+         else
+             echo " running ($pid)."
+         fi
+     else 
+         echo ""
+     fi
+     
+     ${SETUP_IF_NO_PROVIDER_CMD}
+ }
+  
+ stopit() {
+     echo "Stopping $APP_LONG_NAME..."
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         echo "$APP_LONG_NAME was not running."
+     else
+         if [ "X$IGNORE_SIGNALS" = "X" ]
+         then
+             # Running so try to stop it.
+             kill $pid
+             if [ $? -ne 0 ]
+             then
+                 # An explanation for the failure should have been given
+                 echo "Unable to stop $APP_LONG_NAME."
+                 exit 1
+             fi
+         else
+             rm -f "$ANCHORFILE"
+             if [ -f "$ANCHORFILE" ]
+             then
+                 # An explanation for the failure should have been given
+                 echo "Unable to stop $APP_LONG_NAME."
+                 exit 1
+             fi
+         fi
+ 
+         # We can not predict how long it will take for the wrapper to
+         #  actually stop as it depends on settings in wrapper.conf.
+         #  Loop until it does.
+         savepid=$pid
+         CNT=0
+         TOTCNT=0
+         while [ "X$pid" != "X" ]
+         do
+             # Show a waiting message every 5 seconds.
+             if [ "$CNT" -lt "5" ]
+             then
+                 CNT=`expr $CNT + 1`
+             else
+                 echo "Waiting for $APP_LONG_NAME to exit..."
+                 CNT=0
+             fi
+             TOTCNT=`expr $TOTCNT + 1`
+ 
+             sleep 1
+ 
+             testpid
+         done
+ 
+         pid=$savepid
+         testpid
+         if [ "X$pid" != "X" ]
+         then
+             echo "Failed to stop $APP_LONG_NAME."
+             exit 1
+         else
+             echo "Stopped $APP_LONG_NAME."
+         fi
+     fi
+ }
+ 
+ status() {
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         echo "$APP_LONG_NAME is not running."
+         exit 1
+     else
+         if [ "X$DETAIL_STATUS" = "X" ]
+         then
+             echo "$APP_LONG_NAME is running (PID:$pid)."
+             ${STATUS_CMD}
+         else
+             getstatus
+             echo "$APP_LONG_NAME is running (PID:$pid, Wrapper:$STATUS, Java:$JAVASTATUS)"
+             ${STATUS_CMD}
+         fi
+         exit 0
+     fi
+ }
+ 
+ dump() {
+     echo "Dumping $APP_LONG_NAME..."
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         echo "$APP_LONG_NAME was not running."
+     else
+         kill -3 $pid
+ 
+         if [ $? -ne 0 ]
+         then
+             echo "Failed to dump $APP_LONG_NAME."
+             exit 1
+         else
+             echo "Dumped $APP_LONG_NAME."
+         fi
+     fi
+ }
+ 
+ # Used by HP-UX init scripts.
+ startmsg() {
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         echo "Starting $APP_LONG_NAME... (Wrapper:Stopped)"
+     else
+         if [ "X$DETAIL_STATUS" = "X" ]
+         then
+             echo "Starting $APP_LONG_NAME... (Wrapper:Running)"
+         else
+             getstatus
+             echo "Starting $APP_LONG_NAME... (Wrapper:$STATUS, Java:$JAVASTATUS)"
+         fi
+     fi
+ }
+ 
+ # Used by HP-UX init scripts.
+ stopmsg() {
+     getpid
+     if [ "X$pid" = "X" ]
+     then
+         echo "Stopping $APP_LONG_NAME... (Wrapper:Stopped)"
+     else
+         if [ "X$DETAIL_STATUS" = "X" ]
+         then
+             echo "Stopping $APP_LONG_NAME... (Wrapper:Running)"
+         else
+             getstatus
+             echo "Stopping $APP_LONG_NAME... (Wrapper:$STATUS, Java:$JAVASTATUS)"
+         fi
+     fi
+ }
+ 
+ 
+ ping() {
+     echo Pinging ...
+     VAL=`$PING_CMD 2>&1`
+     if [ "$?" = "0" ] ; then
+         echo 'Success!'
+     else
+         echo 'Failure!'
+         echo $VAL
+         exit 1
+     fi
+ }
+ 
+ # Used by HP-UX init scripts.
+ setup() {
+     ${SETUP_CMD}
+ }
+ 
+ case "$1" in
+ 
+     'start')
+         checkUser touchlock $1
+         start
+         ;;
+ 
+     'stop')
+         checkUser "" $1
+         stopit
+         ;;
+ 
+     'restart')
+         checkUser touchlock $1
+         stopit
+         start
+         ;;
+ 
+     'status')
+         checkUser "" $1
+         status
+         ;;
+ 
+     'dump')
+         checkUser "" $1
+         dump
+         ;;
+ 
+     'start_msg')
+         checkUser "" $1
+         startmsg
+         ;;
+ 
+     'stop_msg')
+         checkUser "" $1
+         stopmsg
+         ;;
+         
+     'ping')
+         checkUser "" $1
+         ping
+         ;;
+         
+     'setup')
+         checkUser "" $1
+         setup
+         ;;        
+ 
+     *)
+         echo "Usage: $0 { start | stop | restart | status | dump | ping | setup }"
+         exit 1
+         ;;
+ esac
+ 
+ exit 0
diff -rcN hq/build_util/jboss-build.xml ../hq/build_util/jboss-build.xml
*** hq/build_util/jboss-build.xml	2009-04-21 13:07:21.000000000 +0530
--- ../hq/build_util/jboss-build.xml	2010-02-02 15:23:38.292027327 +0530
***************
*** 116,122 ****
      <delete file="${jboss-deploy-dir}/jms/jbossmq-destinations-service.xml"/>
  
      <!-- Copy our standardjboss file, overwrite the existing one
!          all Hyperic specific items in this file are labled Hyperic HQ
           and should have an explanation for what/why the change is made 
           from the shipping default -->
  
--- 116,122 ----
      <delete file="${jboss-deploy-dir}/jms/jbossmq-destinations-service.xml"/>
  
      <!-- Copy our standardjboss file, overwrite the existing one
!          all Postgres Plus HQ specific items in this file are labled Postgres Plus HQ
           and should have an explanation for what/why the change is made 
           from the shipping default -->
  
***************
*** 277,283 ****
              keystore="${jboss.home}/server/default/conf/hyperic.keystore"
              keyalg="rsa"
              storepass="hyperic" 
!             dname="CN=Hyperic HQ, OU=HQ, O=hyperic.net, C=US"/>
    </target>
  
  </project>
--- 277,283 ----
              keystore="${jboss.home}/server/default/conf/hyperic.keystore"
              keyalg="rsa"
              storepass="hyperic" 
!             dname="CN=Postgres Plus HQ, OU=HQ, O=hyperic.net, C=US"/>
    </target>
  
  </project>
diff -rcN hq/build.xml ../hq/build.xml
*** hq/build.xml	2009-10-28 05:17:19.000000000 +0530
--- ../hq/build.xml	2010-02-03 10:42:25.688538305 +0530
***************
*** 856,862 ****
    <target name="pdk-javadoc">
      <property name="pdk.javadoc" location="${pdk.dir}/javadoc"/>
      <property name="pdk.version" value="${version}"/>
!     <property name="pdk.title" value="Hyperic HQ Plugin API"/>
      <mkdir dir="${pdk.javadoc}" />
      <javadoc
        destdir="${pdk.javadoc}"
--- 856,862 ----
    <target name="pdk-javadoc">
      <property name="pdk.javadoc" location="${pdk.dir}/javadoc"/>
      <property name="pdk.version" value="${version}"/>
!     <property name="pdk.title" value="Postgres Plus HQ Plugin API"/>
      <mkdir dir="${pdk.javadoc}" />
      <javadoc
        destdir="${pdk.javadoc}"
***************
*** 1362,1383 ****
      <copy file="bin/agent.rc"
          tofile="${agent.dir}/bundles/${agent.bundle.dir}/rcfiles/agent.rc"/>
  
!     <!-- DEPRECATED: replaced hq-agent.exe with Java Service Wrapper
!     <copy file="${launcher.dir}/hq-agent.exe"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/hq-agent.exe" />
      -->
!     <copy file="bin/hq-agent-master.sh"
!         tofile="${agent.dir}/bin/hq-agent.sh"/>  
!       <copy file="bin/hq-agent-master.bat"
!           tofile="${agent.dir}/bin/hq-agent.bat"/>  
    	
!     <copy file="bin/hq-agent.sh"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/hq-agent-nowrapper.sh"/>
    	
!     <copy file="bin/hq-agent-wrapper.bat"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/hq-agent.bat" />
!     <copy file="bin/hq-agent-wrapper.sh"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/hq-agent.sh"/> 	
    	
      <copy file="etc/wrapper.conf"
          tofile="${agent.dir}/bundles/${agent.bundle.dir}/conf/wrapper.conf"/> 		
--- 1362,1383 ----
      <copy file="bin/agent.rc"
          tofile="${agent.dir}/bundles/${agent.bundle.dir}/rcfiles/agent.rc"/>
  
!     <!-- DEPRECATED: replaced pphq-agent.exe with Java Service Wrapper
!     <copy file="${launcher.dir}/pphq-agent.exe"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/pphq-agent.exe" />
      -->
!     <copy file="bin/pphq-agent-master.sh"
!         tofile="${agent.dir}/bin/pphq-agent.sh"/>  
!       <copy file="bin/pphq-agent-master.bat"
!           tofile="${agent.dir}/bin/pphq-agent.bat"/>  
    	
!     <copy file="bin/pphq-agent.sh"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/pphq-agent-nowrapper.sh"/>
    	
!     <copy file="bin/pphq-agent-wrapper.bat"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/pphq-agent.bat" />
!     <copy file="bin/pphq-agent-wrapper.sh"
!         tofile="${agent.dir}/bundles/${agent.bundle.dir}/bin/pphq-agent.sh"/> 	
    	
      <copy file="etc/wrapper.conf"
          tofile="${agent.dir}/bundles/${agent.bundle.dir}/conf/wrapper.conf"/> 		
***************
*** 1964,1972 ****
      </replace>
  
      <!-- Copy server startup scripts -->
!     <copy todir="${archive-dir}/server-${version}/bin" file="installer/bin/hq-server.sh"/>
!     <copy todir="${archive-dir}/server-${version}/bin" file="installer/bin/hq-threaddump.sh"/>
!     <copy todir="${archive-dir}/server-${version}/bin" file="${launcher.dir}/hq-server.exe" />
      
      <!-- Copy EAR -->
      <property name="archive-ear-dir"
--- 1964,1972 ----
      </replace>
  
      <!-- Copy server startup scripts -->
!     <copy todir="${archive-dir}/server-${version}/bin" file="installer/bin/pphq-server.sh"/>
!     <copy todir="${archive-dir}/server-${version}/bin" file="installer/bin/pphq-threaddump.sh"/>
!     <copy todir="${archive-dir}/server-${version}/bin" file="${launcher.dir}/pphq-server.exe" />
      
      <!-- Copy EAR -->
      <property name="archive-ear-dir"
***************
*** 2049,2055 ****
        packagenames="org.hyperic.*"
        additionalparam="-breakiterator"
        overview="doc/javadoc-overview.html"
!       windowtitle="Hyperic HQ Management System">
        <sourcepath>
          <pathelement location="src"/>
          <pathelement location="build/src"/>
--- 2049,2055 ----
        packagenames="org.hyperic.*"
        additionalparam="-breakiterator"
        overview="doc/javadoc-overview.html"
!       windowtitle="Postgres Plus HQ Management System">
        <sourcepath>
          <pathelement location="src"/>
          <pathelement location="build/src"/>
***************
*** 2058,2069 ****
          <path refid="alljars" />
          <pathelement location="build/classes"/>
        </classpath>
!       <doctitle><![CDATA[ Hyperic HQ  <br>API Specification ]]></doctitle>
        <header>
!         <![CDATA[<font size="2">Hyperic HQ v. ${hq.api.version}</font>]]>
        </header>
        <bottom>
!         <![CDATA[Copyright &#169; 2004-2006 Hyperic, Inc. <a href="mailto:info@hyperic.net">info@hyperic.net</a>, All Rights Reserved.]]>
        </bottom>
      </javadoc>
    </target>
--- 2058,2069 ----
          <path refid="alljars" />
          <pathelement location="build/classes"/>
        </classpath>
!       <doctitle><![CDATA[ Postgres Plus HQ  <br>API Specification ]]></doctitle>
        <header>
!         <![CDATA[<font size="2">Postgres Plus HQ v. ${hq.api.version}</font>]]>
        </header>
        <bottom>
!         <![CDATA[]]>
        </bottom>
      </javadoc>
    </target>
diff -rcN hq/etc/alertTemplates/html_email.gsp ../hq/etc/alertTemplates/html_email.gsp
*** hq/etc/alertTemplates/html_email.gsp	2009-05-09 13:07:22.000000000 +0530
--- ../hq/etc/alertTemplates/html_email.gsp	2010-02-02 15:18:43.044942301 +0530
***************
*** 36,49 ****
          "http://www.w3.org/TR/html4/loose.dtd">
  <html>
  <head>
! 	<title>Hyperic HQ - Alert Email</title>
  </head>
  <body style="font-family: arial, sans-serif;font-size:13px;">
  <table border="0" width="95%" cellspacing="0" 
         style="margin-left:auto;margin-right:auto;border:1px solid #999999" >
    <tr>
      <td style="background-color:#ff6819;padding-top:5px;padding-bottom:5px;padding-left:10px;color:white;font-size:16px;border-top:4px solid #a5a5a5;border-bottom:4px solid #a5a5a5;">
!       <b>Hyperic HQ - Alert Notification</b>
      </td>
    </tr>
    <tr>
--- 36,49 ----
          "http://www.w3.org/TR/html4/loose.dtd">
  <html>
  <head>
! 	<title>Postgres Plus HQ - Alert Email</title>
  </head>
  <body style="font-family: arial, sans-serif;font-size:13px;">
  <table border="0" width="95%" cellspacing="0" 
         style="margin-left:auto;margin-right:auto;border:1px solid #999999" >
    <tr>
      <td style="background-color:#ff6819;padding-top:5px;padding-bottom:5px;padding-left:10px;color:white;font-size:16px;border-top:4px solid #a5a5a5;border-bottom:4px solid #a5a5a5;">
!       <b>Postgres Plus HQ - Alert Notification</b>
      </td>
    </tr>
    <tr>
***************
*** 108,120 ****
    </tr>
    <tr>
      <td style="padding-left:10px;padding-top:10px;padding-bottom:10px;border-bottom:4px solid #A5D9EE;">
!       This message was delivered to you by Hyperic HQ.
        To view the HQ Dashboard, go to <a href="${HQUtil.baseURL}/Dashboard.do">${HQUtil.baseURL}/Dashboard.do</a>
      </td>
    </tr>
    <tr>
      <td align="center">
!       <img src="http://www.hyperic.com/images/app/bg-footer.gif" alt="Hyperic footer image">
      </td>
    </tr>
    </table>
--- 108,120 ----
    </tr>
    <tr>
      <td style="padding-left:10px;padding-top:10px;padding-bottom:10px;border-bottom:4px solid #A5D9EE;">
!       This message was delivered to you by Postgres Plus HQ.
        To view the HQ Dashboard, go to <a href="${HQUtil.baseURL}/Dashboard.do">${HQUtil.baseURL}/Dashboard.do</a>
      </td>
    </tr>
    <tr>
      <td align="center">
!       <img src="http://www.enterprisedb.com/images/app/bg-footer.gif" alt="Postgres Plus HQ footer image">
      </td>
    </tr>
    </table>
diff -rcN hq/etc/alertTemplates/text_email.gsp ../hq/etc/alertTemplates/text_email.gsp
*** hq/etc/alertTemplates/text_email.gsp	2009-05-09 13:07:22.000000000 +0530
--- ../hq/etc/alertTemplates/text_email.gsp	2010-02-02 15:16:29.560024801 +0530
***************
*** 67,73 ****
  
  ------------------------------------------
  
! This message was delivered to you by Hyperic HQ.
  To view the HQ Dashboard, go to ${HQUtil.baseURL}/Dashboard.do
  
  ------------------------------------------
--- 67,73 ----
  
  ------------------------------------------
  
! This message was delivered to you by Postgres Plus HQ.
  To view the HQ Dashboard, go to ${HQUtil.baseURL}/Dashboard.do
  
  ------------------------------------------
diff -rcN hq/etc/application-test.xml ../hq/etc/application-test.xml
*** hq/etc/application-test.xml	2008-04-16 11:36:45.000000000 +0530
--- ../hq/etc/application-test.xml	2010-02-02 15:20:32.504089062 +0530
***************
*** 1,9 ****
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Hyperic HQ</display-name>
  
!   <!-- Hyperic UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
--- 1,9 ----
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Postgres Plus HQ</display-name>
  
!   <!-- Postgres Plus UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
diff -rcN hq/etc/application.xml ../hq/etc/application.xml
*** hq/etc/application.xml	2008-03-26 01:43:11.000000000 +0530
--- ../hq/etc/application.xml	2010-02-02 15:20:09.608024687 +0530
***************
*** 1,9 ****
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Hyperic HQ</display-name>
  
!   <!-- Hyperic UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
--- 1,9 ----
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Postgres Plus HQ</display-name>
  
!   <!-- Postgres Plus UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
diff -rcN hq/etc/product.properties ../hq/etc/product.properties
*** hq/etc/product.properties	2008-03-26 01:43:11.000000000 +0530
--- ../hq/etc/product.properties	2010-02-02 15:19:21.552047536 +0530
***************
*** 12,16 ****
  hyperic.hq.authz.permissionManager=org.hyperic.hq.authz.shared.PermissionManagerImpl
  
  # Flavour description, used for identifying repackaged HQ
! hq.flavour=Hyperic HQ
  
--- 12,16 ----
  hyperic.hq.authz.permissionManager=org.hyperic.hq.authz.shared.PermissionManagerImpl
  
  # Flavour description, used for identifying repackaged HQ
! hq.flavour=Postgres Plus HQ
  
diff -rcN hq/etc/web-ear-application.xml ../hq/etc/web-ear-application.xml
*** hq/etc/web-ear-application.xml	2008-03-26 01:43:11.000000000 +0530
--- ../hq/etc/web-ear-application.xml	2010-02-02 15:20:52.513026443 +0530
***************
*** 1,9 ****
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Hyperic HQ Web</display-name>
  
!   <!-- Hyperic UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
--- 1,9 ----
  <?xml version="1.0"?>
  
   <application>
!   <display-name>Postgres Plus HQ Web</display-name>
  
!   <!-- Postgres Plus UI -->
    <module>
      <web>
        <web-uri>hq.war</web-uri>
diff -rcN hq/etc/wrapper.conf ../hq/etc/wrapper.conf
*** hq/etc/wrapper.conf	2008-07-31 11:37:43.000000000 +0530
--- ../hq/etc/wrapper.conf	2010-02-02 15:21:20.012584486 +0530
***************
*** 1,5 ****
  #********************************************************************
! # Java Service Wrapper Properties for Hyperic HQ Agent
  #********************************************************************
  
  # default JAVA_HOME in case it is not already set
--- 1,5 ----
  #********************************************************************
! # Java Service Wrapper Properties for Postgres Plus HQ Agent
  #********************************************************************
  
  # default JAVA_HOME in case it is not already set
***************
*** 92,98 ****
  # Wrapper Windows Properties
  #********************************************************************
  # Title to use when running as a console
! wrapper.console.title=Hyperic HQ Agent
  
  #********************************************************************
  # Wrapper Windows NT/2000/XP Service Properties
--- 92,98 ----
  # Wrapper Windows Properties
  #********************************************************************
  # Title to use when running as a console
! wrapper.console.title=Postgres Plus HQ Agent
  
  #********************************************************************
  # Wrapper Windows NT/2000/XP Service Properties
***************
*** 103,115 ****
  #  service can then be reinstalled.
  
  # Name of the service
! wrapper.ntservice.name=Hyperic HQ Agent
  
  # Display name of the service
! wrapper.ntservice.displayname=Hyperic HQ Agent
  
  # Description of the service
! wrapper.ntservice.description=Agent for Hyperic HQ
  
  # Service dependencies.  Add dependencies as needed starting from 1
  wrapper.ntservice.dependency.1=
--- 103,115 ----
  #  service can then be reinstalled.
  
  # Name of the service
! wrapper.ntservice.name=Postgres Plus HQ Agent
  
  # Display name of the service
! wrapper.ntservice.displayname=Postgres Plus HQ Agent
  
  # Description of the service
! wrapper.ntservice.description=Agent for Postgres Plus HQ
  
  # Service dependencies.  Add dependencies as needed starting from 1
  wrapper.ntservice.dependency.1=
Binary files hq/hq_bin/launcher_bin/hq-agent.exe and ../hq/hq_bin/launcher_bin/hq-agent.exe differ
Binary files hq/hq_bin/launcher_bin/hq-server.exe and ../hq/hq_bin/launcher_bin/hq-server.exe differ
Binary files hq/hq_bin/launcher_bin/pphq-agent.exe and ../hq/hq_bin/launcher_bin/pphq-agent.exe differ
Binary files hq/hq_bin/launcher_bin/pphq-server.exe and ../hq/hq_bin/launcher_bin/pphq-server.exe differ
diff -rcN hq/installer/AGENT-README.txt ../hq/installer/AGENT-README.txt
*** hq/installer/AGENT-README.txt	2008-06-11 11:43:59.000000000 +0530
--- ../hq/installer/AGENT-README.txt	2010-02-03 11:21:28.468695845 +0530
***************
*** 1,86 ****
  ================================================================================                   
  
!                  Hyperic HQ Agent, version @@@VERSION@@@
  
  ================================================================================
  
  
! Starting and Stopping the Hyperic HQ Agent on Windows:
  
! On Windows, you have the choice of starting and starting the Hyperic HQ Agent
  from the Windows Service Manager or from a Windows Command Prompt. The Service
! Manager is recommended for starting the Hyperic HQ Agent because services remain
  running even if you logout of the Windows user session that you're logged-in to
  when starting the server.
  
  ----------------------------------------------------------------
! To start the Hyperic HQ Agent from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Hyperic HQ Agent service.
  
  3. Click the start icon or click the start link.
  
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ Agent from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Hyperic HQ Agent service.
  
  3. Click the stopt icon or click the stop link.
  
  
  ----------------------------------------------------------------
! To start the Hyperic HQ Agent from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
! 	 bin\hq-agent.bat start
  
! Note: Logging out of the Windows user session will shutdown the Hyperic HQ
!       Agent. You should start the Hyperic HQ Agent from the Windows Service
!       Manager, if want the Hyperic HQ Agent to run after you logout of your
        Windows user session.
        
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ Agent from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
! 	 bin\hq-agent.bat stop
  
  
  ================================================================================
  
  
! Starting and Stopping the Hyperic HQ Agent on Linux / UNIX:
  
  ----------------------------------------------------------------
! To start the Hyperic HQ Agent, execute this command:
  
!  hq-agent.sh start
  
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ Agent, execute this command:
  
!  hq-agent.sh stop
  
   
  ================================================================================
  
  
! Reading the Hyperic HQ Agent Log Files
  ---------------------------------------
! The Hyperic HQ Agent log files are located in the 'log' sub-directory where the
! Hyperic HQ Agent is installed. The active log file is always named 'agent.log'.
  The log is a text file and can be openned and read with any text editor or the
  Windows Notepad application.
--- 1,86 ----
  ================================================================================                   
  
!                  Postgres Plus HQ Agent, version @@@VERSION@@@
  
  ================================================================================
  
  
! Starting and Stopping the Postgres Plus HQ Agent on Windows:
  
! On Windows, you have the choice of starting and starting the Postgres Plus HQ Agent
  from the Windows Service Manager or from a Windows Command Prompt. The Service
! Manager is recommended for starting the Postgres Plus HQ Agent because services remain
  running even if you logout of the Windows user session that you're logged-in to
  when starting the server.
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ Agent from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Postgres Plus HQ Agent service.
  
  3. Click the start icon or click the start link.
  
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ Agent from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Postgres Plus HQ Agent service.
  
  3. Click the stopt icon or click the stop link.
  
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ Agent from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
! 	 bin\pphq-agent.bat start
  
! Note: Logging out of the Windows user session will shutdown the Postgres Plus HQ
!       Agent. You should start the Postgres Plus HQ Agent from the Windows Service
!       Manager, if want the Postgres Plus HQ Agent to run after you logout of your
        Windows user session.
        
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ Agent from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
! 	 bin\pphq-agent.bat stop
  
  
  ================================================================================
  
  
! Starting and Stopping the Postgres Plus HQ Agent on Linux / UNIX:
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ Agent, execute this command:
  
!  pphq-agent.sh start
  
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ Agent, execute this command:
  
!  pphq-agent.sh stop
  
   
  ================================================================================
  
  
! Reading the Postgres Plus HQ Agent Log Files
  ---------------------------------------
! The Postgres Plus HQ Agent log files are located in the 'log' sub-directory where the
! Postgres Plus HQ Agent is installed. The active log file is always named 'agent.log'.
  The log is a text file and can be openned and read with any text editor or the
  Windows Notepad application.
diff -rcN hq/installer/bin/hq-server.bat ../hq/installer/bin/hq-server.bat
*** hq/installer/bin/hq-server.bat	2009-04-15 13:07:34.000000000 +0530
--- ../hq/installer/bin/hq-server.bat	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,70 ****
- @echo off
- REM
- REM Start/Stop the HQ server.
- REM
- 
- IF "%OS%"=="Windows_NT" @setlocal
- 
- REM %~dp0 is expanded pathname of the current script under NT
- SET SERVER_HOME=%~dp0..
- cd %SERVER_HOME%
- SET ENGINE_HOME=%SERVER_HOME%\hq-engine
- SET SERVER_LOG=%SERVER_HOME%\logs\hq-server.log
- SET ANT_HOME=%SERVER_HOME%
- SET CLASSPATH=
- 
- if not "%HQ_JAVA_HOME%"=="" (
-     set JAVA_HOME=%HQ_JAVA_HOME%
-     goto gotjava
- )
- if EXIST %SERVER_HOME%\jre\nul (
-     set JAVA_HOME=%SERVER_HOME%\jre
-     goto gotjava
- )
- if "%JAVA_HOME%"=="" goto nojava
- 
- if not exist "%JAVA_HOME%\bin\java.exe" goto nojavaExe
- 
- REM check java version
- for /F %%i IN ('"%JAVA_HOME%\bin\java.exe" -classpath .\lib\hq-installer.jar org.hyperic.util.JavaVersion --atLeast 1.4') do SET JVM_VERSION_OK=%%i
- if "%JVM_VERSION_OK%"=="0" goto badJava
- if "%JVM_VERSION_OK%"=="" goto badJava
- 
- :gotjava
- if "%1" == "start" goto runHQ
- if "%1" == "stop" goto runHQ
- if "%1" == "halt" goto runHQ
- goto usage
- 
- :runHQ
- if not exist "%ANT_HOME%\bin\ant.bat" goto noAnt
- 
- start /B cmd /C ""%ANT_HOME%\bin\ant" -q -Dserver.home="%SERVER_HOME%" -Dengine.home="%ENGINE_HOME%" -Dlog="%SERVER_LOG%" -logger org.hyperic.tools.ant.installer.InstallerLogger -f "%SERVER_HOME%\data\server.xml" %1"
- 
- start /B cmd /C ""%ANT_HOME%\bin\ant" -q -Dserver.home="%SERVER_HOME%" -Dlog="%SERVER_LOG%" -logger org.hyperic.tools.ant.installer.InstallerLogger -f "%SERVER_HOME%\data\db-upgrade.xml" upgrade"
- goto done
- 
- :noAnt
-   echo The ant program could not be found.
-   goto done
- 
- :nojava
-   echo Environment variable HQ_JAVA_HOME not defined.
-   goto done
- 
- :nojavaExe
-   echo HQ_JAVA_HOME\bin\java.exe does not exist
-   goto done
- 
- :badJava
-   echo Java version must be 1.4 or greater
-   goto done
- 
- :usage
-   echo Usage: %0 start 1>&2
-   echo    or: %0 stop 1>&2
-   goto done
- 
- :done
-   if "%OS%"=="Windows_NT" @endlocal
- 
--- 0 ----
diff -rcN hq/installer/bin/hq-server.sh ../hq/installer/bin/hq-server.sh
*** hq/installer/bin/hq-server.sh	2009-08-26 02:36:49.000000000 +0530
--- ../hq/installer/bin/hq-server.sh	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,395 ****
- #!/bin/sh
- #
- # Start/Stop the HQ server.
- #
- 
- debugOut () {
-   if [ "x${DEBUG}" = "x" ] ; then return; fi
-   echo "DEBUG: $@"
- }
- infoOut () {
-   echo "${@}"
- }
- 
- #
- # Load JAVA_OPTS.  Changes to this file will be lost on server upgrades.  To set this
- # value permanently, set server.java.opts in conf/hq-server.conf
- #
- loadJavaOpts () {
-   server_java_opts=`grep '^[ \t]*server\.java\.opts' ${SERVER_HOME}/conf/hq-server.conf | sed 's/[ \t]*server\.java\.opts=//'`
-   if [ -z "${server_java_opts}" ]; then
-   echo "-XX:MaxPermSize=192m -Xmx512m -Xms512m"
-   fi
-   echo "${server_java_opts}"
- }
- 
- loadWebappPort () {
-   TMPPROPFILE="${SERVER_HOME}/logs/.hq-server.conf.tmp"
-   cat ${SERVER_HOME}/conf/hq-server.conf | grep server\.webapp\.port | tr -d ' \t' | grep -v "^#" | sed 's/\./_/g' > ${TMPPROPFILE}
-   . ${TMPPROPFILE} 2> /dev/null
-   rm -f ${TMPPROPFILE}
-   if [ "x${server_webapp_port}" = "x" ] ; then
-     exit 127
-   fi
-   echo "${server_webapp_port}"
- }
- 
- loadDBPort () {
- 
-   TMPPROPFILE="${SERVER_HOME}/hqdb/data/.postgresql.conf.tmp"
-   DBCONF="${SERVER_HOME}/hqdb/data/postgresql.conf"
-   cat ${DBCONF} | grep port | tr -d ' \t' | grep -v '^#' | sed 's/#.*//g' > ${TMPPROPFILE}
-   . ${TMPPROPFILE}
-   rm -f ${TMPPROPFILE}
-   if [ "x${port}" = "x" ] ; then
-     # they must have commented it out or removed the line, so assume it's on the default port.
-     echo "5432"
-   fi
-   echo "${port}"
- }
- 
- checkPort () {
-   PORTNUM=${1}
-   if [ "x${PORTNUM}" = "x" ] ; then
-     infoOut "No port specified to checkPort function."
-     exit 127
-   fi
- 
-   THISOS=`uname -s`
-   ISLISTENING=0
-   case "x${THISOS}" in
-     xLinux)
-       ISLISTENING=`netstat -nlp 2> /dev/null | grep ":${PORTNUM}" | wc -l | tr -d ' '`
-       ;;
-     *)
-       # Works on Solaris, HP-UX, Darwin and FreeBSD, possibly AIX
-       ISLISTENING=`netstat -an 2> /dev/null | grep "\.${PORTNUM}" | head -n 1 | wc -l | tr -d ' '`
-       ;;
-   esac
-   debugOut "checkPort: ISLISTENING=${ISLISTENING}"
-   if [ ${ISLISTENING} -gt 0 ] ; then return 1; fi
-   if [ ${ISLISTENING} -eq 0 ] ; then return 0; fi
-   infoOut "Error checking for process listening on port ${PORTNUM}"
-   exit 4
- }
- 
- waitForPid () {
-   HQPID=${1}
-   MAXTRIES=${2}
- 
-   TRIES=0
-   debugOut "waitForPid: waiting for ${HQPID}"
-   while [ 1 -eq 1 ]; do
-     PIDCHECK=`kill -0 ${HQPID} 2> /dev/null`
-     if [ $? -eq 1 ]; then
-       infoOut "HQ server PID ${HQPID} exited"
-       return 1
-     fi
-  
-     debugOut "waitForPid: PID ${HQPID} still alive" 
-     sleep 2
-     TRIES=`expr ${TRIES} + 1`
-     if [ ${TRIES} -ge ${MAXTRIES} ] ; then
-        debugOut "num TRIES exhausted: ${TRIES} -ge ${MAXTRIES}"
-        break
-     fi
-   done
- 
-   infoOut "HQ server PID ${HQPID} did not exit."
-   return 0;
- }
- 
- waitForPort () {
- 
-   PORTNUM=${1}
-   MAXTRIES=${2}
-   if [ "x${PORTNUM}" = "x" ] ; then
-     infoOut "No port specified to waitForPort function."
-     exit 127
-   fi
-   if [ "x${MAXTRIES}" = "x" ] ; then
-     MAXTRIES=10
-   fi
-   ERRMSG=${3}
-   ERRFILE=${4}
-   if [ "x${ERRFILE}" = "x" ] ; then
-     ERRFILE=""
-   fi
-   EXPECTEDUP=${5}
-   if [ "x${EXPECTEDUP}" = "x" ] ; then
-     EXPECTEDUP=1
-   fi
-   ACTION="start"
-   if [ ${EXPECTEDUP} -eq 0 ] ; then
-     ACTION="stop"
-   fi
- 
-   WASSTARTED=0
-   TRIES=0
-   debugOut "waitForPort ${PORTNUM}/${EXPECTEDUP}, entering wait loop: TRIES=${TRIES}, MAXTRIES=${MAXTRIES}"
-   while [ 1 -eq 1 ] ; do
-     debugOut "checking port: ${PORTNUM}/${EXPECTEDUP}..."
-     checkPort ${PORTNUM} 
-     WASSTARTED=$?
-     debugOut "status of ${PORTNUM}/${EXPECTEDUP} == ${WASSTARTED}"
-     
-     if [ ${WASSTARTED} -eq ${EXPECTEDUP} ] ; then
-       debugOut "port was as expected: wasStarted=${WASSTARTED} -eq expectedUp=${EXPECTEDUP}"
-       return 1
-     fi
-     sleep 2
-     TRIES=`expr ${TRIES} + 1`
-     if [ ${TRIES} -ge ${MAXTRIES} ] ; then
-        debugOut "num TRIES exhausted: ${TRIES} -ge ${MAXTRIES}"
-        break
-     fi
-   done
-   if [ ${WASSTARTED} -ne ${EXPECTEDUP} ] ; then
-     if [ "x${ERRMSG}" = "x" ] ; then
-       infoOut "Error: Process did not ${ACTION} listening on port ${PORTNUM}"
-     else 
-       infoOut "${ERRMSG}"
-     fi
-     if [ "x${ERRFILE}" = "x" ] ; then
-       infoOut "" # "No further error information available."
-     else
-       ERRFILE_EX=`eval "echo ${ERRFILE}"`
-       infoOut "The log file ${ERRFILE_EX} may contain further details on why it failed to ${ACTION}."
-     fi
-     return 0
-   fi
- }
- 
- startBuiltinDB () {
-   DBPIDFILE="${SERVER_HOME}/hqdb/data/postmaster.pid"
-   debugOut "Checking existence of pidfile: ${DBPIDFILE}"
-   if [ -f "${DBPIDFILE}" ] ; then
-     DBPID=`head -n 1 ${DBPIDFILE}`
-     if [ ! "x${DBPID}" = "x" ]; then
-       # First check for stale pid file
-       DBPIDCHECK=`kill -0 ${DBPID} 2> /dev/null`
-       if [ $? -eq 1 ]; then
-         infoOut "Removing stale pid file ${DBPIDFILE}"
-         rm -f ${DBPIDFILE}
-       else
-         infoOut "HQ built-in database already running (pid file found: ${DBPIDFILE}), not starting it again." 
-       fi
-     fi
-   fi 
- 
-   if [ ! -f "${DBPIDFILE}" ] ; then
-     infoOut "Starting HQ built-in database..."
-     ${SERVER_HOME}/bin/db-start.sh
- 
-     debugOut "loading dbport..."
-     DBPORT=`loadDBPort`
-     debugOut "loaded dbport=${DBPORT}"
-     waitForPort ${DBPORT} 10 'HQ built-in database failed to start:' '${SERVER_HOME}/hqdb/data/hqdb.log' 1
-     if [ $? -eq 0 ] ; then
-       exit 1
-     fi
-     infoOut "HQ built-in database started."
-   fi
- }
- 
- doStart () {
-  
- # Is the server already running?
- debugOut "checking pidfile exists: ${SERVER_PID}"
- if [ -f "${SERVER_PID}" ] ; then
-   HQPID=`cat ${SERVER_PID} | tr -d ' '`
-   if [ ! "x${HQPID}" = "x" ] ; then
-     PIDCHECK=`kill -0 ${HQPID} 2> /dev/null`
-     if [ $? -eq 1 ]; then
-       infoOut "Removing stale pid file ${SERVER_PID}"
-       rm -f ${SERVER_PID}
-     else 
-       infoOut "HQ server is already running (pid ${HQPID})."
-       exit 0
-     fi
-   fi
- fi
- 
- # Setup the config based on conf/hq-server.conf
- infoOut "Initializing HQ server configuration..."
- ANT_OPTS="$ANT_OPTS -Djava.net.preferIPv4Stack=true" ANT_ARGS="" JAVA_HOME=${JAVA_HOME} ${ANT_HOME}/bin/ant --noconfig -q \
-   -Dserver.home=${SERVER_HOME} \
-   -Dengine.home=${ENGINE_HOME} \
-   -logger org.hyperic.tools.ant.installer.InstallerLogger \
-   -f ${SERVER_HOME}/data/server.xml sh-setup | grep -v "Unable to locate tools.jar"
- 
- # Start the database if we have a hqdb dir, and if it's not running
- if [ -d "${SERVER_HOME}/hqdb" ] ; then
-   debugOut "Calling startBuiltinDB"
-   startBuiltinDB
-   debugOut "startBuiltinDB completed"
- fi
- 
- infoOut "Verify HQ database schema..."
- ANT_OPTS="$ANT_OPTS -Djava.net.preferIPv4Stack=true" ANT_ARGS="" JAVA_HOME=${JAVA_HOME} ${ANT_HOME}/bin/ant --noconfig -q \
-   -Dserver.home=${SERVER_HOME} \
-   -logger org.hyperic.tools.ant.installer.InstallerLogger \
-   -f ${SERVER_HOME}/data/db-upgrade.xml upgrade
- 
- # Setup HQ_JAVA_OPTS from hq-server.conf
- HQ_JAVA_OPTS=`loadJavaOpts`
- 
- # Enable the 64-bit JRE on Solaris 64-bit OS
- THISOS=`uname -s`
- 
- if [ $THISOS = "SunOS" ] ; then
- 	ARCH=`isainfo -kv`
- 	
- 	case $ARCH in
- 		*64-bit*)
- 		  echo "Setting -d64 JAVA OPTION to enable SunOS 64-bit JRE"
- 			HQ_JAVA_OPTS="${HQ_JAVA_OPTS} -d64"
- 			;;
- 	esac
- fi
- 
- # Start the server
- infoOut "Booting the HQ server (Using JAVA_OPTS=${HQ_JAVA_OPTS})..."
- cd ${SERVER_HOME}/hq-engine/bin
- JBOSSUS=RUNASIS \
- JBOSSHOME=${ENGINE_HOME} \
-   ${JAVA} -server \
-     ${HQ_JAVA_OPTS} \
-     -Dprogram.name=hq-server \
-     -Dserver.home=${SERVER_HOME} \
-     -Dengine.home=${ENGINE_HOME} \
-     -Djava.awt.headless=true \
-     -Djava.net.preferIPv4Stack=true \
-     -classpath ${ENGINE_HOME}/bin/run.jar \
-     org.jboss.Main -b 0.0.0.0 > ${SERVER_LOG} 2>&1 &
- 
-   # Save the pid to a pidfile
-   HQPID=$!
-   echo "${HQPID}" > ${SERVER_PID}
- 
-   # Wait for the webapp to come up
-   debugOut "Waiting for webapp port to come up..."
-   WEBAPP_PORT=`loadWebappPort`
-   debugOut "Loaded WEBAPP_PORT=${WEBAPP_PORT}"
-   waitForPort ${WEBAPP_PORT}  90 'HQ failed to start' '${SERVER_LOG}' 1
-   if [ $? -eq 0 ] ; then
-     exit 1
-   fi
- }
- 
- doStopSignal () {
- 
-   SIGNAME=${1}
-   if [ "x${SIGNAME}" = "x" ] ; then
-     infoOut "No signal specified"
-     exit 127
-   fi
- 
-   # Do we have a pidfile?
-   debugOut "checking pidfile exists: ${SERVER_PID}"
-   if [ -f "${SERVER_PID}" ] ; then
-     HQPID=`cat ${SERVER_PID} | tr -d ' '`
-     if [ "x${HQPID}" = "x" ] ; then
-       infoOut "HQ pid file was empty: ${SERVER_PID}"
-       exit 127
-     fi
-     kill -${SIGNAME} ${HQPID} 2> /dev/null
-     
-     waitForPid ${HQPID} 60
-     if [ $? -eq 0 ] ; then
-       exit 1
-     fi
-     rm -f ${SERVER_PID}
-   else 
-     infoOut "HQ server not running (no pid file found: ${SERVER_PID})"
-   fi
- 
-   # Stop builtin db if there is one
-   debugOut "checking hqdb dir exists: ${SERVER_HOME}/hqdb"
-   if [ -d ${SERVER_HOME}/hqdb ] ; then
-     DBPIDFILE="${SERVER_HOME}/hqdb/data/postmaster.pid"
-     debugOut "checking db pidfile exists: ${DBPIDFILE}"
-     if [ -f ${DBPIDFILE} ] ; then
-       debugOut "db pidfile exists ${DBPIDFILE}"
-       infoOut "Stopping HQ built-in database..."
-       ${SERVER_HOME}/bin/db-stop.sh
-       DBPORT=`loadDBPort`
-       waitForPort ${DBPORT} 30 'HQ built-in database failed to stop:' '${SERVER_HOME}/logs/hqdb.log' 0
-       if [ $? -eq 0 ] ; then
-         exit 1
-       fi
-     else
-       infoOut "HQ built-in database not running (no pid file found: ${DBPIDFILE})"
-     fi
-   fi
- }
- 
- doStop () {
-   doStopSignal "TERM"
- }
- 
- doHalt () {
-   doStopSignal "KILL"
- }
- 
- cd `dirname $0`/..
- SERVER_HOME=`pwd`
- ENGINE_HOME="${SERVER_HOME}/hq-engine"
- SERVER_LOG="${SERVER_HOME}/logs/server.out"
- SERVER_PID_DIR="${SERVER_HOME}/logs"
- SERVER_PID="${SERVER_PID_DIR}/hq-server.pid"
- 
- if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
-     JAVA_HOME=${HQ_JAVA_HOME}
- elif [ -d ${SERVER_HOME}/jre ]; then
-     JAVA_HOME=${SERVER_HOME}/jre
- elif [ "x$JAVA_HOME" = "x" ] ; then
-     case "`uname`" in
-     Darwin)
-         JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
-         ;;
-     *)
-         echo "JAVA_HOME or HQ_JAVA_HOME must be set when invoking the server"
-         exit 1
-         ;;
-     esac
- fi
- 
- JAVA="${JAVA_HOME}/bin/java"
- if [ ! -x "${JAVA}" ] ; then
-     echo "${JAVA} does not exist or is not executable."
-     exit 1
- fi
- 
- ANT_HOME=${SERVER_HOME}
- export ANT_HOME
- action=
- if [ "x${2}" = "x-debug" ] ; then
-   DEBUG=1
- fi
- 
- case "$1" in
-   start)
-     echo "Starting HQ server..."
-     doStart
-     echo "HQ server booted."
-     echo "Login to HQ at: http://127.0.0.1:${WEBAPP_PORT}/"
-     ;;
-   stop)
-     echo "Stopping HQ server..."
-     doStop
-     echo "HQ server is stopped."
-     ;;
-   halt)
-     echo "Halting HQ server..."
-     doHalt
-     echo "HQ server is halted."
-     ;;
-   *)
-     # Print help, don't advertise halt, it's nasty
-     echo "Usage: $0 {start|stop}" 1>&2
-     exit 1
-     ;;
- esac
- 
- exit 0
--- 0 ----
diff -rcN hq/installer/bin/hq-threaddump.sh ../hq/installer/bin/hq-threaddump.sh
*** hq/installer/bin/hq-threaddump.sh	2008-03-26 01:43:01.000000000 +0530
--- ../hq/installer/bin/hq-threaddump.sh	1970-01-01 05:30:00.000000000 +0530
***************
*** 1,16 ****
- #!/bin/sh
- #
- # Saves HQ threaddump to $SERVER_HOME/logs/server.out
- #
- 
- cd `dirname $0`/..
- SERVER_HOME=`pwd`
- 
- if [ -f ${SERVER_HOME}/logs/hq-server.pid ]; then
-     SERVER_PID=`cat ${SERVER_HOME}/logs/hq-server.pid`
- 
-     echo "Running kill -QUIT on ${SERVER_PID}"
-     kill -QUIT ${SERVER_PID}
- else
-     echo "Server not running"
- fi
--- 0 ----
diff -rcN hq/installer/bin/pphq-server.bat ../hq/installer/bin/pphq-server.bat
*** hq/installer/bin/pphq-server.bat	1970-01-01 05:30:00.000000000 +0530
--- ../hq/installer/bin/pphq-server.bat	2009-04-15 13:07:34.000000000 +0530
***************
*** 0 ****
--- 1,70 ----
+ @echo off
+ REM
+ REM Start/Stop the HQ server.
+ REM
+ 
+ IF "%OS%"=="Windows_NT" @setlocal
+ 
+ REM %~dp0 is expanded pathname of the current script under NT
+ SET SERVER_HOME=%~dp0..
+ cd %SERVER_HOME%
+ SET ENGINE_HOME=%SERVER_HOME%\hq-engine
+ SET SERVER_LOG=%SERVER_HOME%\logs\hq-server.log
+ SET ANT_HOME=%SERVER_HOME%
+ SET CLASSPATH=
+ 
+ if not "%HQ_JAVA_HOME%"=="" (
+     set JAVA_HOME=%HQ_JAVA_HOME%
+     goto gotjava
+ )
+ if EXIST %SERVER_HOME%\jre\nul (
+     set JAVA_HOME=%SERVER_HOME%\jre
+     goto gotjava
+ )
+ if "%JAVA_HOME%"=="" goto nojava
+ 
+ if not exist "%JAVA_HOME%\bin\java.exe" goto nojavaExe
+ 
+ REM check java version
+ for /F %%i IN ('"%JAVA_HOME%\bin\java.exe" -classpath .\lib\hq-installer.jar org.hyperic.util.JavaVersion --atLeast 1.4') do SET JVM_VERSION_OK=%%i
+ if "%JVM_VERSION_OK%"=="0" goto badJava
+ if "%JVM_VERSION_OK%"=="" goto badJava
+ 
+ :gotjava
+ if "%1" == "start" goto runHQ
+ if "%1" == "stop" goto runHQ
+ if "%1" == "halt" goto runHQ
+ goto usage
+ 
+ :runHQ
+ if not exist "%ANT_HOME%\bin\ant.bat" goto noAnt
+ 
+ start /B cmd /C ""%ANT_HOME%\bin\ant" -q -Dserver.home="%SERVER_HOME%" -Dengine.home="%ENGINE_HOME%" -Dlog="%SERVER_LOG%" -logger org.hyperic.tools.ant.installer.InstallerLogger -f "%SERVER_HOME%\data\server.xml" %1"
+ 
+ start /B cmd /C ""%ANT_HOME%\bin\ant" -q -Dserver.home="%SERVER_HOME%" -Dlog="%SERVER_LOG%" -logger org.hyperic.tools.ant.installer.InstallerLogger -f "%SERVER_HOME%\data\db-upgrade.xml" upgrade"
+ goto done
+ 
+ :noAnt
+   echo The ant program could not be found.
+   goto done
+ 
+ :nojava
+   echo Environment variable HQ_JAVA_HOME not defined.
+   goto done
+ 
+ :nojavaExe
+   echo HQ_JAVA_HOME\bin\java.exe does not exist
+   goto done
+ 
+ :badJava
+   echo Java version must be 1.4 or greater
+   goto done
+ 
+ :usage
+   echo Usage: %0 start 1>&2
+   echo    or: %0 stop 1>&2
+   goto done
+ 
+ :done
+   if "%OS%"=="Windows_NT" @endlocal
+ 
diff -rcN hq/installer/bin/pphq-server.sh ../hq/installer/bin/pphq-server.sh
*** hq/installer/bin/pphq-server.sh	1970-01-01 05:30:00.000000000 +0530
--- ../hq/installer/bin/pphq-server.sh	2009-08-26 02:36:49.000000000 +0530
***************
*** 0 ****
--- 1,395 ----
+ #!/bin/sh
+ #
+ # Start/Stop the HQ server.
+ #
+ 
+ debugOut () {
+   if [ "x${DEBUG}" = "x" ] ; then return; fi
+   echo "DEBUG: $@"
+ }
+ infoOut () {
+   echo "${@}"
+ }
+ 
+ #
+ # Load JAVA_OPTS.  Changes to this file will be lost on server upgrades.  To set this
+ # value permanently, set server.java.opts in conf/hq-server.conf
+ #
+ loadJavaOpts () {
+   server_java_opts=`grep '^[ \t]*server\.java\.opts' ${SERVER_HOME}/conf/hq-server.conf | sed 's/[ \t]*server\.java\.opts=//'`
+   if [ -z "${server_java_opts}" ]; then
+   echo "-XX:MaxPermSize=192m -Xmx512m -Xms512m"
+   fi
+   echo "${server_java_opts}"
+ }
+ 
+ loadWebappPort () {
+   TMPPROPFILE="${SERVER_HOME}/logs/.hq-server.conf.tmp"
+   cat ${SERVER_HOME}/conf/hq-server.conf | grep server\.webapp\.port | tr -d ' \t' | grep -v "^#" | sed 's/\./_/g' > ${TMPPROPFILE}
+   . ${TMPPROPFILE} 2> /dev/null
+   rm -f ${TMPPROPFILE}
+   if [ "x${server_webapp_port}" = "x" ] ; then
+     exit 127
+   fi
+   echo "${server_webapp_port}"
+ }
+ 
+ loadDBPort () {
+ 
+   TMPPROPFILE="${SERVER_HOME}/hqdb/data/.postgresql.conf.tmp"
+   DBCONF="${SERVER_HOME}/hqdb/data/postgresql.conf"
+   cat ${DBCONF} | grep port | tr -d ' \t' | grep -v '^#' | sed 's/#.*//g' > ${TMPPROPFILE}
+   . ${TMPPROPFILE}
+   rm -f ${TMPPROPFILE}
+   if [ "x${port}" = "x" ] ; then
+     # they must have commented it out or removed the line, so assume it's on the default port.
+     echo "5432"
+   fi
+   echo "${port}"
+ }
+ 
+ checkPort () {
+   PORTNUM=${1}
+   if [ "x${PORTNUM}" = "x" ] ; then
+     infoOut "No port specified to checkPort function."
+     exit 127
+   fi
+ 
+   THISOS=`uname -s`
+   ISLISTENING=0
+   case "x${THISOS}" in
+     xLinux)
+       ISLISTENING=`netstat -nlp 2> /dev/null | grep ":${PORTNUM}" | wc -l | tr -d ' '`
+       ;;
+     *)
+       # Works on Solaris, HP-UX, Darwin and FreeBSD, possibly AIX
+       ISLISTENING=`netstat -an 2> /dev/null | grep "\.${PORTNUM}" | head -n 1 | wc -l | tr -d ' '`
+       ;;
+   esac
+   debugOut "checkPort: ISLISTENING=${ISLISTENING}"
+   if [ ${ISLISTENING} -gt 0 ] ; then return 1; fi
+   if [ ${ISLISTENING} -eq 0 ] ; then return 0; fi
+   infoOut "Error checking for process listening on port ${PORTNUM}"
+   exit 4
+ }
+ 
+ waitForPid () {
+   HQPID=${1}
+   MAXTRIES=${2}
+ 
+   TRIES=0
+   debugOut "waitForPid: waiting for ${HQPID}"
+   while [ 1 -eq 1 ]; do
+     PIDCHECK=`kill -0 ${HQPID} 2> /dev/null`
+     if [ $? -eq 1 ]; then
+       infoOut "HQ server PID ${HQPID} exited"
+       return 1
+     fi
+  
+     debugOut "waitForPid: PID ${HQPID} still alive" 
+     sleep 2
+     TRIES=`expr ${TRIES} + 1`
+     if [ ${TRIES} -ge ${MAXTRIES} ] ; then
+        debugOut "num TRIES exhausted: ${TRIES} -ge ${MAXTRIES}"
+        break
+     fi
+   done
+ 
+   infoOut "HQ server PID ${HQPID} did not exit."
+   return 0;
+ }
+ 
+ waitForPort () {
+ 
+   PORTNUM=${1}
+   MAXTRIES=${2}
+   if [ "x${PORTNUM}" = "x" ] ; then
+     infoOut "No port specified to waitForPort function."
+     exit 127
+   fi
+   if [ "x${MAXTRIES}" = "x" ] ; then
+     MAXTRIES=10
+   fi
+   ERRMSG=${3}
+   ERRFILE=${4}
+   if [ "x${ERRFILE}" = "x" ] ; then
+     ERRFILE=""
+   fi
+   EXPECTEDUP=${5}
+   if [ "x${EXPECTEDUP}" = "x" ] ; then
+     EXPECTEDUP=1
+   fi
+   ACTION="start"
+   if [ ${EXPECTEDUP} -eq 0 ] ; then
+     ACTION="stop"
+   fi
+ 
+   WASSTARTED=0
+   TRIES=0
+   debugOut "waitForPort ${PORTNUM}/${EXPECTEDUP}, entering wait loop: TRIES=${TRIES}, MAXTRIES=${MAXTRIES}"
+   while [ 1 -eq 1 ] ; do
+     debugOut "checking port: ${PORTNUM}/${EXPECTEDUP}..."
+     checkPort ${PORTNUM} 
+     WASSTARTED=$?
+     debugOut "status of ${PORTNUM}/${EXPECTEDUP} == ${WASSTARTED}"
+     
+     if [ ${WASSTARTED} -eq ${EXPECTEDUP} ] ; then
+       debugOut "port was as expected: wasStarted=${WASSTARTED} -eq expectedUp=${EXPECTEDUP}"
+       return 1
+     fi
+     sleep 2
+     TRIES=`expr ${TRIES} + 1`
+     if [ ${TRIES} -ge ${MAXTRIES} ] ; then
+        debugOut "num TRIES exhausted: ${TRIES} -ge ${MAXTRIES}"
+        break
+     fi
+   done
+   if [ ${WASSTARTED} -ne ${EXPECTEDUP} ] ; then
+     if [ "x${ERRMSG}" = "x" ] ; then
+       infoOut "Error: Process did not ${ACTION} listening on port ${PORTNUM}"
+     else 
+       infoOut "${ERRMSG}"
+     fi
+     if [ "x${ERRFILE}" = "x" ] ; then
+       infoOut "" # "No further error information available."
+     else
+       ERRFILE_EX=`eval "echo ${ERRFILE}"`
+       infoOut "The log file ${ERRFILE_EX} may contain further details on why it failed to ${ACTION}."
+     fi
+     return 0
+   fi
+ }
+ 
+ startBuiltinDB () {
+   DBPIDFILE="${SERVER_HOME}/hqdb/data/postmaster.pid"
+   debugOut "Checking existence of pidfile: ${DBPIDFILE}"
+   if [ -f "${DBPIDFILE}" ] ; then
+     DBPID=`head -n 1 ${DBPIDFILE}`
+     if [ ! "x${DBPID}" = "x" ]; then
+       # First check for stale pid file
+       DBPIDCHECK=`kill -0 ${DBPID} 2> /dev/null`
+       if [ $? -eq 1 ]; then
+         infoOut "Removing stale pid file ${DBPIDFILE}"
+         rm -f ${DBPIDFILE}
+       else
+         infoOut "HQ built-in database already running (pid file found: ${DBPIDFILE}), not starting it again." 
+       fi
+     fi
+   fi 
+ 
+   if [ ! -f "${DBPIDFILE}" ] ; then
+     infoOut "Starting HQ built-in database..."
+     ${SERVER_HOME}/bin/db-start.sh
+ 
+     debugOut "loading dbport..."
+     DBPORT=`loadDBPort`
+     debugOut "loaded dbport=${DBPORT}"
+     waitForPort ${DBPORT} 10 'HQ built-in database failed to start:' '${SERVER_HOME}/hqdb/data/hqdb.log' 1
+     if [ $? -eq 0 ] ; then
+       exit 1
+     fi
+     infoOut "HQ built-in database started."
+   fi
+ }
+ 
+ doStart () {
+  
+ # Is the server already running?
+ debugOut "checking pidfile exists: ${SERVER_PID}"
+ if [ -f "${SERVER_PID}" ] ; then
+   HQPID=`cat ${SERVER_PID} | tr -d ' '`
+   if [ ! "x${HQPID}" = "x" ] ; then
+     PIDCHECK=`kill -0 ${HQPID} 2> /dev/null`
+     if [ $? -eq 1 ]; then
+       infoOut "Removing stale pid file ${SERVER_PID}"
+       rm -f ${SERVER_PID}
+     else 
+       infoOut "HQ server is already running (pid ${HQPID})."
+       exit 0
+     fi
+   fi
+ fi
+ 
+ # Setup the config based on conf/hq-server.conf
+ infoOut "Initializing HQ server configuration..."
+ ANT_OPTS="$ANT_OPTS -Djava.net.preferIPv4Stack=true" ANT_ARGS="" JAVA_HOME=${JAVA_HOME} ${ANT_HOME}/bin/ant --noconfig -q \
+   -Dserver.home=${SERVER_HOME} \
+   -Dengine.home=${ENGINE_HOME} \
+   -logger org.hyperic.tools.ant.installer.InstallerLogger \
+   -f ${SERVER_HOME}/data/server.xml sh-setup | grep -v "Unable to locate tools.jar"
+ 
+ # Start the database if we have a hqdb dir, and if it's not running
+ if [ -d "${SERVER_HOME}/hqdb" ] ; then
+   debugOut "Calling startBuiltinDB"
+   startBuiltinDB
+   debugOut "startBuiltinDB completed"
+ fi
+ 
+ infoOut "Verify HQ database schema..."
+ ANT_OPTS="$ANT_OPTS -Djava.net.preferIPv4Stack=true" ANT_ARGS="" JAVA_HOME=${JAVA_HOME} ${ANT_HOME}/bin/ant --noconfig -q \
+   -Dserver.home=${SERVER_HOME} \
+   -logger org.hyperic.tools.ant.installer.InstallerLogger \
+   -f ${SERVER_HOME}/data/db-upgrade.xml upgrade
+ 
+ # Setup HQ_JAVA_OPTS from hq-server.conf
+ HQ_JAVA_OPTS=`loadJavaOpts`
+ 
+ # Enable the 64-bit JRE on Solaris 64-bit OS
+ THISOS=`uname -s`
+ 
+ if [ $THISOS = "SunOS" ] ; then
+ 	ARCH=`isainfo -kv`
+ 	
+ 	case $ARCH in
+ 		*64-bit*)
+ 		  echo "Setting -d64 JAVA OPTION to enable SunOS 64-bit JRE"
+ 			HQ_JAVA_OPTS="${HQ_JAVA_OPTS} -d64"
+ 			;;
+ 	esac
+ fi
+ 
+ # Start the server
+ infoOut "Booting the HQ server (Using JAVA_OPTS=${HQ_JAVA_OPTS})..."
+ cd ${SERVER_HOME}/hq-engine/bin
+ JBOSSUS=RUNASIS \
+ JBOSSHOME=${ENGINE_HOME} \
+   ${JAVA} -server \
+     ${HQ_JAVA_OPTS} \
+     -Dprogram.name=hq-server \
+     -Dserver.home=${SERVER_HOME} \
+     -Dengine.home=${ENGINE_HOME} \
+     -Djava.awt.headless=true \
+     -Djava.net.preferIPv4Stack=true \
+     -classpath ${ENGINE_HOME}/bin/run.jar \
+     org.jboss.Main -b 0.0.0.0 > ${SERVER_LOG} 2>&1 &
+ 
+   # Save the pid to a pidfile
+   HQPID=$!
+   echo "${HQPID}" > ${SERVER_PID}
+ 
+   # Wait for the webapp to come up
+   debugOut "Waiting for webapp port to come up..."
+   WEBAPP_PORT=`loadWebappPort`
+   debugOut "Loaded WEBAPP_PORT=${WEBAPP_PORT}"
+   waitForPort ${WEBAPP_PORT}  90 'HQ failed to start' '${SERVER_LOG}' 1
+   if [ $? -eq 0 ] ; then
+     exit 1
+   fi
+ }
+ 
+ doStopSignal () {
+ 
+   SIGNAME=${1}
+   if [ "x${SIGNAME}" = "x" ] ; then
+     infoOut "No signal specified"
+     exit 127
+   fi
+ 
+   # Do we have a pidfile?
+   debugOut "checking pidfile exists: ${SERVER_PID}"
+   if [ -f "${SERVER_PID}" ] ; then
+     HQPID=`cat ${SERVER_PID} | tr -d ' '`
+     if [ "x${HQPID}" = "x" ] ; then
+       infoOut "HQ pid file was empty: ${SERVER_PID}"
+       exit 127
+     fi
+     kill -${SIGNAME} ${HQPID} 2> /dev/null
+     
+     waitForPid ${HQPID} 60
+     if [ $? -eq 0 ] ; then
+       exit 1
+     fi
+     rm -f ${SERVER_PID}
+   else 
+     infoOut "HQ server not running (no pid file found: ${SERVER_PID})"
+   fi
+ 
+   # Stop builtin db if there is one
+   debugOut "checking hqdb dir exists: ${SERVER_HOME}/hqdb"
+   if [ -d ${SERVER_HOME}/hqdb ] ; then
+     DBPIDFILE="${SERVER_HOME}/hqdb/data/postmaster.pid"
+     debugOut "checking db pidfile exists: ${DBPIDFILE}"
+     if [ -f ${DBPIDFILE} ] ; then
+       debugOut "db pidfile exists ${DBPIDFILE}"
+       infoOut "Stopping HQ built-in database..."
+       ${SERVER_HOME}/bin/db-stop.sh
+       DBPORT=`loadDBPort`
+       waitForPort ${DBPORT} 30 'HQ built-in database failed to stop:' '${SERVER_HOME}/logs/hqdb.log' 0
+       if [ $? -eq 0 ] ; then
+         exit 1
+       fi
+     else
+       infoOut "HQ built-in database not running (no pid file found: ${DBPIDFILE})"
+     fi
+   fi
+ }
+ 
+ doStop () {
+   doStopSignal "TERM"
+ }
+ 
+ doHalt () {
+   doStopSignal "KILL"
+ }
+ 
+ cd `dirname $0`/..
+ SERVER_HOME=`pwd`
+ ENGINE_HOME="${SERVER_HOME}/hq-engine"
+ SERVER_LOG="${SERVER_HOME}/logs/server.out"
+ SERVER_PID_DIR="${SERVER_HOME}/logs"
+ SERVER_PID="${SERVER_PID_DIR}/hq-server.pid"
+ 
+ if [ "x${HQ_JAVA_HOME}" != "x" ] ; then
+     JAVA_HOME=${HQ_JAVA_HOME}
+ elif [ -d ${SERVER_HOME}/jre ]; then
+     JAVA_HOME=${SERVER_HOME}/jre
+ elif [ "x$JAVA_HOME" = "x" ] ; then
+     case "`uname`" in
+     Darwin)
+         JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home
+         ;;
+     *)
+         echo "JAVA_HOME or HQ_JAVA_HOME must be set when invoking the server"
+         exit 1
+         ;;
+     esac
+ fi
+ 
+ JAVA="${JAVA_HOME}/bin/java"
+ if [ ! -x "${JAVA}" ] ; then
+     echo "${JAVA} does not exist or is not executable."
+     exit 1
+ fi
+ 
+ ANT_HOME=${SERVER_HOME}
+ export ANT_HOME
+ action=
+ if [ "x${2}" = "x-debug" ] ; then
+   DEBUG=1
+ fi
+ 
+ case "$1" in
+   start)
+     echo "Starting HQ server..."
+     doStart
+     echo "HQ server booted."
+     echo "Login to HQ at: http://127.0.0.1:${WEBAPP_PORT}/"
+     ;;
+   stop)
+     echo "Stopping HQ server..."
+     doStop
+     echo "HQ server is stopped."
+     ;;
+   halt)
+     echo "Halting HQ server..."
+     doHalt
+     echo "HQ server is halted."
+     ;;
+   *)
+     # Print help, don't advertise halt, it's nasty
+     echo "Usage: $0 {start|stop}" 1>&2
+     exit 1
+     ;;
+ esac
+ 
+ exit 0
diff -rcN hq/installer/bin/pphq-threaddump.sh ../hq/installer/bin/pphq-threaddump.sh
*** hq/installer/bin/pphq-threaddump.sh	1970-01-01 05:30:00.000000000 +0530
--- ../hq/installer/bin/pphq-threaddump.sh	2008-03-26 01:43:01.000000000 +0530
***************
*** 0 ****
--- 1,16 ----
+ #!/bin/sh
+ #
+ # Saves HQ threaddump to $SERVER_HOME/logs/server.out
+ #
+ 
+ cd `dirname $0`/..
+ SERVER_HOME=`pwd`
+ 
+ if [ -f ${SERVER_HOME}/logs/hq-server.pid ]; then
+     SERVER_PID=`cat ${SERVER_HOME}/logs/hq-server.pid`
+ 
+     echo "Running kill -QUIT on ${SERVER_PID}"
+     kill -QUIT ${SERVER_PID}
+ else
+     echo "Server not running"
+ fi
diff -rcN hq/installer/data/hq-engine/hq.properties ../hq/installer/data/hq-engine/hq.properties
*** hq/installer/data/hq-engine/hq.properties	2008-09-17 12:21:43.000000000 +0530
--- ../hq/installer/data/hq-engine/hq.properties	2010-02-02 16:18:13.161025483 +0530
***************
*** 3,13 ****
  ejb-remote-config.context-factory=org.jnp.interfaces.NamingContextFactory
  ejb-remote-config.url-package-prefixes=org.jboss.naming\:org.jnp.interfaces
  
! helpBaseURL=http://support.hyperic.com/confluence/display/DOC/
  
  smallLogo=false
  smallLogoName=
  largeLogo=false
  largeLogoName=
  
! applicationTitle=Hyperic HQ
--- 3,13 ----
  ejb-remote-config.context-factory=org.jnp.interfaces.NamingContextFactory
  ejb-remote-config.url-package-prefixes=org.jboss.naming\:org.jnp.interfaces
  
! helpBaseURL=http://www.enterprisedb.com/learning/documentation.do
  
  smallLogo=false
  smallLogoName=
  largeLogo=false
  largeLogoName=
  
! applicationTitle=PostgresPlus HQ
diff -rcN hq/installer/data/setup-interactive.xml ../hq/installer/data/setup-interactive.xml
*** hq/installer/data/setup-interactive.xml	2008-03-26 01:43:01.000000000 +0530
--- ../hq/installer/data/setup-interactive.xml	2010-02-02 16:19:31.712039991 +0530
***************
*** 6,12 ****
      <property name="setup.title" value="Choose which software to install:"/>
      <configMultichoice title="${setup.title}">
  
!       <option name="Hyperic HQ Server">
          <configSchema inputPrefix="^^^INPUT:" outputPrefix="^^^INFO:"
             class="org.hyperic.hq.install.ServerConfig"
             file="${setup}.new"
--- 6,12 ----
      <property name="setup.title" value="Choose which software to install:"/>
      <configMultichoice title="${setup.title}">
  
!       <option name="PostgresPlus HQ Server">
          <configSchema inputPrefix="^^^INPUT:" outputPrefix="^^^INFO:"
             class="org.hyperic.hq.install.ServerConfig"
             file="${setup}.new"
***************
*** 15,21 ****
             replaceInstallDir="true" />
        </option>
  
!       <option name="Hyperic HQ Agent">
          <configSchema inputPrefix="^^^INPUT:" outputPrefix="^^^INFO:"
             class="org.hyperic.hq.install.AgentConfig"
             file="${setup}.new"
--- 15,21 ----
             replaceInstallDir="true" />
        </option>
  
!       <option name="PostgresPlus HQ Agent">
          <configSchema inputPrefix="^^^INPUT:" outputPrefix="^^^INFO:"
             class="org.hyperic.hq.install.AgentConfig"
             file="${setup}.new"
diff -rcN hq/installer/data/setup.xml ../hq/installer/data/setup.xml
*** hq/installer/data/setup.xml	2009-08-26 02:36:50.000000000 +0530
--- ../hq/installer/data/setup.xml	2010-02-02 16:18:58.616024236 +0530
***************
*** 8,14 ****
  
    <target name="load-basics">
      <property file="${install.dir}/data/version.properties"/>
!     <echo>^^^INFO: Initializing Hyperic HQ ${version} Installation...</echo>
  
      <path id="alljars">
        <fileset dir="${install.dir}/lib" includes="*.jar"/>
--- 8,14 ----
  
    <target name="load-basics">
      <property file="${install.dir}/data/version.properties"/>
!     <echo>^^^INFO: Initializing PostgresPlus HQ ${version} Installation...</echo>
  
      <path id="alljars">
        <fileset dir="${install.dir}/lib" includes="*.jar"/>
***************
*** 115,121 ****
      <available property="user-setup-properties.available"
                 file="${setup.absolute}"/>
      <msgfail unless="user-setup-properties.available">^^^ERROR:\
!        The specified Hyperic HQ install configuration file does not exist:
           ${setup.absolute}
         Make sure that the setup property is set to the correct file and
         try running the installer again.
--- 115,121 ----
      <available property="user-setup-properties.available"
                 file="${setup.absolute}"/>
      <msgfail unless="user-setup-properties.available">^^^ERROR:\
!        The specified PostgresPlus HQ install configuration file does not exist:
           ${setup.absolute}
         Make sure that the setup property is set to the correct file and
         try running the installer again.
***************
*** 616,622 ****
        </or>
      </condition>
      <msgfail if="server.isInstalled">^^^ERROR:\
!       The installer detected that a Hyperic HQ server is already
        installed in ${server.installdir}/server-${version}
      </msgfail>
    </target>
--- 616,622 ----
        </or>
      </condition>
      <msgfail if="server.isInstalled">^^^ERROR:\
!       The installer detected that a PostgresPlus HQ server is already
        installed in ${server.installdir}/server-${version}
      </msgfail>
    </target>
diff -rcN hq/installer/installshield/hyperic-ee/Script Files/Setup.rul ../hq/installer/installshield/hyperic-ee/Script Files/Setup.rul
*** hq/installer/installshield/hyperic-ee/Script Files/Setup.rul	2008-03-26 01:43:00.000000000 +0530
--- ../hq/installer/installshield/hyperic-ee/Script Files/Setup.rul	2010-02-03 11:30:28.168556988 +0530
***************
*** 435,441 ****
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "server-" + HQ_VERSION ^ "bin" ^ "hq-server.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Server Windows Service" , SEVERE);    	
  	endif; 		  
--- 435,441 ----
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "server-" + HQ_VERSION ^ "bin" ^ "pphq-server.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Server Windows Service" , SEVERE);    	
  	endif; 		  
***************
*** 492,498 ****
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "agent-" + HQ_VERSION ^ "hq-agent.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Agent Windows Service" , SEVERE);    	
  	endif; 
--- 492,498 ----
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "agent-" + HQ_VERSION ^ "pphq-agent.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Agent Windows Service" , SEVERE);    	
  	endif; 
diff -rcN hq/installer/installshield/hyperic-os/Script Files/Setup.rul ../hq/installer/installshield/hyperic-os/Script Files/Setup.rul
*** hq/installer/installshield/hyperic-os/Script Files/Setup.rul	2008-03-26 01:42:56.000000000 +0530
--- ../hq/installer/installshield/hyperic-os/Script Files/Setup.rul	2010-02-03 11:26:26.917540037 +0530
***************
*** 371,387 ****
      if ((StrFind ( sRemoveFeatures , "Server" )>=0) ||
      	(sRemoveFeatures = "ALL" ) || (sRemoveFeatures = "")) then   
      	// try to stop the service   
! 		ServiceStopService ( "hyperic-hq-database"); 
! 		ServiceStopService ( "Hyperic HQ Server");   
! 		ServiceRemoveService ( "hyperic-hq-database");
! 		ServiceRemoveService ( "Hyperic HQ Server");        
  		ForceDeleteDir(sInstallDir, sInstallDir ^ "server-" + HQ_VERSION ); 
  	endif;
      if ((StrFind ( sRemoveFeatures , "Agent" )>=0) ||
      	(sRemoveFeatures = "ALL" ) || (sRemoveFeatures = "")) then 
      	// try to stop the service        
! 		ServiceStopService ( "Hyperic HQ Agent"); 
! 		ServiceRemoveService ( "Hyperic HQ Agent");                            
  		ForceDeleteDir(sInstallDir, sInstallDir ^ "agent-" + HQ_VERSION ); 
  	endif;
  	
--- 371,387 ----
      if ((StrFind ( sRemoveFeatures , "Server" )>=0) ||
      	(sRemoveFeatures = "ALL" ) || (sRemoveFeatures = "")) then   
      	// try to stop the service   
! 		ServiceStopService ( "PostgresPlus-hq-database"); 
! 		ServiceStopService ( "Postgres Plus HQ Server");   
! 		ServiceRemoveService ( "PostgresPlus-hq-database");
! 		ServiceRemoveService ( "Postgres Plus HQ Server");        
  		ForceDeleteDir(sInstallDir, sInstallDir ^ "server-" + HQ_VERSION ); 
  	endif;
      if ((StrFind ( sRemoveFeatures , "Agent" )>=0) ||
      	(sRemoveFeatures = "ALL" ) || (sRemoveFeatures = "")) then 
      	// try to stop the service        
! 		ServiceStopService ( "Postgres Plus HQ Agent"); 
! 		ServiceRemoveService ( "Postgres Plus HQ Agent");                            
  		ForceDeleteDir(sInstallDir, sInstallDir ^ "agent-" + HQ_VERSION ); 
  	endif;
  	
***************
*** 422,433 ****
      
      UpdateProgressBar(hMSI, "Installing HQ Server Windows Service");
     	// remove service if previously found
! 	if (ServiceExistsService ( "Hyperic HQ Server" )) then 
      	// try to stop the service        
! 		ServiceStopService ( "hyperic-hq-database"); 
! 		ServiceStopService ( "Hyperic HQ Server");
! 		ServiceRemoveService ( "hyperic-hq-database");
! 		ServiceRemoveService ( "Hyperic HQ Server");
  	endif;    
             
      sJavaHome = "JAVA_HOME=" + sInstallDir ^ "server-" + HQ_VERSION ^ "jre";                                      
--- 422,433 ----
      
      UpdateProgressBar(hMSI, "Installing HQ Server Windows Service");
     	// remove service if previously found
! 	if (ServiceExistsService ( "Postgres Plus HQ Server" )) then 
      	// try to stop the service        
! 		ServiceStopService ( "PostgresPlus-hq-database"); 
! 		ServiceStopService ( "Postgres Plus HQ Server");
! 		ServiceRemoveService ( "PostgresPlus-hq-database");
! 		ServiceRemoveService ( "Postgres Plus HQ Server");
  	endif;    
             
      sJavaHome = "JAVA_HOME=" + sInstallDir ^ "server-" + HQ_VERSION ^ "jre";                                      
***************
*** 435,441 ****
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "server-" + HQ_VERSION ^ "bin" ^ "hq-server.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Server Windows Service" , SEVERE);    	
  	endif; 		  
--- 435,441 ----
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "server-" + HQ_VERSION ^ "bin" ^ "pphq-server.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Server Windows Service" , SEVERE);    	
  	endif; 		  
***************
*** 460,466 ****
      HWND hRec;
  begin      
  	UpdateProgressBar(hMSI, "Starting HQ Server Windows Service");                                                           
! 	if (ServiceStartService ( "Hyperic HQ Server" , "" ) < 0) then 
  	    MessageBox ("Failed to start the HQ Server Windows Service" , SEVERE); 
  	endif;	   	 	  
  end;   
--- 460,466 ----
      HWND hRec;
  begin      
  	UpdateProgressBar(hMSI, "Starting HQ Server Windows Service");                                                           
! 	if (ServiceStartService ( "Postgres Plus HQ Server" , "" ) < 0) then 
  	    MessageBox ("Failed to start the HQ Server Windows Service" , SEVERE); 
  	endif;	   	 	  
  end;   
***************
*** 481,490 ****
      UpdateProgressBar(hMSI, "Starting HQ Agent Windows Service");    
          
  	// remove service if previously found
! 	if (ServiceExistsService ( "Hyperic HQ Agent" )) then 
      	// try to stop the service        
! 		ServiceStopService ( "Hyperic HQ Agent"); 
! 		ServiceRemoveService ( "Hyperic HQ Agent");
  	endif;    
                                            
      sJavaHome = "JAVA_HOME=" + sInstallDir ^ "agent-" + HQ_VERSION ^ "jre";                                      
--- 481,490 ----
      UpdateProgressBar(hMSI, "Starting HQ Agent Windows Service");    
          
  	// remove service if previously found
! 	if (ServiceExistsService ( "Postgres Plus HQ Agent" )) then 
      	// try to stop the service        
! 		ServiceStopService ( "Postgres Plus HQ Agent"); 
! 		ServiceRemoveService ( "Postgres Plus HQ Agent");
  	endif;    
                                            
      sJavaHome = "JAVA_HOME=" + sInstallDir ^ "agent-" + HQ_VERSION ^ "jre";                                      
***************
*** 492,498 ****
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "agent-" + HQ_VERSION ^ "hq-agent.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Agent Windows Service" , SEVERE);    	
  	endif; 
--- 492,498 ----
  	LAAW_PARAMETERS.nTimeOut = nTimeOut;
  	LAAW_PARAMETERS.lpCurrentDirectory = &sInstallDir;   	  
  	
!     if (LaunchAppAndWait ( sInstallDir ^ "agent-" + HQ_VERSION ^ "pphq-agent.exe" , "-i" , 
         	LAAW_OPTION_WAIT | LAAW_OPTION_HIDDEN ) < 0) then
         	MessageBox ("Failed to create HQ Agent Windows Service" , SEVERE);    	
  	endif; 
***************
*** 502,508 ****
      HWND hRec;
  begin 
  	UpdateProgressBar(hMSI, "Starting HQ Agent Windows Service");
! 	if (ServiceStartService ( "Hyperic HQ Agent" , "" ) < 0) then 
  	   	MessageBox ("Failed to start the HQ Agent Windows Service" , SEVERE); 
  	endif;   	  
  end;
--- 502,508 ----
      HWND hRec;
  begin 
  	UpdateProgressBar(hMSI, "Starting HQ Agent Windows Service");
! 	if (ServiceStartService ( "Postgres Plus HQ Agent" , "" ) < 0) then 
  	   	MessageBox ("Failed to start the HQ Agent Windows Service" , SEVERE); 
  	endif;   	  
  end;
***************
*** 631,637 ****
  	    endif;
  	    sBaseUrl = "http://" + sBaseUrl +":" + sWebAppPort + "/";  	
  		nLineNumber = 0;
! 		if (FileInsertLine ( sInstallDir ^ "Hyperic HQ Dashboard.URL" , "URL=" + sBaseUrl, nLineNumber , AFTER ) < 0) then
  			MessageBox("FileInsertLine failed into file " + sFile, SEVERE);
  		endif;       
  	endif;    
--- 631,637 ----
  	    endif;
  	    sBaseUrl = "http://" + sBaseUrl +":" + sWebAppPort + "/";  	
  		nLineNumber = 0;
! 		if (FileInsertLine ( sInstallDir ^ "Postgres Plus HQ Dashboard.URL" , "URL=" + sBaseUrl, nLineNumber , AFTER ) < 0) then
  			MessageBox("FileInsertLine failed into file " + sFile, SEVERE);
  		endif;       
  	endif;    
diff -rcN hq/installer/SERVER-README.txt ../hq/installer/SERVER-README.txt
*** hq/installer/SERVER-README.txt	2008-03-26 01:43:01.000000000 +0530
--- ../hq/installer/SERVER-README.txt	2010-02-02 16:12:41.728033719 +0530
***************
*** 1,52 ****
  ================================================================================                   
!                  Hyperic HQ Server, version @@@VERSION@@@
  ================================================================================ 
! Starting and Stopping the Hyperic HQ Server on Windows:
  
! On Windows, you have the choice of starting and starting the Hyperic HQ Server
  from the Windows Service Manager or from a Windows Command Prompt. The Service
! Manager is recommended for starting the Hyperic HQ Server because services remain
  running even if you logout of the Windows user session that you're logged-in to
  when starting the server.
  
  ----------------------------------------------------------------
! To start the Hyperic HQ Server from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Hyperic HQ Server service.
  
  3. Click the start icon or click the start link.
  
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ Server from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Hyperic HQ Server service.
  
  3. Click the stop icon or click the stop link.
  
  
  ----------------------------------------------------------------
! To start the Hyperic HQ Server from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
  	 bin\hq-server.exe start
  
! Note: Logging out of the Windows user session will shutdown the Hyperic HQ
!       Server. You should start the Hyperic HQ Server from the Windows Service
!       Manager, if want the Hyperic HQ Server to run after you logout of your
        Windows user session.
        
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ Server from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
--- 1,52 ----
  ================================================================================                   
!                  Postgres Plus HQ Server, version @@@VERSION@@@
  ================================================================================ 
! Starting and Stopping the Postgres Plus HQ Server on Windows:
  
! On Windows, you have the choice of starting and starting the Postgres Plus HQ Server
  from the Windows Service Manager or from a Windows Command Prompt. The Service
! Manager is recommended for starting the Postgres Plus HQ Server because services remain
  running even if you logout of the Windows user session that you're logged-in to
  when starting the server.
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ Server from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Postgres Plus HQ Server service.
  
  3. Click the start icon or click the start link.
  
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ Server from the Windows Service Manager:
  
  1. Start the services application from the Windows Administrive Tools menu or
     Windows Control Panel depending on the version of Windows you're running.
     
! 2. Select the Postgres Plus HQ Server service.
  
  3. Click the stop icon or click the stop link.
  
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ Server from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
  2. Execute the following command:
  	 bin\hq-server.exe start
  
! Note: Logging out of the Windows user session will shutdown the Postgres Plus HQ
!       Server. You should start the Postgres Plus HQ Server from the Windows Service
!       Manager, if want the Postgres Plus HQ Server to run after you logout of your
        Windows user session.
        
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ Server from the Windows Command Prompt:
  
  1. Open a Windows Command Prompt Window
  
***************
*** 57,80 ****
  ================================================================================
  
  
! Starting and Stopping the Hyperic HQ Server on Linux / UNIX:
  
  ----------------------------------------------------------------
! To start the Hyperic HQ server, execute this command:
   bin/hq-server.sh start
  
  
  ----------------------------------------------------------------
! To stop the Hyperic HQ server, execute this command:
   bin/hq-server.sh stop
  
   
  ================================================================================
  
  
! Reading the Hyperic HQ Server Log Files
  ---------------------------------------
! The Hyperic HQ Server log files are located in the 'logs' sub-directory where the
! Hyperic HQ Server is installed. The active log file is always named 'server.log'.
  The log is a text file and can be opened and read with any text editor or the
  Windows Notepad application.
--- 57,80 ----
  ================================================================================
  
  
! Starting and Stopping the Postgres Plus HQ Server on Linux / UNIX:
  
  ----------------------------------------------------------------
! To start the Postgres Plus HQ server, execute this command:
   bin/hq-server.sh start
  
  
  ----------------------------------------------------------------
! To stop the Postgres Plus HQ server, execute this command:
   bin/hq-server.sh stop
  
   
  ================================================================================
  
  
! Reading the Postgres Plus HQ Server Log Files
  ---------------------------------------
! The Postgres Plus HQ Server log files are located in the 'logs' sub-directory where the
! Postgres Plus HQ Server is installed. The active log file is always named 'server.log'.
  The log is a text file and can be opened and read with any text editor or the
  Windows Notepad application.
diff -rcN hq/installer/src/org/hyperic/hq/install/AgentConfig.java ../hq/installer/src/org/hyperic/hq/install/AgentConfig.java
*** hq/installer/src/org/hyperic/hq/install/AgentConfig.java	2008-06-11 11:43:59.000000000 +0530
--- ../hq/installer/src/org/hyperic/hq/install/AgentConfig.java	2010-02-03 11:31:30.261516992 +0530
***************
*** 49,55 ****
      }
  
      public static final String[] MARKER_FILES
!         = { "hq-agent.sh", "hq-agent.bat" };
  
      protected String[] getMarkerFiles () {
          return MARKER_FILES;
--- 49,55 ----
      }
  
      public static final String[] MARKER_FILES
!         = { "pphq-agent.sh", "pphq-agent.bat" };
  
      protected String[] getMarkerFiles () {
          return MARKER_FILES;
diff -rcN hq/plugins/hqagent/src/org/hyperic/hq/plugin/hqagent/AgentServerDetector.java ../hq/plugins/hqagent/src/org/hyperic/hq/plugin/hqagent/AgentServerDetector.java
*** hq/plugins/hqagent/src/org/hyperic/hq/plugin/hqagent/AgentServerDetector.java	2008-09-17 12:21:40.000000000 +0530
--- ../hq/plugins/hqagent/src/org/hyperic/hq/plugin/hqagent/AgentServerDetector.java	2010-02-02 16:25:09.400037213 +0530
***************
*** 87,93 ****
          res.setName(agtName);
          res.setType(AgentProductPlugin.FULL_SERVER_NAME);
          res.setIdentifier("CAM Agent Server"); //Backwards compat
!         res.setDescription("Hyperic HQ monitor Agent");
  
          // Set custom properties
          ConfigResponse cprop = new ConfigResponse();
--- 87,93 ----
          res.setName(agtName);
          res.setType(AgentProductPlugin.FULL_SERVER_NAME);
          res.setIdentifier("CAM Agent Server"); //Backwards compat
!         res.setDescription("PostgresPlus HQ monitor Agent");
  
          // Set custom properties
          ConfigResponse cprop = new ConfigResponse();
diff -rcN hq/plugins/servlet/examples/web.xml ../hq/plugins/servlet/examples/web.xml
*** hq/plugins/servlet/examples/web.xml	2008-03-26 01:40:00.000000000 +0530
--- ../hq/plugins/servlet/examples/web.xml	2010-02-02 16:34:58.812926490 +0530
***************
*** 7,13 ****
      <display-name>/hyperic-hq</display-name>
  
      <description>
!       Hyperic HQ Servlet Measurement.  Requires JMX.
      </description>
  
      <!-- The following fragment must be inserted in all apps that needs to be
--- 7,13 ----
      <display-name>/hyperic-hq</display-name>
  
      <description>
!       Postgres Plus HQ Servlet Measurement.  Requires JMX.
      </description>
  
      <!-- The following fragment must be inserted in all apps that needs to be
***************
*** 93,101 ****
           In tomcat default realm this is done by editing conf/tomcat-users.xml
  
      <security-constraint>
!       <display-name>Hyperic resource constraint</display-name>
        <web-resource-collection>
!          <web-resource-name>Hyperic  resources</web-resource-name>
           <url-pattern>/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
--- 93,101 ----
           In tomcat default realm this is done by editing conf/tomcat-users.xml
  
      <security-constraint>
!       <display-name>Postgres Plus HQ resource constraint</display-name>
        <web-resource-collection>
!          <web-resource-name>Postgres Plus HQ  resources</web-resource-name>
           <url-pattern>/*</url-pattern>
        </web-resource-collection>
        <auth-constraint>
***************
*** 105,111 ****
       
      <login-config>
        <auth-method>BASIC</auth-method>
!       <realm-name>Hyperic JMX</realm-name>
      </login-config>
  
      <security-role>
--- 105,111 ----
       
      <login-config>
        <auth-method>BASIC</auth-method>
!       <realm-name>Postgres Plus HQ JMX</realm-name>
      </login-config>
  
      <security-role>
diff -rcN hq/README ../hq/README
*** hq/README	2009-06-05 13:08:07.000000000 +0530
--- ../hq/README	2010-02-02 16:11:26.788024858 +0530
***************
*** 1,16 ****
  
! Visit the Hyperic HQ Documentation Wiki for details on how to build HQ:
  
! http://support.hyperic.com/display/DOC/Build+Instructions
  
  For development questions visit our HQ Developer forum:
  
- http://forums.hyperic.org/jiveforums/forum.jspa?forumID=3
- 
- For end user questions visit the HQ Users forum:
- 
- http://forums.hyperic.org/jiveforums/forum.jspa?forumID=1
- 
- Any enhancments or bugs should be discussed on the forums, or logged in
- our JIRA located at: http://jira.hyperic.com
  
--- 1,10 ----
  
! Visit the Postgres Plus HQ Documentation Wiki for details on how to build HQ:
  
! http://www.enterprisedb.com/learning/documentation.do
  
  For development questions visit our HQ Developer forum:
+  
+ http://www.enterprisedb.com/forumsAction.do
  
  
diff -rcN hq/src/org/hyperic/hq/bizapp/server/session/UpdateBossEJBImpl.java ../hq/src/org/hyperic/hq/bizapp/server/session/UpdateBossEJBImpl.java
*** hq/src/org/hyperic/hq/bizapp/server/session/UpdateBossEJBImpl.java	2008-12-04 14:52:50.000000000 +0530
--- ../hq/src/org/hyperic/hq/bizapp/server/session/UpdateBossEJBImpl.java	2010-02-03 11:52:38.012928141 +0530
***************
*** 74,80 ****
  {
      private final UpdateStatusDAO _updateDAO = 
          new UpdateStatusDAO(DAOFactory.getDAOFactory());
!     private final String CHECK_URL =  "http://updates.hyperic.com/hq-updates"; 
          
      private final Log _log = LogFactory.getLog(UpdateBossEJBImpl.class);
  
--- 74,80 ----
  {
      private final UpdateStatusDAO _updateDAO = 
          new UpdateStatusDAO(DAOFactory.getDAOFactory());
!     private final String CHECK_URL =  "www.enterprisedb.com"; 
          
      private final Log _log = LogFactory.getLog(UpdateBossEJBImpl.class);
  
diff -rcN hq/src/org/hyperic/hq/common/server/mbean/ProductConfigService.java ../hq/src/org/hyperic/hq/common/server/mbean/ProductConfigService.java
*** hq/src/org/hyperic/hq/common/server/mbean/ProductConfigService.java	2008-03-26 01:40:25.000000000 +0530
--- ../hq/src/org/hyperic/hq/common/server/mbean/ProductConfigService.java	2010-02-02 17:20:09.888025489 +0530
***************
*** 76,86 ****
       */
      public void start() {
          _log.info("Starting " + this.getClass().getName());
!         _log.info("Initializing Hyperic Auth Providers");
  
          try {
              Properties conf = getConfig();
!             _log.info("Enabling Hyperic JAAS Providers");
              registerJAASModules(conf);
          } catch (Exception e) {
              // Shouldn't happen
--- 76,86 ----
       */
      public void start() {
          _log.info("Starting " + this.getClass().getName());
!         _log.info("Initializing Postgres Plus HQ Auth Providers");
  
          try {
              Properties conf = getConfig();
!             _log.info("Enabling Postgres Plus HQ JAAS Providers");
              registerJAASModules(conf);
          } catch (Exception e) {
              // Shouldn't happen
***************
*** 122,128 ****
                  AppConfigurationEntry.LoginModuleControlFlag.SUFFICIENT,
                  configOptions);
              // We always add the JDBC provider to the auth config
!             _log.info("Enabling Hyperic JDBC JAAS Provider");
              configEntries.add(ace);
  
              AppConfigurationEntry[] config = (AppConfigurationEntry[])
--- 122,128 ----
                  AppConfigurationEntry.LoginModuleControlFlag.SUFFICIENT,
                  configOptions);
              // We always add the JDBC provider to the auth config
!             _log.info("Enabling Postgres Plus HQ JDBC JAAS Provider");
              configEntries.add(ace);
  
              AppConfigurationEntry[] config = (AppConfigurationEntry[])
***************
*** 134,140 ****
                            new String[] { "java.lang.String",
                                           config.getClass().getName() });
          } catch (Exception e) {
!             throw new SystemException("Error Registering Hyperic JAAS " +
                                           "Modules", e);
          }
      }
--- 134,140 ----
                            new String[] { "java.lang.String",
                                           config.getClass().getName() });
          } catch (Exception e) {
!             throw new SystemException("Error Registering Postgres Plus HQ JAAS " +
                                           "Modules", e);
          }
      }
diff -rcN hq/src/org/hyperic/hq/events/Resources.properties ../hq/src/org/hyperic/hq/events/Resources.properties
*** hq/src/org/hyperic/hq/events/Resources.properties	2009-05-07 13:07:49.000000000 +0530
--- ../hq/src/org/hyperic/hq/events/Resources.properties	2010-02-02 17:19:34.212040551 +0530
***************
*** 48,52 ****
  event.clone.platform.message.start=Cloning started.
  event.clone.platform.message.end=Cloning ended. {1} platforms cloned from master platform [{0}]
  
! event.hqdbhealth.email.subject=Hyperic HQ Shutdown Notification
! event.hqdbhealth.email.message=Hyperic HQ initiated an automatic application shutdown at {0} due to a loss of database connectivity. Please verify that your HQ database is up and functioning prior to restarting HQ.\n\nHQ server.log information at the time of shutdown contained the following information, which may be useful for database diagnostic purposes:\n\n{1}\n\nPlease contact Hyperic Support with any questions, or for guidance on steps to system recovery.
--- 48,52 ----
  event.clone.platform.message.start=Cloning started.
  event.clone.platform.message.end=Cloning ended. {1} platforms cloned from master platform [{0}]
  
! event.hqdbhealth.email.subject=Postgres Plus HQ Shutdown Notification
! event.hqdbhealth.email.message=Postgres Plus HQ initiated an automatic application shutdown at {0} due to a loss of database connectivity. Please verify that your HQ database is up and functioning prior to restarting HQ.\n\nHQ server.log information at the time of shutdown contained the following information, which may be useful for database diagnostic purposes:\n\n{1}\n\nPlease contact Postgres Plus HQ Support with any questions, or for guidance on steps to system recovery.
Binary files hq/src/org/hyperic/hq/product/util/.PluginDiscoverer.java.swp and ../hq/src/org/hyperic/hq/product/util/.PluginDiscoverer.java.swp differ
diff -rcN hq/src/org/hyperic/ui/tapestry/components/navigation/Header.html ../hq/src/org/hyperic/ui/tapestry/components/navigation/Header.html
*** hq/src/org/hyperic/ui/tapestry/components/navigation/Header.html	2008-09-12 12:09:00.000000000 +0530
--- ../hq/src/org/hyperic/ui/tapestry/components/navigation/Header.html	2010-02-03 11:49:35.081539026 +0530
***************
*** 6,13 ****
      <div jwcid="@Any" id="headerLinks" style="ognl:isLoggedIn?'':'right:0px'">
      <if jwcid="@If" condition="ognl:!isLoggedIn" renderTag="false"><span key="notSignedIn"></span></if>
      <else jwcid="@Else" renderTag="false"><span key="welcome"></span> <span jwcid="@Insert" value="ognl:getUserName()"></span><span><a href="/Logout.do"><span key="logout"></span></a></span></else>
!     <span><a href="javascript:void(0)" onclick="tutorialWin=window.open('http://www.hyperic.com/demo/screencasts.html','tutorials','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');tutorialWin.focus();return false;"><span key="screencast"/></a></span>
!     <span><a href="javascript:void(0)" onclick="helpWin=window.open('http://support.hyperic.com/display/DOC/ui-Login','help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;"><span key="help"/></a></span>
      </div>
      <if jwcid="@If" condition="ognl:isLoggedIn" renderTag="false">
      <span jwcid="@SearchPanel"/>
--- 6,13 ----
      <div jwcid="@Any" id="headerLinks" style="ognl:isLoggedIn?'':'right:0px'">
      <if jwcid="@If" condition="ognl:!isLoggedIn" renderTag="false"><span key="notSignedIn"></span></if>
      <else jwcid="@Else" renderTag="false"><span key="welcome"></span> <span jwcid="@Insert" value="ognl:getUserName()"></span><span><a href="/Logout.do"><span key="logout"></span></a></span></else>
!     <span><a href="javascript:void(0)"		onclick="tutorialWin=window.open('http://www.enterprisedb.com/learning/documentation.do','tutorials','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');tutorialWin.focus();return false;"><span key="screencast"/></a></span>
!     <span><a href="javascript:void(0)"			onclick="helpWin=window.open('http://www.enterprisedb.com/learning/documentation.do','help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;"><span key="help"/></a></span>
      </div>
      <if jwcid="@If" condition="ognl:isLoggedIn" renderTag="false">
      <span jwcid="@SearchPanel"/>
***************
*** 15,18 ****
      <if jwcid="@If" condition="ognl:statusElement"><div id="statusElementBox"><div jwcid="@contrib:AjaxStatus" class="statusElement">&nbsp;</div></div></if>
  </div>
  
! <div id="headerBottom">&nbsp;</div>
\ No newline at end of file
--- 15,18 ----
      <if jwcid="@If" condition="ognl:statusElement"><div id="statusElementBox"><div jwcid="@contrib:AjaxStatus" class="statusElement">&nbsp;</div></div></if>
  </div>
  
! <div id="headerBottom">&nbsp;</div>
diff -rcN hq/src/org/hyperic/ui/tapestry/components/panel/SearchPanel.properties ../hq/src/org/hyperic/ui/tapestry/components/panel/SearchPanel.properties
*** hq/src/org/hyperic/ui/tapestry/components/panel/SearchPanel.properties	2008-04-11 11:37:22.000000000 +0530
--- ../hq/src/org/hyperic/ui/tapestry/components/panel/SearchPanel.properties	2010-02-02 16:55:14.628119208 +0530
***************
*** 3,6 ****
  resources=Resources
  alerts=Alerts
  events=Events
! searchButtonTooltip=<span class="tip">Click here to search Hyperic HQ. <br/> Tip: You can also click ctrl-alt-s to activate search.</span>
\ No newline at end of file
--- 3,6 ----
  resources=Resources
  alerts=Alerts
  events=Events
! searchButtonTooltip=<span class="tip">Click here to search Postgres Plus HQ. <br/> Tip: You can also click ctrl-alt-s to activate search.</span>
diff -rcN hq/src/org/hyperic/util/notReady/StartupServlet.java ../hq/src/org/hyperic/util/notReady/StartupServlet.java
*** hq/src/org/hyperic/util/notReady/StartupServlet.java	2009-08-27 21:54:21.000000000 +0530
--- ../hq/src/org/hyperic/util/notReady/StartupServlet.java	2010-02-03 11:35:05.452996638 +0530
***************
*** 74,86 ****
          	// browser request
  	        sb.append("<html>\n")
  	            .append("<head>\n")
! 	            .append("<title>Hyperic HQ Starting: ")
  	            .append(percentComplete).append("%</title>\n")
  	            .append(REFRESH).append("\n\n").append(CSS)
  	            .append("</head>\n")
  	            .append("<body onload=\"doLoad()\" bgColor=\"#DBE3F5\">\n")
  	            .append("<center>\n")
! 	            .append("<h1>Hyperic HQ is starting up, please wait.</h1>\n")
  	            .append("<table border=\"1\" width=\"80%\"><tr><td>\n")
  	            .append("    <table id=\"percentCompleteProgressBar\" border=\"0\" width=\"")
  	            .append(percentComplete).append("%\"><tr><td class=\"progressBar\">")
--- 74,86 ----
          	// browser request
  	        sb.append("<html>\n")
  	            .append("<head>\n")
! 	            .append("<title>Postgres Plus HQ Starting: ")
  	            .append(percentComplete).append("%</title>\n")
  	            .append(REFRESH).append("\n\n").append(CSS)
  	            .append("</head>\n")
  	            .append("<body onload=\"doLoad()\" bgColor=\"#DBE3F5\">\n")
  	            .append("<center>\n")
! 	            .append("<h1>Postgres Plus HQ is starting up, please wait.</h1>\n")
  	            .append("<table border=\"1\" width=\"80%\"><tr><td>\n")
  	            .append("    <table id=\"percentCompleteProgressBar\" border=\"0\" width=\"")
  	            .append(percentComplete).append("%\"><tr><td class=\"progressBar\">")
diff -rcN hq/ui_plugins/hqapi1/views/api/index.gsp ../hq/ui_plugins/hqapi1/views/api/index.gsp
*** hq/ui_plugins/hqapi1/views/api/index.gsp	2009-09-09 13:40:55.000000000 +0530
--- ../hq/ui_plugins/hqapi1/views/api/index.gsp	2010-02-02 14:40:24.357027138 +0530
***************
*** 8,16 ****
          def apijarUrl = "/" + urlFor(asset:clientPackage)
      %>
  
!     <h2>Hyperic HQ API Version ${version}</h2>
  
!     This page provides resources and documentation for the Hyperic HQ API.<br>
  
      <h3>Download</h3>
      <ul>
--- 8,16 ----
          def apijarUrl = "/" + urlFor(asset:clientPackage)
      %>
  
!     <h2>Postgres Plus HQ API Version ${version}</h2>
  
!     This page provides resources and documentation for the Postgres Plus HQ API.<br>
  
      <h3>Download</h3>
      <ul>
***************
*** 38,41 ****
          </thead>
      </table>
     
! </html>
\ No newline at end of file
--- 38,41 ----
          </thead>
      </table>
     
! </html>
diff -rcN hq/ui_plugins/opennms/app/ExporterController.groovy ../hq/ui_plugins/opennms/app/ExporterController.groovy
*** hq/ui_plugins/opennms/app/ExporterController.groovy	2008-03-26 01:43:36.000000000 +0530
--- ../hq/ui_plugins/opennms/app/ExporterController.groovy	2010-02-02 14:46:01.816044481 +0530
***************
*** 22,28 ****
                       'interface'('ip-addr': p.agent.address, descr: 'agent-address',
                                   status: 1, 'snmp-primary': 'N') {
                          'monitored-service'('service-name': 'ICMP')
!                         'monitored-service'('service-name': 'HypericAgent')
                      }
                  }
              }
--- 22,28 ----
                       'interface'('ip-addr': p.agent.address, descr: 'agent-address',
                                   status: 1, 'snmp-primary': 'N') {
                          'monitored-service'('service-name': 'ICMP')
!                         'monitored-service'('service-name': 'PostgresPlusHQAgent')
                      }
                  }
              }
diff -rcN hq/web/common/About.jsp ../hq/web/common/About.jsp
*** hq/web/common/About.jsp	2008-07-08 11:37:03.000000000 +0530
--- ../hq/web/common/About.jsp	2010-02-03 12:31:03.521417704 +0530
***************
*** 54,60 ****
    <tr>
      <td width="1%" class="PageTitle"><html:img page="/images/spacer.gif" width="1" height="32" alt="" border="0"/></td>
      <td width="66%" class="PageTitle"><fmt:message key="about.Title"/></td>
!     <td class="PageTitle" align="right"><html:link href="" onclick="window.open(help + 'About+Hyperic+HQ','help','width=800,height=650,scrollbars=yes,left=80,top=80,resizable=yes'); return false;"><html:img page="/images/title_pagehelp.gif" width="20" height="20" alt="" border="0" hspace="10"/></html:link></td>
    </tr>
    <tr>
      <td class="DisplayLabel" rowspan="3">&nbsp;</td>
--- 54,60 ----
    <tr>
      <td width="1%" class="PageTitle"><html:img page="/images/spacer.gif" width="1" height="32" alt="" border="0"/></td>
      <td width="66%" class="PageTitle"><fmt:message key="about.Title"/></td>
!     <td class="PageTitle" align="right"><html:link href="" onclick="window.open(help + 'About+Postgres+Plus+HQ','help','width=800,height=650,scrollbars=yes,left=80,top=80,resizable=yes'); return false;"><html:img page="/images/title_pagehelp.gif" width="20" height="20" alt="" border="0" hspace="10"/></html:link></td>
    </tr>
    <tr>
      <td class="DisplayLabel" rowspan="3">&nbsp;</td>
***************
*** 68,75 ****
    </tr>
    <tr>
      <td valign="top" class="DisplayContent"><fmt:message key="about.MoreInfo.Label"/><br>
!     <html:link href="http://support.hyperic.com" onclick="window.close();window.open('http://support.hyperic.com');"><fmt:message key="about.MoreInfo.LinkSupport"/></html:link><br>
!     <html:link href="http://forums.hyperic.org"  onclick="window.close();window.open('http://forums.hyperic.org');"><fmt:message key="about.MoreInfo.LinkForums"/></html:link><br>
      &nbsp;</td>
      <td valign="bottom" align="right" class="DisplayContent"><html:img page="/images/dash_movecontent_del-on.gif" onclick="window.close()"/></td>
    </tr>
--- 68,75 ----
    </tr>
    <tr>
      <td valign="top" class="DisplayContent"><fmt:message key="about.MoreInfo.Label"/><br>
!     <html:link href="http://www.enterprisedb.com/myenterprisedb.do" onclick="window.close();window.open('http://www.enterprisedb.com/myenterprisedb.do');"><fmt:message key="about.MoreInfo.LinkSupport"/></html:link><br>
!     <html:link href="http://www.enterprisedb.com/forumsAction.do"  onclick="window.close();window.open('http://www.enterprisedb.com/forumsAction.do');"><fmt:message key="about.MoreInfo.LinkForums"/></html:link><br>
      &nbsp;</td>
      <td valign="bottom" align="right" class="DisplayContent"><html:img page="/images/dash_movecontent_del-on.gif" onclick="window.close()"/></td>
    </tr>
diff -rcN hq/web/common/Error.html ../hq/web/common/Error.html
*** hq/web/common/Error.html	2008-08-21 11:54:30.000000000 +0530
--- ../hq/web/common/Error.html	2010-02-02 17:33:00.796429767 +0530
***************
*** 2,8 ****
  <html>
  <head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
! <title>Hyperic HQ</title>
  <link rel="icon" href="/images/4.0/icons/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/css/HQ_40.css" />
  <link rel="stylesheet" type="text/css"
--- 2,8 ----
  <html>
  <head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8" />
! <title>Postgres Plus HQ</title>
  <link rel="icon" href="/images/4.0/icons/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="/css/HQ_40.css" />
  <link rel="stylesheet" type="text/css"
***************
*** 14,22 ****
  	<div id="header">
  		<div id="headerLogo" title="Home"
  			onclick="location.href='/Dashboard.do'">&nbsp;</div>
! 		<div style="right: 0px" id="headerLinks">You are not signed in. <span><a
! 			href="javascript:void(0)"
! 			onclick="tutorialWin=window.open('http://www.hyperic.com/demo/screencasts.html','tutorials','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');tutorialWin.focus();return false;">Screencasts</a></span>
  		<span><a href="javascript:void(0)"
  			onclick="helpWin=window.open('','help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;">Help</a></span>
  		</div>
--- 14,20 ----
  	<div id="header">
  		<div id="headerLogo" title="Home"
  			onclick="location.href='/Dashboard.do'">&nbsp;</div>
! 		<div style="right: 0px" id="headerLinks">You are not signed in. 
  		<span><a href="javascript:void(0)"
  			onclick="helpWin=window.open('','help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;">Help</a></span>
  		</div>
diff -rcN hq/web/common/Footer.jsp ../hq/web/common/Footer.jsp
*** hq/web/common/Footer.jsp	2009-04-07 13:06:51.000000000 +0530
--- ../hq/web/common/Footer.jsp	2010-02-03 12:36:19.844537813 +0530
***************
*** 38,44 ****
  			</div>
  		</td>
  		<td class="FooterRegular" nowrap="nowrap" width="10%"><fmt:message key="footer.Copyright" /></td>
! 		<td class="FooterBold" nowrap="nowrap" style="padding-right: 30px;" width="10%"><a href="http://www.hyperic.com" target="_blank">www.hyperic.com</a></td>
  	</tr>
  </table>
  
--- 38,44 ----
  			</div>
  		</td>
  		<td class="FooterRegular" nowrap="nowrap" width="10%"><fmt:message key="footer.Copyright" /></td>
! 		<td class="FooterBold" nowrap="nowrap" style="padding-right: 30px;" width="10%"><a href="http://www.enterprisedb.com" target="_blank"></a></td>
  	</tr>
  </table>
  
***************
*** 62,71 ****
    	<tr>
    		<td valign="top" class="DisplayContent" colspan="2"><fmt:message
    			key="about.MoreInfo.Label" /><br />
!   		<html:link href="http://support.hyperic.com" target="about">
    			<fmt:message key="about.MoreInfo.LinkSupport" />
    		</html:link><br />
!   		<html:link href="http://forums.hyperic.org" target="about">
    			<fmt:message key="about.MoreInfo.LinkForums" />
    		</html:link><br />
    		&nbsp;</td>
--- 62,71 ----
    	<tr>
    		<td valign="top" class="DisplayContent" colspan="2"><fmt:message
    			key="about.MoreInfo.Label" /><br />
!   		<html:link href="http:/www.enterprisedb.com/myenterprisedb.do" target="about">
    			<fmt:message key="about.MoreInfo.LinkSupport" />
    		</html:link><br />
!   		<html:link href="http://www.enterprisedb.com/forumsAction.do" target="about">
    			<fmt:message key="about.MoreInfo.LinkForums" />
    		</html:link><br />
    		&nbsp;</td>
diff -rcN hq/web/common/Header.jsp ../hq/web/common/Header.jsp
*** hq/web/common/Header.jsp	2009-08-27 21:54:24.000000000 +0530
--- ../hq/web/common/Header.jsp	2010-02-03 12:02:40.368967248 +0530
***************
*** 167,173 ****
              </c:otherwise>
          </c:choose>
          <span><a href="<html:rewrite page='/Logout.do'/>"><fmt:message key="header.SignOut"/></a></span>
!         <span><html:link href="javascript:void(0)" onclick="tutorialWin=window.open('http://www.hyperic.com/demo/screencasts.html','tutorials','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');tutorialWin.focus();return false;"><fmt:message key="header.Screencasts"/></html:link></span>
          <span><a href="javascript:void(0)" onclick="helpWin=window.open((typeof help != 'undefined' ? help : '<hq:help/>'),'help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;"><fmt:message key="header.Help"/></a></span>
      </div>
      <div id="headerSearch"><fmt:message key="header.Search"/></div>
--- 167,173 ----
              </c:otherwise>
          </c:choose>
          <span><a href="<html:rewrite page='/Logout.do'/>"><fmt:message key="header.SignOut"/></a></span>
!         <span><html:link href="javascript:void(0)" onclick="tutorialWin=window.open('http://www.enterprisedb.com/learning/documentation.do','tutorials','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');tutorialWin.focus();return false;"><fmt:message key="header.Screencasts"/></html:link></span>
          <span><a href="javascript:void(0)" onclick="helpWin=window.open((typeof help != 'undefined' ? help : '<hq:help/>'),'help','width=800,height=650,scrollbars=yes,toolbar=yes,left=80,top=80,resizable=yes');helpWin.focus();return false;"><fmt:message key="header.Help"/></a></span>
      </div>
      <div id="headerSearch"><fmt:message key="header.Search"/></div>
Binary files hq/web/images/4.0/backgrounds/hdbg.png and ../hq/web/images/4.0/backgrounds/hdbg.png differ
Binary files hq/web/images/4.0/logos/hqlogo.jpg and ../hq/web/images/4.0/logos/hqlogo.jpg differ
diff -rcN hq/web/resource/application/inventory/AddToListDependencies.jsp ../hq/web/resource/application/inventory/AddToListDependencies.jsp
*** hq/web/resource/application/inventory/AddToListDependencies.jsp	2008-04-11 11:37:26.000000000 +0530
--- ../hq/web/resource/application/inventory/AddToListDependencies.jsp	2010-02-03 12:08:09.868554974 +0530
***************
*** 103,109 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 103,109 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 111,117 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 111,117 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 119,125 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 119,125 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 127,133 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 127,133 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 135,141 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 135,141 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 143,149 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 143,149 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 151,157 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 151,157 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 159,165 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 159,165 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 167,173 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 167,173 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 175,181 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 175,181 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 183,189 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 183,189 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 191,197 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 191,197 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 199,205 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 199,205 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 207,213 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 207,213 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 215,221 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 215,221 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 276,282 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 276,282 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 284,290 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 284,290 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 292,298 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 292,298 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 300,306 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 300,306 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
diff -rcN hq/web/resource/application/inventory/AddToListServices.jsp ../hq/web/resource/application/inventory/AddToListServices.jsp
*** hq/web/resource/application/inventory/AddToListServices.jsp	2008-04-11 11:37:26.000000000 +0530
--- ../hq/web/resource/application/inventory/AddToListServices.jsp	2010-02-03 12:06:52.424860951 +0530
***************
*** 103,109 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 103,109 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 111,117 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 111,117 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 119,125 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 119,125 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 127,133 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 127,133 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 135,141 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 135,141 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 143,149 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 143,149 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 151,157 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 151,157 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 159,165 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 159,165 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 167,173 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 167,173 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 175,181 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 175,181 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 183,189 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 183,189 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 191,197 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 191,197 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 199,205 ****
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 199,205 ----
                <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 207,213 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 207,213 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 215,221 ****
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
--- 215,221 ----
  			  <!-- ROW -->
                <tr class="ListRow">
                  <td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="availableListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  			  </tr>
***************
*** 276,282 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 276,282 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 284,290 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 284,290 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 292,298 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 292,298 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
***************
*** 300,306 ****
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.hyperic.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
--- 300,306 ----
                <tr class="ListRow">
                  <td class="ListCellLine"><html:img page="/images/spacer.gif" width="5" height="1" border="0"/></td>
  				<td class="ListCellCheckbox" align="center"><input type="checkbox" onclick="ToggleSelection(this, widgetProperties);" class="pendingListMember"></td>
!                 <td class="ListCellPrimary">www.enterprisedb.com</td>
  				<td class="ListCell">description goes here</td>
  			  </tr>
                <!-- / ROW -->
diff -rcN hq/web/resource/application/inventory/ListDependsOn.jsp ../hq/web/resource/application/inventory/ListDependsOn.jsp
*** hq/web/resource/application/inventory/ListDependsOn.jsp	2008-03-26 01:43:21.000000000 +0530
--- ../hq/web/resource/application/inventory/ListDependsOn.jsp	2010-02-03 12:05:50.240538141 +0530
***************
*** 33,39 ****
  <form name="dependsOnForm">
  <!--  DEPENDS ON TITLE -->
  <tiles:insert definition=".header.tab">
! 	<tiles:put name="tabKey" value="\"www.hyperic.com\" resource.application.DependsOnTab"/>
  </tiles:insert>
  <!--  /  -->
  
--- 33,39 ----
  <form name="dependsOnForm">
  <!--  DEPENDS ON TITLE -->
  <tiles:insert definition=".header.tab">
! 	<tiles:put name="tabKey" value="\"www.enterprisedb.com\" resource.application.DependsOnTab"/>
  </tiles:insert>
  <!--  /  -->
  
diff -rcN hq/web/ui_docs/DOC/ui-Monitor.CurrentHealth.Chart.html ../hq/web/ui_docs/DOC/ui-Monitor.CurrentHealth.Chart.html
*** hq/web/ui_docs/DOC/ui-Monitor.CurrentHealth.Chart.html	2009-07-21 13:10:46.000000000 +0530
--- ../hq/web/ui_docs/DOC/ui-Monitor.CurrentHealth.Chart.html	2010-02-02 16:07:14.102213194 +0530
***************
*** 1,7 ****
  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
  <html>
      <head>
!         <title>Hyperic HQ 4.0 and 4.1 Documentation : ui-Monitor.CurrentHealth.Chart</title>
  	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
          <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
      </head>
--- 1,7 ----
  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
  <html>
      <head>
!         <title>Postgres Plus HQ 4.0 and 4.1 Documentation : ui-Monitor.CurrentHealth.Chart</title>
  	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
          <META http-equiv="Content-Type" content="text/html; charset=UTF-8">	    
      </head>
***************
*** 12,18 ****
  			    <td valign="top" class="pagebody">
  				    <div class="pageheader">
  					    <span class="pagetitle">
!                             Hyperic HQ 4.0 and 4.1 Documentation : ui-Monitor.CurrentHealth.Chart
                                                      </span>
  				    </div>
  				    <div class="pagesubheading">
--- 12,18 ----
  			    <td valign="top" class="pagebody">
  				    <div class="pageheader">
  					    <span class="pagetitle">
!                             Postgres Plus HQ 4.0 and 4.1 Documentation : ui-Monitor.CurrentHealth.Chart
                                                      </span>
  				    </div>
  				    <div class="pagesubheading">
***************
*** 21,27 ****
  
  				    <h1><a name="ui-Monitor.CurrentHealth.Chart-MetricChart"></a><a name="ui-Monitor.CurrentHealth.Chart-top"></a>Metric Chart</h1>
  
! <p><em>Topics marked with</em> <font color="red"><em>&#42;</em></font> <em>relate to HQ Enterprise-only features.</em></p>
  <p>This screen allows users to view selected metric in chart form. To display the page</p>
  <ol>
  	<li>Navigate to the resource for which you wish to see a metric chart.</li>
--- 21,27 ----
  
  				    <h1><a name="ui-Monitor.CurrentHealth.Chart-MetricChart"></a><a name="ui-Monitor.CurrentHealth.Chart-top"></a>Metric Chart</h1>
  
! <p><em>Topics marked with</em> <font color="red"><em>&#42;</em></font> <em>are not supported features.</em></p>
  <p>This screen allows users to view selected metric in chart form. To display the page</p>
  <ol>
  	<li>Navigate to the resource for which you wish to see a metric chart.</li>
***************
*** 31,37 ****
  </ol>
  
  
! <p>Charts can be one of several <a href="http://support.hyperic.com/confluence/display/DOC/Charting+Metric+Data#ChartingMetricData-types">types</a>, dictated by the number of metrics and number of resources plotted.</p>
  <ul>
  	<li><a href="#ui-Monitor.CurrentHealth.Chart-Tasks">Tasks</a> available on this screen</li>
  	<li><a href="#ui-Monitor.CurrentHealth.Chart-Sections">Sections</a> on this screen</li>
--- 31,37 ----
  </ol>
  
  
! <p>Charts can be one of several specified in Postgres Plus HQ documentation<a href="http://www.enterprisedb.com/learning/documentation.do">types</a>, dictated by the number of metrics and number of resources plotted.</p>
  <ul>
  	<li><a href="#ui-Monitor.CurrentHealth.Chart-Tasks">Tasks</a> available on this screen</li>
  	<li><a href="#ui-Monitor.CurrentHealth.Chart-Sections">Sections</a> on this screen</li>
***************
*** 127,137 ****
  
  <h4><a name="ui-Monitor.CurrentHealth.Chart-ParticipatingResource"></a>Participating Resource</h4>
  
! <p>This section lists the resource and its metrics or the resources (in the case of charting a <a href="http://support.hyperic.com/confluence/display/DOC/Hyperic+Glossary#HypericGlossary-group">group</a>) that are plotted in the chart. Users can change the individual resource's metrics or the set of group member resources that are included in the chart.</p>
  
  <h4><a name="ui-Monitor.CurrentHealth.Chart-MetricBaselineandExpectedRange"></a>Metric Baseline and Expected Range</h4>
  
! <p>This section allows the user to view and change the values current calculated or set for the metric <a href="http://support.hyperic.com/confluence/display/DOC/Baselines" title="Baselines">baseline</a> and the acceptable range of metric values (outside of which observed metric values will be considered "out-of-bounds" (or "OOB")). This section is available only when a single metric is charted.</p>
  
  <p><em><a href="#ui-Monitor.CurrentHealth.Chart-top"><em>back to top</em></a></em></p>
  
--- 127,138 ----
  
  <h4><a name="ui-Monitor.CurrentHealth.Chart-ParticipatingResource"></a>Participating Resource</h4>
  
! <p>This section lists the resource and its metrics or the resources (in the case of charting a <a href="http://www.enterprisedb.com/learning/documentation.do">group</a>) that are plotted in the chart. Users can change the individual resource's metrics or the set of group member resources that are included in the chart.</p>
  
  <h4><a name="ui-Monitor.CurrentHealth.Chart-MetricBaselineandExpectedRange"></a>Metric Baseline and Expected Range</h4>
  
! <p>This section allows the user to view and change the values current calculated or set for the
! metric <a href="http://www.enterprisedb.com/learning/documentation.do" title="Baselines">baseline</a> and the acceptable range of metric values (outside of which observed metric values will be considered "out-of-bounds" (or "OOB")). This section is available only when a single metric is charted.</p>
  
  <p><em><a href="#ui-Monitor.CurrentHealth.Chart-top"><em>back to top</em></a></em></p>
  
***************
*** 144,150 ****
  <p>The chart displays:</p>
  <ul>
  	<li>The average, peak, and low observed values for the metric for the slice of time along the X-axis</li>
! 	<li>If available, the established <a href="http://support.hyperic.com/confluence/display/DOC/Hyperic+Glossary#HypericGlossary-baseline">baseline</a>, high range (highest acceptable), and low range (lowest acceptable) values</li>
  </ul>
  
  
--- 145,151 ----
  <p>The chart displays:</p>
  <ul>
  	<li>The average, peak, and low observed values for the metric for the slice of time along the X-axis</li>
! 	<li>If available, the established <a href="http://www.enterprisedb.com/learning/documentation.do">baseline</a>, high range (highest acceptable), and low range (lowest acceptable) values</li>
  </ul>
  
  
***************
*** 247,250 ****
  		    </tr>
  	    </table>
      </body>
! </html>
\ No newline at end of file
--- 248,251 ----
  		    </tr>
  	    </table>
      </body>
! </html>
diff -rcN hq/web/WEB-INF/classes/ApplicationResources.properties ../hq/web/WEB-INF/classes/ApplicationResources.properties
*** hq/web/WEB-INF/classes/ApplicationResources.properties	2009-08-18 05:42:44.000000000 +0530
--- ../hq/web/WEB-INF/classes/ApplicationResources.properties	2010-02-03 16:38:36.092616694 +0530
***************
*** 102,108 ****
  common.label.updated=Updated:
  common.label.am={0} AM
  common.label.pm={0} PM
! common.label.Tutorials=Screencasts
  
  common.value.parenthesis=({0})
  common.value.notavail=N/A
--- 102,108 ----
  common.label.updated=Updated:
  common.label.am={0} AM
  common.label.pm={0} PM
! common.label.Tutorials=
  
  common.value.parenthesis=({0})
  common.value.notavail=N/A
***************
*** 110,116 ****
  
  common.field.value=Value
  
! common.url.help=http://support.hyperic.com/confluence/display/HQ40/
  
  common.error.invalid.int=Value must be between 1 and 9999
  common.error.invalid.oid=OID specified is invalid, please enter OID in form of 1.2.3.4
--- 110,116 ----
  
  common.field.value=Value
  
! common.url.help=http://www.enterprisedb.com/learning/documentation.do
  
  common.error.invalid.int=Value must be between 1 and 9999
  common.error.invalid.oid=OID specified is invalid, please enter OID in form of 1.2.3.4
***************
*** 143,149 ****
  login.title=HQ Login
  login.message=&nbsp;
  login.unsupportedBrowser=Browser Not Supported
! login.browserMessage=The browser that you are using is not supported by Hyperic HQ.  You may continue to explore using this browser, but many features and layout elements will not work or display properly. We recommend that you use FireFox 1.5+ or Internet Explorer 6 when using Hyperic HQ.
  
  # Header
  header.RecentAlerts=Recent Alerts:
--- 143,149 ----
  login.title=HQ Login
  login.message=&nbsp;
  login.unsupportedBrowser=Browser Not Supported
! login.browserMessage=The browser that you are using is not supported by Postgres Plus HQ.  You may continue to explore using this browser, but many features and layout elements will not work or display properly. We recommend that you use FireFox 1.5+ or Internet Explorer 6 when using Postgres Plus HQ.
  
  # Header
  header.RecentAlerts=Recent Alerts:
***************
*** 157,163 ****
  header.Help=Help
  header.Search=<u>S</u>earch
  header.SearchShowAll=Show All Results
! header.Screencasts=Screencasts
  header.Dashboard=Dashboard
  header.Resources=Resources
  header.Alerts=Alerts
--- 157,163 ----
  header.Help=Help
  header.Search=<u>S</u>earch
  header.SearchShowAll=Show All Results
! header.Screencasts=
  header.Dashboard=Dashboard
  header.Resources=Resources
  header.Alerts=Alerts
***************
*** 193,209 ****
  
  #
  error.PreviousRequestEtc=Previous request is currently being processed.  Please wait for response before proceeding.
! error.NoXLibInstalled=Image cannot be displayed.  HQ Server requires X libraries to create charts and other graphics in the user interface.  Please follow these <a href="http://support.hyperic.com/display/DOC/Installation+Requirements#InstallationRequirements-HQServerRequirements" target="_blank">installation instructions</a>.
  
  # About Page
! about.Title=About Hyperic HQ
  about.Copyright.Label=&copy; Copyright notice\: 
! about.Copyright.Content=All rights reserved
  about.Copyright.LinkText=See complete copyright information
  about.MoreInfo.Label=For more information, please visit:
  about.MoreInfo.LinkSales=sales@springsource.com
! about.MoreInfo.LinkSupport=Hyperic HQ Documentation
! about.MoreInfo.LinkForums=Hyperic Forums
  
  # Struts Validator Error Messages
  errors.required={0} is required. 
--- 193,209 ----
  
  #
  error.PreviousRequestEtc=Previous request is currently being processed.  Please wait for response before proceeding.
! error.NoXLibInstalled=Image cannot be displayed.  HQ Server requires X libraries to create charts and other graphics in the user interface.  Please follow these <a href="http://www.enterprisedb.com/learning/documentation.dohttp://www.enterprisedb.com/learning/documentation.do" target="_blank">installation instructions</a>.
  
  # About Page
! about.Title=About Postgres Plus HQ
  about.Copyright.Label=&copy; Copyright notice\: 
! about.Copyright.Content=
  about.Copyright.LinkText=See complete copyright information
  about.MoreInfo.Label=For more information, please visit:
  about.MoreInfo.LinkSales=sales@springsource.com
! about.MoreInfo.LinkSupport=Postgres Plus HQ Documentation
! about.MoreInfo.LinkForums=Postgres Plus Forums
  
  # Struts Validator Error Messages
  errors.required={0} is required. 
***************
*** 239,254 ****
  errors.jsp.problem=There was a problem generating your page.
  errors.jsp.ClickHere=Click here
  errors.jsp.ToSee=to see the complete stack trace.
! errors.jsp.contactsupport=For help on this issue contact Hyperic Support:
! errors.jsp.callhyperic=Call <b>1-888-4Hyperic</b> (1-888-449-7374)
  #
  errors.cam.general=An unknown application error occurred.
  error.input.badchars=Input should not contain any of the following characters: |, ?, &, <, >, ', "
  error.input.badquotes=Input should not contain any quote characters
  
  # FOOTER
! footer.HQ=About HQ
! footer.Copyright=&copy; 2004-2009 Hyperic, Inc.
  footer.version=Version
  footer.pageVersionPrefix=(page 
  footer.pageVersionSuffix=)
--- 239,254 ----
  errors.jsp.problem=There was a problem generating your page.
  errors.jsp.ClickHere=Click here
  errors.jsp.ToSee=to see the complete stack trace.
! errors.jsp.contactsupport=For help on this issue contact Postgres Plus HQ Support:
! errors.jsp.callhyperic=support.enterprisedb.com
  #
  errors.cam.general=An unknown application error occurred.
  error.input.badchars=Input should not contain any of the following characters: |, ?, &, <, >, ', "
  error.input.badquotes=Input should not contain any quote characters
  
  # FOOTER
! footer.HQ=About PPHQ
! footer.Copyright=
  footer.version=Version
  footer.pageVersionPrefix=(page 
  footer.pageVersionSuffix=)
***************
*** 558,565 ****
  admin.settings.EditServerConfig.Title=HQ Edit HQ Server Settings
  admin.settings.EditServerConfig.PageTitle=Edit HQ Server Settings
  
! admin.settings.ARCSettings=Hyperic IQ Properties
! admin.settings.ARCURL=Hyperic IQ Server URL
  admin.settings.RestartNote=<b>NOTE:</b> Any changes to HQ Server Settings will take effect after the next server restart.
  admin.settings.RestartNote.Alert=<b>NOTE:</b> Any saved changes will take effect immediately and remain in effect after the next server restart.
  admin.settings.EmailConfigTab=Email Configuration Properties
--- 558,565 ----
  admin.settings.EditServerConfig.Title=HQ Edit HQ Server Settings
  admin.settings.EditServerConfig.PageTitle=Edit HQ Server Settings
  
! admin.settings.ARCSettings=Postgres Plus IQ Properties
! admin.settings.ARCURL=Postgres Plus IQ Server URL
  admin.settings.RestartNote=<b>NOTE:</b> Any changes to HQ Server Settings will take effect after the next server restart.
  admin.settings.RestartNote.Alert=<b>NOTE:</b> Any saved changes will take effect immediately and remain in effect after the next server restart.
  admin.settings.EmailConfigTab=Email Configuration Properties
***************
*** 727,736 ****
  dash.home.EscalationSummary=Current Escalations
  dash.home.ARCReports.Title=IQ Ad-hoc Chart Viewer
  dash.home.ARCReports.selectAReport=Select a Chart
! dash.home.ARCReports.error.notFound=Hyperic IQ Server is not <a href="/admin/config/Config.do?mode=edit">configured</a>.  Click <a href="http://www.hyperic.com/launch/iq-monitoring.html" target="_blank">here</a> to find out more about <a href="http://www.hyperic.com/launch/iq-monitoring.html" target="_blank">Hyperic IQ</a>.
  dash.home.ARCReports.error.loading=No Charts are Available
! dash.home.ARCReports.arcTitle=Go to Hyperic IQ Home
! dash.home.ARCReports.arcLink=Hyperic IQ Home
  dash.home.ARCReports.showLegend=Show Legend
  dash.home.ARCReports.hideLegend=Hide Legend
  
--- 727,736 ----
  dash.home.EscalationSummary=Current Escalations
  dash.home.ARCReports.Title=IQ Ad-hoc Chart Viewer
  dash.home.ARCReports.selectAReport=Select a Chart
! dash.home.ARCReports.error.notFound=Postgres Plus IQ Server is not <a href="/admin/config/Config.do?mode=edit">configured</a>.  Click <a href="http://www.enterprisedb.com/learning/documentation.do" target="_blank">here</a> to find out more about <a href="http://www.enterprisedb.com/learning/documentation.do" target="_blank">Postgres Plus IQ</a>.
  dash.home.ARCReports.error.loading=No Charts are Available
! dash.home.ARCReports.arcTitle=Go to Postgres Plus IQ Home
! dash.home.ARCReports.arcLink=Postgres Plus IQ Home
  dash.home.ARCReports.showLegend=Show Legend
  dash.home.ARCReports.hideLegend=Hide Legend
  
***************
*** 755,761 ****
  
  # A serious error just trying to figure out what the real error was
  dash.home.Problems.problem.internalDiagError=Error while performing diagnosis: {0}
! dash.home.Problems.solution.internalDiagError=Serious error: email the HQ server logfile (in logs/server.log) to <a href="mailto:support@hyperic.com?subject=Internal diagnostic error">Hyperic support</a>
  
  # Metric collection problems - platform
  dash.home.Problems.problem.agentDown=Agent not running
--- 755,761 ----
  
  # A serious error just trying to figure out what the real error was
  dash.home.Problems.problem.internalDiagError=Error while performing diagnosis: {0}
! dash.home.Problems.solution.internalDiagError=Serious error: email the HQ server logfile (in logs/server.log) to <a href="mailto:support@enterprisedb.com?subject=Internal diagnostic error">Postgres Plus HQ support</a>
  
  # Metric collection problems - platform
  dash.home.Problems.problem.agentDown=Agent not running
***************
*** 763,771 ****
  dash.home.Problems.problem.agentNetlinkDown=Agent machine is not responding on {0}
  dash.home.Problems.solution.agentNetlinkDown=Fix broken network link or re-setup agent if its IP address has changed
  dash.home.Problems.problem.agentHosed=Agent unable to collect platform metrics
! dash.home.Problems.solution.agentHosed=Serious error: email agent's logfile (in log/agent.log) to <a href="mailto:support@hyperic.com?subject=Agent not collecting platform metrics">Hyperic support</a>
  dash.home.Problems.problem.agentHosedAtServer=Error reading agent configuration in HQ inventory: {0}
! dash.home.Problems.solution.agentHosedAtServer=Serious error: email the HQ server logfile (in logs/server.log) to <a href="mailto:support@hyperic.com?subject=Error reading agent config from HQ inventory">Hyperic support</a>
  
  # Metric collection problems - server
  dash.home.Problems.problem.serverMisconfigured=Server is configured incorrectly
--- 763,771 ----
  dash.home.Problems.problem.agentNetlinkDown=Agent machine is not responding on {0}
  dash.home.Problems.solution.agentNetlinkDown=Fix broken network link or re-setup agent if its IP address has changed
  dash.home.Problems.problem.agentHosed=Agent unable to collect platform metrics
! dash.home.Problems.solution.agentHosed=Serious error: email agent's logfile (in log/agent.log) to <a href="mailto:support@enterprisedb.com?subject=Agent not collecting platform metrics">Postgres Plus HQ support</a>
  dash.home.Problems.problem.agentHosedAtServer=Error reading agent configuration in HQ inventory: {0}
! dash.home.Problems.solution.agentHosedAtServer=Serious error: email the HQ server logfile (in logs/server.log) to <a href="mailto:support@enterprisedb.com?subject=Error reading agent config from HQ inventory">Postgres Plus HQ support</a>
  
  # Metric collection problems - server
  dash.home.Problems.problem.serverMisconfigured=Server is configured incorrectly
***************
*** 2902,2908 ****
  reporting.error.GeneralError=An error has occurred while generating your report. This is likely due to an error in the report definition.
  
  # Available in EE
! feature.available.in.EE=The {0} feature is available in Hyperic HQ Enterprise.  Please click <a href="{1}">here</a> for more details.
  
  # Common buttons
  resource.common.button.delete=Delete
--- 2902,2908 ----
  reporting.error.GeneralError=An error has occurred while generating your report. This is likely due to an error in the report definition.
  
  # Available in EE
! feature.available.in.EE=The {0} feature is not available in Postgres Plus HQ.  Please contact support@enterprisedb.com for more details.
  
  # Common buttons
  resource.common.button.delete=Delete
diff -rcN hq/web/WEB-INF/ComponentListing.properties ../hq/web/WEB-INF/ComponentListing.properties
*** hq/web/WEB-INF/ComponentListing.properties	2008-03-26 01:43:21.000000000 +0530
--- ../hq/web/WEB-INF/ComponentListing.properties	2010-02-03 16:32:25.360538598 +0530
***************
*** 2,7 ****
  label=Field label
  hint=This is the hint text
  helpTitle=This is the help title text
! pageTitle=Hyperic Component Test Page
  button1=Submit
! button2=Start
\ No newline at end of file
--- 2,7 ----
  label=Field label
  hint=This is the hint text
  helpTitle=This is the help title text
! pageTitle=Postgres Plus HQ Component Test Page
  button1=Submit
! button2=Start
diff -rcN hq/web/WEB-INF/hq.application ../hq/web/WEB-INF/hq.application
*** hq/web/WEB-INF/hq.application	2008-05-07 11:36:18.000000000 +0530
--- ../hq/web/WEB-INF/hq.application	2010-02-02 15:36:30.836185943 +0530
***************
*** 5,11 ****
    "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
  
  <application name="HQ">  
! 	<description>Hyperic HQ</description>
      <meta key="org.apache.tapestry.messages-encoding" value="UTF-8"/> 
  	<meta key="org.apache.tapestry.accepted-locales" value="en"/>
  	 
--- 5,11 ----
    "http://jakarta.apache.org/tapestry/dtd/Tapestry_4_0.dtd">
  
  <application name="HQ">  
! 	<description>Postgres Plus HQ</description>
      <meta key="org.apache.tapestry.messages-encoding" value="UTF-8"/> 
  	<meta key="org.apache.tapestry.accepted-locales" value="en"/>
  	 
***************
*** 20,23 ****
      <library id="tacos" specification-path="classpath:/net/sf/tacos/Tacos.library"/>
      <library id="dojo" specification-path="classpath:/net/sf/tacos/Dojo.library"/>
      
! </application>
\ No newline at end of file
--- 20,23 ----
      <library id="tacos" specification-path="classpath:/net/sf/tacos/Tacos.library"/>
      <library id="dojo" specification-path="classpath:/net/sf/tacos/Dojo.library"/>
      
! </application>
diff -rcN hq/web/WEB-INF/hq.properties.in ../hq/web/WEB-INF/hq.properties.in
*** hq/web/WEB-INF/hq.properties.in	2008-04-11 11:37:25.000000000 +0530
--- ../hq/web/WEB-INF/hq.properties.in	2010-02-02 15:38:05.328044543 +0530
***************
*** 4,14 ****
  ejb-remote-config.url-package-prefixes=org.jboss.naming\:org.jnp.interfaces
  
  #the base url for help 
! helpBaseURL=http://support.hyperic.com/confluence/display/DOC/
  
  smallLogo=false
  smallLogoName=
  largeLogo=false
  largeLogoName=
  
! applicationTitle=Hyperic HQ
\ No newline at end of file
--- 4,14 ----
  ejb-remote-config.url-package-prefixes=org.jboss.naming\:org.jnp.interfaces
  
  #the base url for help 
! helpBaseURL=http://www.enterprisedb.com/learning/documentation.do
  
  smallLogo=false
  smallLogoName=
  largeLogo=false
  largeLogoName=
  
! applicationTitle=Postgres Plus HQ
diff -rcN hq/web/WEB-INF/SignIn.properties ../hq/web/WEB-INF/SignIn.properties
*** hq/web/WEB-INF/SignIn.properties	2008-09-04 14:09:42.000000000 +0530
--- ../hq/web/WEB-INF/SignIn.properties	2010-02-02 15:35:33.381048903 +0530
***************
*** 5,12 ****
  credentialError=You have entered an incorrect user name or password.
  userDisabled=This user has been disabled
  serverError=The HQ Server is still starting
! signInTitle=Sign in to Hyperic HQ
  signInNote=Please enter your username and password to sign in.
  signedIn=You are not signed in.
  signInButton=Sign In
! timeout=Your session has expired.
\ No newline at end of file
--- 5,12 ----
  credentialError=You have entered an incorrect user name or password.
  userDisabled=This user has been disabled
  serverError=The HQ Server is still starting
! signInTitle=Sign in to Postgres Plus HQ
  signInNote=Please enter your username and password to sign in.
  signedIn=You are not signed in.
  signInButton=Sign In
! timeout=Your session has expired.
diff -rcN hq/web/WEB-INF/tld/hq.tld ../hq/web/WEB-INF/tld/hq.tld
*** hq/web/WEB-INF/tld/hq.tld	2009-08-18 05:42:44.000000000 +0530
--- ../hq/web/WEB-INF/tld/hq.tld	2010-02-03 11:54:43.456970540 +0530
***************
*** 8,14 ****
    <tlib-version>1.0</tlib-version>
    <jsp-version>1.2</jsp-version>
    <short-name>HQ tag library</short-name>
!   <uri>http://www.hyperic.com/hq/tags-hq-1.0</uri>
    <display-name>hq</display-name>
    <small-icon></small-icon>
    <large-icon></large-icon>
--- 8,14 ----
    <tlib-version>1.0</tlib-version>
    <jsp-version>1.2</jsp-version>
    <short-name>HQ tag library</short-name>
!   <uri>http://www.enterprisedb.com/learning/documentation.do</uri>
    <display-name>hq</display-name>
    <small-icon></small-icon>
    <large-icon></large-icon>
diff -rcN hq/web/WEB-INF/web.xml ../hq/web/WEB-INF/web.xml
*** hq/web/WEB-INF/web.xml	2008-07-01 11:36:32.000000000 +0530
--- ../hq/web/WEB-INF/web.xml	2010-02-02 15:35:06.269025380 +0530
***************
*** 5,11 ****
      "http://java.sun.com/dtd/web-app_2_3.dtd">
  
  <web-app>
!   <display-name>Hyperic HQ</display-name>
    <context-param>
      <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
      <param-value>ApplicationResources</param-value>
--- 5,11 ----
      "http://java.sun.com/dtd/web-app_2_3.dtd">
  
  <web-app>
!   <display-name>Postgres Plus HQ</display-name>
    <context-param>
      <param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>
      <param-value>ApplicationResources</param-value>
