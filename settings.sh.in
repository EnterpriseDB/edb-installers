#!/bin/sh

# PostgreSQL Installer build system configuration.
# Copy this file to settings.sh, and edit as required for the build setup

# Check if the variable passed is already defined in the environment. If no, then set the value else skip it.
_set_config()
{
	VAR=$1	
	if [ "$(eval "echo \${$VAR}")" = "" ]; then
		#echo "${VAR} value not set in the environment"
		eval $1=$2
	fi
}

# Platforms. Set to 1 to enable a specific platform

_set_config PG_ARCH_OSX 1
_set_config PG_ARCH_WINDOWS_X64 0

# Packages. Set to 1 to enable a specific packages. Note that many packages will be interdependent
#           so you must ensure that all the required dependencies are enabled.


_set_config PG_PACKAGE_SERVER 1
_set_config PG_PACKAGE_POSTGIS 1
_set_config PG_PACKAGE_PGAGENT 1
_set_config PG_PACKAGE_SQLPROTECT 1
_set_config PG_PACKAGE_LANGUAGEPACK 1

# Path for the build machine (/opt/... must be at the end!)
PATH=/bin:/sbin:/usr/bin:/usr/sbin:/opt/local/bin

# VM config. For each VM we need to know the SSH connection details and the path to the
#            shared firectory on the host machine containing this file.
#            We can also specify additional directorys to include in the path.

PG_SSH_OSX=buildfarm@macbuildfarm-prod-cyt-3.edbcorp.net
PG_PATH_OSX=/opt/pginstaller_17.auto
PG_SSH_OSX_SIGN=buildfarm@cadwell.ox.uk.enterprisedb.com
PG_PATH_OSX_SIGN=/Users/buildfarm/pginstaller_17.auto
PG_PATH_OSX_SIGNTOOL=/opt/local/bin/osxsigner
PG_SSH_OSX_NOTARY=buildfarm@cadwell.ox.uk.enterprisedb.com
PG_PATH_OSX_NOTARY=/Users/buildfarm/pginstaller_17.notary
PG_PGHOME_OSX=$PG_PATH_OSX/server/staging_cache/osx
PG_CMAKE_OSX=/Applications/CMake.app/Contents/bin/cmake
PG_PERL_OSX=/Library/edb/languagepack/v5/Perl-5.40
PG_PYTHON_OSX=/Library/edb/languagepack/v5/Python-3.12
PGADMIN_PYTHON_OSX=/Library/Frameworks/Python.framework/Versions/Current
PG_TCL_OSX=/Library/edb/languagepack/v5/Tcl-8.6
PG_LANGUAGEPACK_OSX=/Library/edb/languagepack/v5
PGSERVER_STAGING_OSX=$PWD/server/staging/osx/server
PGADMIN_STAGING_OSX=$PWD/server/staging/osx/pgadmin4
SB_STAGING_OSX=$PWD/server/staging/osx/stackbuilder
CLT_STAGING_OSX=$PWD/server/staging/osx/commandlinetools
PG_INSTALLER_DEFAULT_PATH=/Library/PostgreSQL/17
IMAGEMAGICK_HOME_OSX=/opt/local/Current_v15/ImageMagick
PG_DOCBOOK_OSX=/usr/local/Cellar/docbook-xsl/1.79.2_1/docbook-xsl

# CFLAGS/CPPFLAGS/CXXFLAGS settings for different platforms. The is most important for Mac
# where we may need to use non-default SDKs if we're building on a platform newer than the
# oldest supported

MACOSX_MIN_VERSION=12
ARCHFLAGS="-arch x86_64 -arch arm64"
SDK_PATH=/Library/Developer/CommandLineTools/SDKs/MacOSX14.sdk
PG_ARCH_OSX_CFLAGS="-isysroot $SDK_PATH -mmacosx-version-min=$MACOSX_MIN_VERSION $ARCHFLAGS"
PG_ARCH_OSX_CPPFLAGS="-isysroot $SDK_PATH -mmacosx-version-min=$MACOSX_MIN_VERSION"
PG_ARCH_OSX_CXXFLAGS="-isysroot $SDK_PATH -mmacosx-version-min=$MACOSX_MIN_VERSION $ARCHFLAGS"
PG_ARCH_OSX_LDFLAGS="-isysroot $SDK_PATH -mmacosx-version-min=$MACOSX_MIN_VERSION $ARCHFLAGS"

# The InstallBuilder main binary.
PG_INSTALLBUILDER_BIN="/opt/installbuilder-23.11.0/bin/builder"
KEYCHAIN_PASSWD="XXXXXX"
DEVELOPER_ID="Developer ID Application: EnterpriseDB Corporation"
